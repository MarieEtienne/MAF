[
  {
    "objectID": "tp1_example.html",
    "href": "tp1_example.html",
    "title": "Eléments de correction pour le TD1",
    "section": "",
    "text": "Code\nknitr::opts_chunk$set(echo = TRUE, comment = NA, \n                      cache = TRUE, message = FALSE,\n                      warning = FALSE, eval = TRUE,\n                      fig.align = \"center\")"
  },
  {
    "objectID": "tp1_example.html#comprendre-les-données",
    "href": "tp1_example.html#comprendre-les-données",
    "title": "Eléments de correction pour le TD1",
    "section": "Comprendre les données",
    "text": "Comprendre les données\n\nChargement des packages\nNous utilisons la suite de packages tidyverse pour la manipulation de données, FactomineR pour la mise en oeuvre des analyses factorielles et éventiuellement factoextra pour des sorties plus jolies. (pour une exploration plus interactive on peut utiliser aussi Factoshiny ou explor).\n\n\n\n\n\n\nTip\n\n\n\nUne bonne pratique consiste à ne charger que le nombre minimal de packages nécessaires. Evitez de commencer tous les codes avec la même liste de package, pesez l’intérêt de chacun d’eux.\n\n\n\n\nCode\nlibrary(tidyverse)\nlibrary(FactoMineR)\nlibrary(factoextra)\n\n\n\n\n\n\n\n\nTip\n\n\n\nLe raccourci pour ajouter un chunk R CTL + Alt + i\n\n\n\n\nImportation\n\n\nImportation des données\n\n\nCode\ndta &lt;- read.table(file = \"https://marieetienne.github.io/datasets/donnees_sols.txt\", sep = \";\", header = TRUE)\n\n\n\n\nDescription des données\nProposer des résumés univariés de chaque variable présente dans le jeu de données.\n\n\nCode\ndta  |&gt;    \n  summary()\n\n\n     Sol                Site            Profondeur              pH       \n Length:539         Length:539         Length:539         Min.   :3.400  \n Class :character   Class :character   Class :character   1st Qu.:4.400  \n Mode  :character   Mode  :character   Mode  :character   Median :4.670  \n                                                          Mean   :4.632  \n                                                          3rd Qu.:4.880  \n                                                          Max.   :5.700  \n      Eau             Av.P              C                N          \n Min.   :0.170   Min.   : 0.380   Min.   :0.1400   Min.   :0.01000  \n 1st Qu.:1.540   1st Qu.: 1.940   1st Qu.:0.5200   1st Qu.:0.05000  \n Median :2.490   Median : 3.160   Median :0.8000   Median :0.07000  \n Mean   :2.698   Mean   : 4.132   Mean   :0.9706   Mean   :0.08056  \n 3rd Qu.:3.740   3rd Qu.: 5.235   3rd Qu.:1.2800   3rd Qu.:0.10000  \n Max.   :8.110   Max.   :51.290   Max.   :5.5900   Max.   :0.31000  \n      NO3              NH4             Exc.Ac           Exc.Al     \n Min.   : 0.000   Min.   : 0.000   Min.   : 0.250   Min.   :0.030  \n 1st Qu.: 0.400   1st Qu.: 1.655   1st Qu.: 1.990   1st Qu.:1.370  \n Median : 1.510   Median : 3.190   Median : 3.420   Median :2.720  \n Mean   : 2.722   Mean   : 5.044   Mean   : 3.781   Mean   :3.151  \n 3rd Qu.: 2.965   3rd Qu.: 6.920   3rd Qu.: 5.205   3rd Qu.:4.475  \n Max.   :23.600   Max.   :40.430   Max.   :10.570   Max.   :9.720  \n     Exc.Ca            Exc.Mg           Exc.K            Exc.Na       \n Min.   : 0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  \n 1st Qu.: 0.0400   1st Qu.:0.0700   1st Qu.:0.0500   1st Qu.:0.03000  \n Median : 0.0800   Median :0.2100   Median :0.1100   Median :0.05000  \n Mean   : 0.3029   Mean   :0.6194   Mean   :0.1386   Mean   :0.05237  \n 3rd Qu.: 0.1900   3rd Qu.:0.8200   3rd Qu.:0.1700   3rd Qu.:0.07000  \n Max.   :13.4900   Max.   :5.3300   Max.   :1.3000   Max.   :0.27000  \n  Exc.Cations        SatBase          Argile          Limon      \n Min.   : 0.380   Min.   : 1.80   Min.   : 8.00   Min.   : 0.00  \n 1st Qu.: 2.405   1st Qu.: 7.95   1st Qu.:16.00   1st Qu.:10.00  \n Median : 4.030   Median :13.24   Median :21.00   Median :13.00  \n Mean   : 4.895   Mean   :18.51   Mean   :23.76   Mean   :16.13  \n 3rd Qu.: 6.765   3rd Qu.:24.67   3rd Qu.:32.00   3rd Qu.:21.50  \n Max.   :17.300   Max.   :97.54   Max.   :53.00   Max.   :47.00  \n     Sable     \n Min.   :15.0  \n 1st Qu.:47.0  \n Median :67.0  \n Mean   :60.1  \n 3rd Qu.:74.0  \n Max.   :87.0  \n\n\n\n\n\n\n\n\nNote\n\n\n\nOn remarque que les facteurs sont importés en caractères. transformation de ces variables (Sol,site et Profondeur) en facteur:\n\n\n\n\nCode\ndta &lt;- dta |&gt;    \n  mutate(Sol = as.factor(Sol),\n         Site = as.factor(Site), \n         Profondeur = as.factor(Profondeur))\ndta |&gt;    \n  summary()\n\n\n       Sol            Site             Profondeur        pH       \n Alluvial:180   292-11_A:  3   Intermediaire:180   Min.   :3.400  \n Dunaire :180   292-11_B:  3   Profond      :180   1st Qu.:4.400  \n Grès    :179   292-11_H:  3   Superficiel  :179   Median :4.670  \n                292-11_M:  3                       Mean   :4.632  \n                292-11_N:  3                       3rd Qu.:4.880  \n                292-11_O:  3                       Max.   :5.700  \n                (Other) :521                                      \n      Eau             Av.P              C                N          \n Min.   :0.170   Min.   : 0.380   Min.   :0.1400   Min.   :0.01000  \n 1st Qu.:1.540   1st Qu.: 1.940   1st Qu.:0.5200   1st Qu.:0.05000  \n Median :2.490   Median : 3.160   Median :0.8000   Median :0.07000  \n Mean   :2.698   Mean   : 4.132   Mean   :0.9706   Mean   :0.08056  \n 3rd Qu.:3.740   3rd Qu.: 5.235   3rd Qu.:1.2800   3rd Qu.:0.10000  \n Max.   :8.110   Max.   :51.290   Max.   :5.5900   Max.   :0.31000  \n                                                                    \n      NO3              NH4             Exc.Ac           Exc.Al     \n Min.   : 0.000   Min.   : 0.000   Min.   : 0.250   Min.   :0.030  \n 1st Qu.: 0.400   1st Qu.: 1.655   1st Qu.: 1.990   1st Qu.:1.370  \n Median : 1.510   Median : 3.190   Median : 3.420   Median :2.720  \n Mean   : 2.722   Mean   : 5.044   Mean   : 3.781   Mean   :3.151  \n 3rd Qu.: 2.965   3rd Qu.: 6.920   3rd Qu.: 5.205   3rd Qu.:4.475  \n Max.   :23.600   Max.   :40.430   Max.   :10.570   Max.   :9.720  \n                                                                   \n     Exc.Ca            Exc.Mg           Exc.K            Exc.Na       \n Min.   : 0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  \n 1st Qu.: 0.0400   1st Qu.:0.0700   1st Qu.:0.0500   1st Qu.:0.03000  \n Median : 0.0800   Median :0.2100   Median :0.1100   Median :0.05000  \n Mean   : 0.3029   Mean   :0.6194   Mean   :0.1386   Mean   :0.05237  \n 3rd Qu.: 0.1900   3rd Qu.:0.8200   3rd Qu.:0.1700   3rd Qu.:0.07000  \n Max.   :13.4900   Max.   :5.3300   Max.   :1.3000   Max.   :0.27000  \n                                                                      \n  Exc.Cations        SatBase          Argile          Limon      \n Min.   : 0.380   Min.   : 1.80   Min.   : 8.00   Min.   : 0.00  \n 1st Qu.: 2.405   1st Qu.: 7.95   1st Qu.:16.00   1st Qu.:10.00  \n Median : 4.030   Median :13.24   Median :21.00   Median :13.00  \n Mean   : 4.895   Mean   :18.51   Mean   :23.76   Mean   :16.13  \n 3rd Qu.: 6.765   3rd Qu.:24.67   3rd Qu.:32.00   3rd Qu.:21.50  \n Max.   :17.300   Max.   :97.54   Max.   :53.00   Max.   :47.00  \n                                                                 \n     Sable     \n Min.   :15.0  \n 1st Qu.:47.0  \n Median :67.0  \n Mean   :60.1  \n 3rd Qu.:74.0  \n Max.   :87.0  \n               \n\n\n\n\nCode\n# str(dta)\ndta &lt;- dta %&gt;% mutate(Sol = as.factor(Sol),\n               Site = as.factor(Site),\n               Profondeur = factor(Profondeur), levels(c('Superficiel', 'Intermediaire', 'Profond'))) %&gt;% \n  mutate(Profondeur = relevel(Profondeur, ref= \"Superficiel\"))\n summary(dta)\n\n\n       Sol            Site             Profondeur        pH       \n Alluvial:180   292-11_A:  3   Superficiel  :179   Min.   :3.400  \n Dunaire :180   292-11_B:  3   Intermediaire:180   1st Qu.:4.400  \n Grès    :179   292-11_H:  3   Profond      :180   Median :4.670  \n                292-11_M:  3                       Mean   :4.632  \n                292-11_N:  3                       3rd Qu.:4.880  \n                292-11_O:  3                       Max.   :5.700  \n                (Other) :521                                      \n      Eau             Av.P              C                N          \n Min.   :0.170   Min.   : 0.380   Min.   :0.1400   Min.   :0.01000  \n 1st Qu.:1.540   1st Qu.: 1.940   1st Qu.:0.5200   1st Qu.:0.05000  \n Median :2.490   Median : 3.160   Median :0.8000   Median :0.07000  \n Mean   :2.698   Mean   : 4.132   Mean   :0.9706   Mean   :0.08056  \n 3rd Qu.:3.740   3rd Qu.: 5.235   3rd Qu.:1.2800   3rd Qu.:0.10000  \n Max.   :8.110   Max.   :51.290   Max.   :5.5900   Max.   :0.31000  \n                                                                    \n      NO3              NH4             Exc.Ac           Exc.Al     \n Min.   : 0.000   Min.   : 0.000   Min.   : 0.250   Min.   :0.030  \n 1st Qu.: 0.400   1st Qu.: 1.655   1st Qu.: 1.990   1st Qu.:1.370  \n Median : 1.510   Median : 3.190   Median : 3.420   Median :2.720  \n Mean   : 2.722   Mean   : 5.044   Mean   : 3.781   Mean   :3.151  \n 3rd Qu.: 2.965   3rd Qu.: 6.920   3rd Qu.: 5.205   3rd Qu.:4.475  \n Max.   :23.600   Max.   :40.430   Max.   :10.570   Max.   :9.720  \n                                                                   \n     Exc.Ca            Exc.Mg           Exc.K            Exc.Na       \n Min.   : 0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  \n 1st Qu.: 0.0400   1st Qu.:0.0700   1st Qu.:0.0500   1st Qu.:0.03000  \n Median : 0.0800   Median :0.2100   Median :0.1100   Median :0.05000  \n Mean   : 0.3029   Mean   :0.6194   Mean   :0.1386   Mean   :0.05237  \n 3rd Qu.: 0.1900   3rd Qu.:0.8200   3rd Qu.:0.1700   3rd Qu.:0.07000  \n Max.   :13.4900   Max.   :5.3300   Max.   :1.3000   Max.   :0.27000  \n                                                                      \n  Exc.Cations        SatBase          Argile          Limon      \n Min.   : 0.380   Min.   : 1.80   Min.   : 8.00   Min.   : 0.00  \n 1st Qu.: 2.405   1st Qu.: 7.95   1st Qu.:16.00   1st Qu.:10.00  \n Median : 4.030   Median :13.24   Median :21.00   Median :13.00  \n Mean   : 4.895   Mean   :18.51   Mean   :23.76   Mean   :16.13  \n 3rd Qu.: 6.765   3rd Qu.:24.67   3rd Qu.:32.00   3rd Qu.:21.50  \n Max.   :17.300   Max.   :97.54   Max.   :53.00   Max.   :47.00  \n                                                                 \n     Sable     \n Min.   :15.0  \n 1st Qu.:47.0  \n Median :67.0  \n Mean   :60.1  \n 3rd Qu.:74.0  \n Max.   :87.0  \n               \n\n\n\nCombien y a t-il de variables quantitatives / qualitatives?\n\n\n\n\n\n\n\nNote\n\n\n\nIl y a différentes manières d’identifier le nombre de variables et d’individus. A travers la fonction str() ou sapply(), on a 3 variables qualitatives et 18 variables quantitatives On peut aussi demander le nombre de colonnes et de lignes (ncol, nrow)\n\n\n\n\nCode\nstr(dta)\n\n\n'data.frame':   539 obs. of  21 variables:\n $ Sol        : Factor w/ 3 levels \"Alluvial\",\"Dunaire\",..: 3 1 1 1 1 1 1 1 1 1 ...\n $ Site       : Factor w/ 180 levels \"292-11_A\",\"292-11_B\",..: 31 1 1 1 2 2 2 3 3 3 ...\n $ Profondeur : Factor w/ 3 levels \"Superficiel\",..: 1 1 3 2 1 3 2 1 3 2 ...\n $ pH         : num  4.72 4.56 4.91 4.6 4.67 4.81 4.63 4.84 4.57 4.74 ...\n $ Eau        : num  3.49 2.76 3.39 2.84 3.39 4.28 3.77 4.12 4.98 4.58 ...\n $ Av.P       : num  4.28 7.02 1.75 4.67 4.54 0.7 1.84 4.2 0.88 2.39 ...\n $ C          : num  1.26 0.91 0.3 0.58 0.96 0.38 0.61 0.96 0.47 0.67 ...\n $ N          : num  0.11 0.12 0.06 0.09 0.14 0.08 0.1 0.12 0.08 0.11 ...\n $ NO3        : num  0 10.13 1.84 4.87 1.84 ...\n $ NH4        : num  6.71 2.43 2.17 2.52 3.39 0.66 0.75 3.21 2 2.16 ...\n $ Exc.Ac     : num  4.97 3.96 5.8 5.09 4.14 8.25 6.23 5.48 7.84 6.92 ...\n $ Exc.Al     : num  4.07 3.6 5.33 4.63 3.83 7.65 5.72 4.95 7.68 6.44 ...\n $ Exc.Ca     : num  0.15 0.32 0.15 0.17 0.91 0.2 0.33 1.42 0.3 0.67 ...\n $ Exc.Mg     : num  0.25 0.18 0.2 0.21 0.87 1.2 0.86 1.79 1.98 1.49 ...\n $ Exc.K      : num  0.24 0.21 0.15 0.15 0.16 0.17 0.12 0.22 0.16 0.17 ...\n $ Exc.Na     : num  0.07 0.06 0.05 0.05 0.06 0.06 0.06 0.07 0.06 0.07 ...\n $ Exc.Cations: num  5.68 4.73 6.35 5.68 6.14 ...\n $ SatBase    : num  12.5 16.36 8.69 10.29 32.53 ...\n $ Argile     : int  27 27 31 27 33 43 33 37 45 37 ...\n $ Limon      : int  10 19 16 19 24 26 24 32 25 32 ...\n $ Sable      : int  63 54 52 54 43 31 43 31 30 31 ...\n\n\nCode\nsapply(dta, class)\n\n\n        Sol        Site  Profondeur          pH         Eau        Av.P \n   \"factor\"    \"factor\"    \"factor\"   \"numeric\"   \"numeric\"   \"numeric\" \n          C           N         NO3         NH4      Exc.Ac      Exc.Al \n  \"numeric\"   \"numeric\"   \"numeric\"   \"numeric\"   \"numeric\"   \"numeric\" \n     Exc.Ca      Exc.Mg       Exc.K      Exc.Na Exc.Cations     SatBase \n  \"numeric\"   \"numeric\"   \"numeric\"   \"numeric\"   \"numeric\"   \"numeric\" \n     Argile       Limon       Sable \n  \"integer\"   \"integer\"   \"integer\" \n\n\n\n\nCode\nnobs &lt;- nrow(dta)\np &lt;- ncol(dta)\nany(is.na(dta))\n\n\n[1] FALSE\n\n\nCode\nsummary(dta$Profondeur)\n\n\n  Superficiel Intermediaire       Profond \n          179           180           180 \n\n\nLe fichier de données a 539 lignes et 21colonnes.\n\n\nCode\nany(is.na(dta))\n\n\n[1] FALSE\n\n\n\n\n\n\n\n\nNote\n\n\n\nIl n’y a pas de données manquantes.\n\n\n\nSont-ils tous prélevés à la même profondeur ?\n\n\n\n\n\n\n\nNote\n\n\n\nObservez le site 292-31_D\n\n\n\n\n\nCode\ndta |&gt; group_by(Site, Profondeur) |&gt; count() \n\n\n# A tibble: 539 × 3\n# Groups:   Site, Profondeur [539]\n   Site     Profondeur        n\n   &lt;fct&gt;    &lt;fct&gt;         &lt;int&gt;\n 1 292-11_A Superficiel       1\n 2 292-11_A Intermediaire     1\n 3 292-11_A Profond           1\n 4 292-11_B Superficiel       1\n 5 292-11_B Intermediaire     1\n 6 292-11_B Profond           1\n 7 292-11_H Superficiel       1\n 8 292-11_H Intermediaire     1\n 9 292-11_H Profond           1\n10 292-11_M Superficiel       1\n# ℹ 529 more rows\n\n\n\nQuel est le pH moyen tout site/Sol et Profondeur confondu ?\n\n\n\n\n\n\n\nNote\n\n\n\nNous avons le resultat dans le resumé univarié des variables. On peut aussi retrouver via la fonction ci-dessous:\n\n\n\n\n\nCode\ndta %&gt;% \n  summarise(pH_moyen=mean(pH, na.rm = TRUE))\n\n\n  pH_moyen\n1  4.63154\n\n\n\nQuelle la variance de la teneur en Eau ? Quelle est la variance de la teneur en Sodium (Na) ?\n\n\n\nCode\ndta %&gt;% \n  summarise(var_EAU =var(Eau, na.rm = TRUE),\n            var_Sodium =var(Exc.Na, na.rm = TRUE))\n\n\n  var_EAU  var_Sodium\n1 2.11306 0.001288402\n\n\nOu de manière générale\n\n\nCode\ndta |&gt; \n summarise(across(where(is.numeric), list(moy = mean, var = var))) \n\n\n   pH_moy    pH_var  Eau_moy Eau_var Av.P_moy Av.P_var     C_moy     C_var\n1 4.63154 0.1419045 2.697607 2.11306 4.131818 12.89734 0.9706122 0.4080084\n       N_moy       N_var  NO3_moy  NO3_var  NH4_moy  NH4_var Exc.Ac_moy\n1 0.08055659 0.002224225 2.722226 14.09726 5.044249 26.91682   3.781039\n  Exc.Ac_var Exc.Al_moy Exc.Al_var Exc.Ca_moy Exc.Ca_var Exc.Mg_moy Exc.Mg_var\n1   5.203768   3.151095   4.813158  0.3028757  0.8644495  0.6193692   0.842742\n  Exc.K_moy  Exc.K_var Exc.Na_moy  Exc.Na_var Exc.Cations_moy Exc.Cations_var\n1 0.1386271 0.01760183 0.05237477 0.001288402        4.894508         10.1526\n  SatBase_moy SatBase_var Argile_moy Argile_var Limon_moy Limon_var Sable_moy\n1    18.50531    238.9387   23.76438   113.4741  16.12987  72.95708  60.10019\n  Sable_var\n1  323.3766\n\n\n\n\n\n\n\n\nNote\n\n\n\nLa somme des variables Limon, Argile et Sable devrait sommer à 100, mais ce n’est pas le cas à cause des erreurs d’arrondi. Le tableau ci-dessous se lit de la manière suivante. Total représente la somme des proportions exprimée en pourcentage et n le nombre d’observation pour lesquelles la somme des proportion de Limon, Sable et Argil donnent cette valeur.\n\n\n\n\nCode\ncount_percent&lt;- dta %&gt;% \n  mutate(Total = Limon + Argile + Sable)  %&gt;% \n  select(Total) |&gt; \n  group_by(Total) |&gt; \n  count()\n\n\n\n\nReprésentation bivariée\nPour appréhender le jeu de données, il est utile de commencer par comprendre les relations deux à deux entre les variables. On peut commencer par la corrélation entre celles-ci\n\n\nCode\nlibrary(\"corrplot\")\ndta_quanti &lt;- dta |&gt; \n  select(where(is.numeric))\ncor.mat &lt;- round(cor(dta_quanti),2)\ncorrplot(cor.mat, type=\"upper\", order=\"hclust\", \n         tl.col=\"black\", tl.srt=45)\n\n\n\n\n\n\n\n\n\nCode\ncor.mat\n\n\n               pH   Eau  Av.P     C     N   NO3   NH4 Exc.Ac Exc.Al Exc.Ca\npH           1.00 -0.31 -0.45 -0.57 -0.42 -0.17 -0.15  -0.30  -0.19   0.02\nEau         -0.31  1.00  0.12  0.30  0.72  0.48  0.21   0.84   0.81   0.35\nAv.P        -0.45  0.12  1.00  0.66  0.49  0.30  0.07  -0.12  -0.22   0.20\nC           -0.57  0.30  0.66  1.00  0.72  0.24  0.23  -0.02  -0.13   0.31\nN           -0.42  0.72  0.49  0.72  1.00  0.66  0.22   0.40   0.35   0.53\nNO3         -0.17  0.48  0.30  0.24  0.66  1.00  0.05   0.29   0.31   0.50\nNH4         -0.15  0.21  0.07  0.23  0.22  0.05  1.00   0.11   0.10   0.09\nExc.Ac      -0.30  0.84 -0.12 -0.02  0.40  0.29  0.11   1.00   0.98  -0.03\nExc.Al      -0.19  0.81 -0.22 -0.13  0.35  0.31  0.10   0.98   1.00  -0.02\nExc.Ca       0.02  0.35  0.20  0.31  0.53  0.50  0.09  -0.03  -0.02   1.00\nExc.Mg      -0.14  0.71  0.22  0.30  0.66  0.48  0.10   0.44   0.43   0.54\nExc.K       -0.38  0.63  0.61  0.54  0.71  0.46  0.16   0.37   0.31   0.39\nExc.Na      -0.42  0.55  0.40  0.39  0.46  0.23  0.23   0.43   0.37   0.17\nExc.Cations -0.27  0.94  0.06  0.19  0.67  0.51  0.14   0.85   0.84   0.44\nSatBase     -0.16  0.35  0.50  0.45  0.60  0.48  0.02  -0.04  -0.07   0.70\nArgile      -0.02  0.83 -0.16 -0.09  0.50  0.51  0.07   0.81   0.85   0.33\nLimon       -0.04  0.72 -0.09 -0.03  0.49  0.52  0.02   0.66   0.69   0.34\nSable        0.03 -0.84  0.13  0.07 -0.53 -0.55 -0.05  -0.79  -0.83  -0.35\n            Exc.Mg Exc.K Exc.Na Exc.Cations SatBase Argile Limon Sable\npH           -0.14 -0.38  -0.42       -0.27   -0.16  -0.02 -0.04  0.03\nEau           0.71  0.63   0.55        0.94    0.35   0.83  0.72 -0.84\nAv.P          0.22  0.61   0.40        0.06    0.50  -0.16 -0.09  0.13\nC             0.30  0.54   0.39        0.19    0.45  -0.09 -0.03  0.07\nN             0.66  0.71   0.46        0.67    0.60   0.50  0.49 -0.53\nNO3           0.48  0.46   0.23        0.51    0.48   0.51  0.52 -0.55\nNH4           0.10  0.16   0.23        0.14    0.02   0.07  0.02 -0.05\nExc.Ac        0.44  0.37   0.43        0.85   -0.04   0.81  0.66 -0.79\nExc.Al        0.43  0.31   0.37        0.84   -0.07   0.85  0.69 -0.83\nExc.Ca        0.54  0.39   0.17        0.44    0.70   0.33  0.34 -0.35\nExc.Mg        1.00  0.69   0.42        0.79    0.76   0.67  0.62 -0.69\nExc.K         0.69  1.00   0.61        0.62    0.64   0.43  0.39 -0.44\nExc.Na        0.42  0.61   1.00        0.52    0.36   0.33  0.30 -0.34\nExc.Cations   0.79  0.62   0.52        1.00    0.42   0.89  0.77 -0.89\nSatBase       0.76  0.64   0.36        0.42    1.00   0.26  0.31 -0.30\nArgile        0.67  0.43   0.33        0.89    0.26   1.00  0.76 -0.95\nLimon         0.62  0.39   0.30        0.77    0.31   0.76  1.00 -0.92\nSable        -0.69 -0.44  -0.34       -0.89   -0.30  -0.95 -0.92  1.00\n\n\nEn utilisant le package GGallyet notamment la fonction ggpairs, proposer une représentation bivariée des différents couples de variables.\n\n\nCode\nlibrary(GGally)\nggpairs(dta,  columns = 4:21)\n\n\n\n\n\n\n\n\n\nLa visualisation est difficile, d’où l’intérêt d’une approche multivariée.\nAvant celà , on peut essayer de visualiser le lien entre une variable qualitative (Profondeur ou Type de Sol) et variables quantitatives au travers d’une boîte à moustaches. Par exemple\n\n\nCode\ndta %&gt;% \n  ggplot() + \n  aes(x= Profondeur, y = Argile) + \n  geom_boxplot() +\n  xlab('Classe de Profondeur')\n\n\n\n\n\n\n\n\n\nCode\n## ou  boxplot(dta$Argile~ dta$Profondeur)"
  },
  {
    "objectID": "tp1_example.html#approche-factorielle",
    "href": "tp1_example.html#approche-factorielle",
    "title": "Eléments de correction pour le TD1",
    "section": "Approche factorielle",
    "text": "Approche factorielle\nLe but est de faire émerger des typologies de sol. Pour le moment nous mettons de coté les variables qualitatives. Pour visualiser les données on peut commencer par une ACP. l’ACP ne traite que des variables quantitatives, on va considérer les autres variables comme supllémentaires, autrement, dit l’information qu’elles contiennent ne contribuent pa sà la définition des axes.\nPour faire le lien avec le cours on va définir les objets du cours dans le cadre de cet exercice. La matrice des données est \\(X\\).\n\n\nCode\nX &lt;- dta %&gt;% \n  select(where(is.numeric)) %&gt;% as.matrix()\ndim(X)\n\n\n[1] 539  18\n\n\n\nMise en place de l’approche factorielle\n\nComment décider le poids attribuer à chaque individu ?\n\n\n\n\n\n\n\nNote\n\n\n\nPar défaut le poids est 1/n sauf si autre bonne raison\n\n\nLes poids sont stockés dans la matrice \\(W\\)\n\n\nCode\nW &lt;- diag(1/nobs, ncol = nobs, nrow = nobs)\ndim(W)\n\n\n[1] 539 539\n\n\n\n\nDistance à utiliser entre les individus\nSi on considère une distance euclidienne, la matrice de distance \\(M\\) est l’identité.\n\n\nCode\np_quanti &lt;- ncol(X)\nM &lt;- diag(1, ncol = p_quanti, nrow = p_quanti)\ndim(M)\n\n\n[1] 18 18\n\n\nLe cours dit que si \\(X\\) est cebtrée alors l’inertie vaut \\(tr(X^\\top W X M)\\)\nPour vérifier on va définir la matrice \\(X\\) centrée et calculer l’inertie à l’aide de la formule du cours. La fonction tr n’est pas disponible dans R par défaut\n\n\nCode\ntr &lt;- function(X){\n  sum(diag(X))}\n\n\n\n\nCode\nX_center &lt;- dta |&gt; select(where(is.numeric))  |&gt; scale(center = TRUE, scale = FALSE) \ninertie &lt;- tr(t(X_center) %*% W %*% X_center %*% M)\n\n\nL’inertie vaut 825.6839644.\nLes axes principaux seront les vecteurs propres et l’inertie portée par chaque axe, sera la valeur propre associée\n\n\nCode\nVM  &lt;- t(X_center) %*% W %*% X_center %*% M\ninertia_dec &lt;- eigen(VM)$values\n\n\npour faire une ACP non normée dans R, on utilise la fonction PCAde FactomineR, en précisant l’option scale=FALSE pour indiquer que l’on veut un ACP non normée\n\n\n\n\n\n\nNote\n\n\n\nPar défaut la fonction PCA fait une ACP normée !!\n\n\n\n\nCode\ndta_pca &lt;- PCA(X = dta, scale.unit = FALSE, \n               quali.sup = c(1,2,3), ncp = 18)\n#library(Factoshiny)\n\n\nSi on fait une ACP non normée, on constate que le Sable et SatBase contribuent beaucoup plus à la formation des axes que les autres variables. EN effet dans une ACP non normée, l’information (= l’inertie) portée par une variable est la variance de cette variable . Les variances des variables (ordonnées par ordre décroissant) sont rappelées ci-dessous :\n\n\nCode\nordered_variance &lt;- dta |&gt; \n  summarise(across(where(is.numeric), ~var(.x)*(nobs-1)/nobs)) |&gt; \n   pivot_longer( cols = everything(), names_to = \"Variable\", values_to = \"Variance\") |&gt; \n  mutate(Variance = round(Variance, 2)) |&gt; \n  arrange(-Variance)\nordered_variance \n\n\n# A tibble: 18 × 2\n   Variable    Variance\n   &lt;chr&gt;          &lt;dbl&gt;\n 1 Sable         323.  \n 2 SatBase       238.  \n 3 Argile        113.  \n 4 Limon          72.8 \n 5 NH4            26.9 \n 6 NO3            14.1 \n 7 Av.P           12.9 \n 8 Exc.Cations    10.1 \n 9 Exc.Ac          5.19\n10 Exc.Al          4.8 \n11 Eau             2.11\n12 Exc.Ca          0.86\n13 Exc.Mg          0.84\n14 C               0.41\n15 pH              0.14\n16 Exc.K           0.02\n17 N               0   \n18 Exc.Na          0   \n\n\n\n\n\n\n\n\nNote\n\n\n\nAinsi, puisque les variances des variables Sable et SatBase (et dans une moindre mesure Argile et Limon) sont très grandes devant les autres, ces variables contribuent davantage à la formation des premiers axes. Pour bien comprendre, il faut se rendre compte qu’en résumant le jeu de données aux seules variables Sable et SatBase, on représente déjà un pourcentage d’inertie de 67.98.\n\n\nPour voir comment l’information d’une variable se disperse sur les différentes dimensions on peut regarder la contribution de cette variable à la construction des différents axes.\nPar exemple pour le Sable et le pH.\n\n\nCode\nround(dta_pca$var$contrib[c(\"Sable\", \"pH\" ),],2)\n\n\n      Dim.1 Dim.2 Dim.3 Dim.4 Dim.5 Dim.6 Dim.7 Dim.8 Dim.9 Dim.10 Dim.11\nSable 56.42  6.92  0.21  0.66  0.09  0.01  2.19  0.01  0.00   0.01   0.09\npH     0.00  0.00  0.02  0.00  0.21  0.25  0.91  0.11  1.13   2.78  26.47\n      Dim.12 Dim.13 Dim.14 Dim.15 Dim.16 Dim.17 Dim.18\nSable  33.31   0.02   0.05   0.01      0      0      0\npH      0.31  57.55  10.24   0.02      0      0      0\n\n\n\n\n\n\n\n\nImportant\n\n\n\nSi vos données sont toutes dans la même unité de mesure et varient dans des gammes de valeurs identiques: l’ACP non-normée est souvent recommandée.\nSi vos données sont dans des unités de mesure différentes et varient dans des gammes de valeurs différentes: l’ACP normée est recommandée\nl’ACP non normée est basée sur la matrice de covariances, qui se calcule par \\(VM =t(X) W W M\\), avec \\(M\\) la matrice identité.\nl’ACP normée est basée sur la matrice de corrélations, qui se calcule par \\(VM =t(X) W W M\\), mais avec \\(M\\) la matrice diagnonale dont chaque terme diagonale est l’inverse de la variance de la variable concernée\n\n\nIci les variables ont des ordres de grandeur différent, la mesure de pH n’est pas comparable avec la teneur en Sodium par exemple, on va faire une ACP normée,  on propose donc d’équilibrer le poids des variables dans la construction des projections en proposant une ACP normée. Mais avant de passer à cette ACP non normée, on peut vérifier que les vecteurs propres obtenus “à la main# coincident avec les vecteurs propres obtenus par la fonction PCA. On le vérifier sur les deux premiers axes. Pour le vérifier on divise terme à terme chaque terme du vecteur propre obtenu avec PCA par le terme correspondant obtenu à la main.\n\n\nCode\ndta_pca$svd$V[,1:2] / eigen(VM)$vectors[,1:2 ]\n\n\n      [,1] [,2]\n [1,]    1    1\n [2,]    1    1\n [3,]    1    1\n [4,]    1    1\n [5,]    1    1\n [6,]    1    1\n [7,]    1    1\n [8,]    1    1\n [9,]    1    1\n[10,]    1    1\n[11,]    1    1\n[12,]    1    1\n[13,]    1    1\n[14,]    1    1\n[15,]    1    1\n[16,]    1    1\n[17,]    1    1\n[18,]    1    1\n\n\n\n\nACP normée\n\nQuelles variables choisissez-vous de considérer comme supplémentaires (qualitative et ou quantitative) ?\n\n\n\n\n\n\n\nNote\n\n\n\nLes variables illustratives ou supplémntaires n’interviennent pas pour la construction des composantes ou axes. Elles sont utilisées après coup pour mieux comprendre / commenter les résultats. Des individus peuvent aussi être traités comme illustratifs.\n\n\nDans notre exemple, seules les variables qualitatives sont choisies en supplémentaires.\n\nQuelle doit être l’inertie du nuage ?\n\n\n\n\n\n\n\nNote\n\n\n\nDans une ACP normée, la somme des valeurs propres est égale au nombre de variables.\n\n\nOn peut à nouveau le vérifier à la main. Le cours dit que si \\(X\\) est cebtrée alors l’inertie vaut $tr(X^W X M), $ cette fois \\(M\\) est la matrice diagonale contenant l’inverse des variances.\n\n\nCode\np_quanti &lt;- ncol(X)\nvariance &lt;- dta_quanti |&gt; \n  summarise(across(where(is.numeric), ~var(.x)*(nobs-1)/nobs)) |&gt; \n   pivot_longer( cols = everything(), names_to = \"Variable\", values_to = \"Variance\") |&gt; \n  pull(Variance)\nM_norm &lt;- diag(1/variance, ncol = p_quanti, nrow = p_quanti)\ndim(M_norm)\n\n\n[1] 18 18\n\n\n\n\nCode\nVM_norm &lt;- t(X_center) %*% W %*% X_center %*% M_norm\ninertie_norm &lt;- tr(VM_norm)\n\n\nL’inertie dans l’ACP normée vaut 18.\nPour finir l’ACP “à la main”, on peut voir que l’on pourrait toutes les informations pertinentes à partir de la seule étude de la matrice de la corrélation\nPar exemple, l’éboulis des valeurs propres.\n\nA l’aide de la fonction eigen représenter la suite décroissante des valeurs propres. A partir de combien de vecteurs de base considérez-vous que l’information apportée devient négligeable?\n\n\n\nCode\n## Verifier que  Cor(data) = t(X_reduit) %*% W %*% X_reduit\nX_reduit &lt;- X_center %*% sqrt(M)\ncorrelation_mat &lt;- t(X_reduit) %*% W %*% X_reduit\nmax(abs(cor(dta_quanti)-correlation_mat))\n\n\n[1] 321.7766\n\n\nCode\nCor_eigen &lt;- eigen(correlation_mat)\nvaleurspropres &lt;- Cor_eigen$values\nvecteurspropres &lt;- Cor_eigen$vectors\ndta.vp &lt;- data.frame(index = 1:length(valeurspropres), valeurspropres = valeurspropres, inertiepercent = cumsum(valeurspropres)/sum(valeurspropres))\ndta.vp\n\n\n   index valeurspropres inertiepercent\n1      1   5.459321e+02      0.6611877\n2      2   2.093213e+02      0.9147004\n3      3   2.772075e+01      0.9482734\n4      4   2.138866e+01      0.9741776\n5      5   1.070946e+01      0.9871480\n6      6   6.876714e+00      0.9954765\n7      7   2.355919e+00      0.9983298\n8      8   6.460148e-01      0.9991122\n9      9   2.708809e-01      0.9994403\n10    10   1.789621e-01      0.9996570\n11    11   1.128154e-01      0.9997937\n12    12   8.284054e-02      0.9998940\n13    13   5.151668e-02      0.9999564\n14    14   2.953466e-02      0.9999921\n15    15   5.594256e-03      0.9999989\n16    16   6.983405e-04      0.9999998\n17    17   1.825201e-04      1.0000000\n18    18   7.816816e-06      1.0000000\n\n\nCode\ndta.vp |&gt; \n  mutate(diffinertie = valeurspropres-lead(valeurspropres))\n\n\n   index valeurspropres inertiepercent  diffinertie\n1      1   5.459321e+02      0.6611877 3.366108e+02\n2      2   2.093213e+02      0.9147004 1.816006e+02\n3      3   2.772075e+01      0.9482734 6.332085e+00\n4      4   2.138866e+01      0.9741776 1.067920e+01\n5      5   1.070946e+01      0.9871480 3.832751e+00\n6      6   6.876714e+00      0.9954765 4.520795e+00\n7      7   2.355919e+00      0.9983298 1.709904e+00\n8      8   6.460148e-01      0.9991122 3.751339e-01\n9      9   2.708809e-01      0.9994403 9.191881e-02\n10    10   1.789621e-01      0.9996570 6.614671e-02\n11    11   1.128154e-01      0.9997937 2.997485e-02\n12    12   8.284054e-02      0.9998940 3.132386e-02\n13    13   5.151668e-02      0.9999564 2.198201e-02\n14    14   2.953466e-02      0.9999921 2.394041e-02\n15    15   5.594256e-03      0.9999989 4.895915e-03\n16    16   6.983405e-04      0.9999998 5.158204e-04\n17    17   1.825201e-04      1.0000000 1.747033e-04\n18    18   7.816816e-06      1.0000000           NA\n\n\nCode\n#lead est une fonction positionnelle. elle\n# permet d'accèder à une valeur stockée dans une ligne inférieure: elle décale d'un rang le vecteur. le 2eme élément devient le 1er et le 3eme devient le 2eme et ainsi de suite \ndta.vp  |&gt; ggplot() +  geom_col(aes(x=index, y = valeurspropres)) \n\n\n\n\n\n\n\n\n\nCode\ndta.vp  |&gt; ggplot() +  geom_line(aes(x=index, y = inertiepercent)) + ylim(c(0,1)) + ylab(\"Pourcentage d'inertie représentée\")\n\n\n\n\n\n\n\n\n\nOn peut maintenant mettre en place une ACP normée, avec factomineR et en utilisant et factoextra pour des sorties plus agréables. On précise que l’ACP est normée grace à l’option scale.unit = TRUE.\n\n\nCode\ndta_pca &lt;- PCA(X = dta, scale.unit = TRUE, quali.sup = c(1,2,3), ncp = 18, graph = FALSE)\n#library(Factoshiny)\n\n\n\n\n\n\n\n\nNote\n\n\n\nle champs eig de l’objet dta_pcacontient les informations sur les valeurs propres\n\n\nOn peut notamment s’intéresser à la qualité globale des représentations\n\nsur le plan 1-2 : on représente 66.9241274\nsur le plan 1-3 : on représente 57.5578374\nReprésentez l’éboulis des valeurs propres à partir de la sortie dta_pca (ce qui a déjà été fait à la main précédemment).\n\n\n\nCode\ndta_pca$eig |&gt; \n  as.data.frame() |&gt;  \n  rowid_to_column() |&gt; \n  ggplot() + geom_col(aes(x=rowid, y =eigenvalue)) \n\n\n\n\n\n\n\n\n\n\nA partir de combien d’axes factoriels considérez-vous que l’information apportée devient négligeable?\n\n\n\n\n\n\n\nImportant\n\n\n\nIl existe plusieurs “règles” ce qui est le signe qu’il n’y a pas une seule façon de faire mais des guides\nRègle de l’ébouli des valeurs propres: garder les axes correspondant aux valeurs propres situées avant le point d’inflexion (cassure, coude) sur le graphes des valeurs propres.\nRègle de Kaiser: garder les axes correspondant aux valeurs propres supérieures à la moyenne des valeurs propres:\n\nsupérieures à 1 en ACP normée\nsupeérieur à Inertie/p en ACP non normée\n\nRègle empirique: garder les facteurs expliquant un pourcentage de variance cumulée satisfaisant (géneralement 80%)\n\n\nDans notre exemple, avec 3 axes on représente 77.1397764 de l’inertie, l’axe 4 est proche de la valeur moyenne d’inertie.\nTout nous incite à regarder les 3 et éventuellement 4 premiers axes.\n\n\nVariables\nOn peut visualiser le cercle des corrélations\nLe package factoextradonne des outils pour produire des sorties les plus lisibles possibles.\nPour représenter le cercle des corrélations dans un plan principal, on utilise la fonction fviz_pca_var. Sur chaque graphe, qu’est ce qui est représenté?\n\n\nCode\nfviz_pca_var(dta_pca,\n             axes = c(1, 2)) # Numéro des axes à représenter \n\n\n\n\n\n\n\n\n\nCode\nfviz_pca_var(dta_pca,\n             axes = c(1, 3)) #\n\n\n\n\n\n\n\n\n\nCode\nfviz_pca_var(dta_pca,\n             axes = c(2, 3)) # \n\n\n\n\n\n\n\n\n\nPour plus de lisibilité, refaites le même graphique avec seulement les variables bien représentées (par exemple celles pour lesquelles le cos2 de l’angle entre la variable initiale et la variable projetée dans le plan représenté est supérieure à 0.8 ou 0.6 selon les cas). Jouer sur les différentes repésentations pour bien comprendre quelle information est disponible sur chaque projection, on peut arranger les graphiques les uns à coté des autres pour une visualisation plus commode.\n\n\nCode\npplotvar_12 &lt;- fviz_pca_var(dta_pca,\n             axes = c(1, 2), \n             select.var = list(cos2 = 0.8)) # Numéro des axes à représenter \npplotvar_13 &lt;- fviz_pca_var(dta_pca,\n             axes = c(1, 3), \n             select.var = list(cos2 = 0.8)) #\npplotvar_23 &lt;- fviz_pca_var(dta_pca,\n             axes = c(2, 3), \n             select.var = list(cos2 = 0.6)) # \n\n## si on ne veut pas importer tout un package, on peut indiquer qu'on utilise la fonction ggarrange du package ggpur avec la synthaxe suivante\n## on exécute le code uniquement si le package est est installé\nif(\"ggpubr\" %in% installed.packages()[,1]){\n  ggpubr::ggarrange( pplotvar_12 + labs(caption = 'select cos2 &gt; 0.8'), \n                     NULL, \n                     pplotvar_13 + labs(caption = 'select cos2 &gt; 0.8'),  \n                     pplotvar_23 + labs(caption = 'select cos2 &gt; 0.6'),\n                     ncol = 2, nrow = 2)\n}\n\n\n\n\n\n\n\n\n\nIl est important de noter qu’on peut grâce à dta_acp, tracer ce graphique nous même et donc modifier son apparence à notre guise. Par ailleurs les fonction de factoextra renvoie des objets de type ggplot que l’on peut aisément modifier. (aucune excuse pour les graphiques laids !)\nOn se posait la question de l’intérêt d’aller voir l’axe 4, la visualisation ci-dessous nous montre que l’axe 4 porte essentiellement l’information sur NH4.\n\n\nCode\npplotvar_14 &lt;- fviz_pca_var(dta_pca,\n             axes = c(1, 4), \n             select.var = list(cos2 = 0.8)) # \npplotvar_14 \n\n\n\n\n\n\n\n\n\nA l’aide des contributions des différentes variables à la définition des axes, on peut comprendre l’information résumée par ces axes.\n\n\nCode\ndta_pca$var$contrib |&gt; as.data.frame() |&gt; arrange(-Dim.1) |&gt; select(Dim.1)\n\n\n                 Dim.1\nExc.Cations 10.7948976\nEau         10.2869537\nSable        8.9320337\nArgile       8.3692915\nExc.Mg       8.0680012\nN            7.6257192\nLimon        7.2482479\nExc.Ac       6.6410790\nExc.K        6.5019985\nExc.Al       6.3103633\nNO3          4.8972792\nExc.Na       4.0962613\nSatBase      3.6327958\nExc.Ca       2.8569555\nC            1.4042632\npH           1.2715181\nAv.P         0.6866580\nNH4          0.3756832\n\n\nCode\ndta_pca$var$contrib |&gt; as.data.frame() |&gt; arrange(-Dim.2)|&gt; select(Dim.2)\n\n\n                 Dim.2\nAv.P        18.3416002\nC           17.2698714\nExc.Al       9.8791351\nSatBase      9.3284152\nExc.Ac       7.1350777\nArgile       5.6487034\nExc.K        5.5144861\nSable        5.1690662\nN            4.9797246\npH           4.5458035\nExc.Ca       3.4929128\nLimon        3.3331633\nExc.Na       1.8388125\nExc.Cations  1.0983771\nNO3          0.8067869\nEau          0.5672494\nNH4          0.5379330\nExc.Mg       0.5128816\n\n\nCode\ndta_pca$var$contrib |&gt; as.data.frame() |&gt; arrange(-Dim.4) |&gt; select(Dim.4)\n\n\n                  Dim.4\nNH4         83.32422550\nAv.P         5.07745293\nExc.Ca       4.76531991\npH           3.47674191\nExc.K        1.04204242\nExc.Ac       0.54618975\nNO3          0.49368347\nLimon        0.22554066\nEau          0.22252392\nExc.Al       0.22067882\nC            0.20730224\nN            0.19798282\nSatBase      0.10528835\nExc.Mg       0.03464235\nSable        0.02775744\nExc.Cations  0.01430037\nArgile       0.01058951\nExc.Na       0.00773764\n\n\nLa description des axes\n\nl’axe 1 parle de l’eau, des cations, du sable et de l’argile (et du limon)\nl’axe 2 du phosphate et du carbone\npetite remarque sur l’axe 4 qui est essentiellemnt NH4\n\nOn peut aussi utiliser uune visualisation plus graphique en utilisant factoextra\ncontri var axe 1\n\n\nCode\ncontrib_axe1 &lt;- fviz_contrib(dta_pca, choice = 'var', axes = 1)\ncontrib_axe2 &lt;- fviz_contrib(dta_pca, choice = 'var', axes = 2)\ncontrib_axe3 &lt;- fviz_contrib(dta_pca, choice = 'var', axes = 3)\ncontrib_axe4 &lt;- fviz_contrib(dta_pca, choice = 'var', axes = 4)\nif(\"ggpubr\" %in% installed.packages()[,1]){\n  ggpubr::ggarrange( contrib_axe1, \n                     contrib_axe2, \n                     contrib_axe3,  \n                     contrib_axe4,\n                     ncol = 2, nrow = 2)\n}\n\n\n\n\n\n\n\n\n\n\n\nIndividus\nPour représenter la projection des individus dans un plan principal, on utilise la fonction fviz_pca_ind.\n\n\nCode\n# Représentation dans le premier plan_principal\nfviz_pca_ind(dta_pca,\n             axes = c(1, 2)) # Numéro des axes à représenter"
  },
  {
    "objectID": "tp1_example.html#visualiser-la-profondeur-sur-les-différents-plans",
    "href": "tp1_example.html#visualiser-la-profondeur-sur-les-différents-plans",
    "title": "Eléments de correction pour le TD1",
    "section": "Visualiser la profondeur sur les différents plans",
    "text": "Visualiser la profondeur sur les différents plans\n\nDans la fonction fviz_pca_ind, en rajoutant col.ind = donnees_sols$Sol, coloriez les individus selon leur profondeur.\n\n\n\nCode\n# # Représentation dans le premier plan_principal\nfviz_pca_ind(dta_pca,\n              axes = c(1, 2),\n              habillage=3)"
  },
  {
    "objectID": "tp1_example.html#visualiser-les-types-de-sol",
    "href": "tp1_example.html#visualiser-les-types-de-sol",
    "title": "Eléments de correction pour le TD1",
    "section": "visualiser les types de sol",
    "text": "visualiser les types de sol\n\nDans la fonction fviz_pca_ind, en rajoutant col.ind = donnees_sols$Sol, coloriez les individus selon leur type de sol.\n\n\n\nCode\n# # Représentation dans le premier plan_principal\nfviz_pca_ind(dta_pca,\n              axes = c(1, 2),\n              habillage=1) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Représentation dans le premier plan_principal\nplot.PCA(dta_pca, \n         axes = c(1,4), invisible=c('ind.sup'),\n         habillage=1, ## numero de la variable quali  à utiliser pour l'habillage\n         label ='none')\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot.PCA(dta_pca, axes=c(1,4),invisible=c('quali','ind.sup'),habillage=1,label ='none')\n\n\n\n\n\n\n\n\n\nCode\nplot.PCA(dta_pca,choix='var',\n         select='cos2  0.7', ## pour représenter seulement les variables dont le cos2 &gt; 0.7\n         unselect=0, axes = c(1,4) )\n\n\n\n\n\n\n\n\n\nil fallait chercher l’axe 4 pour bien illustrer les différences entre grès et dunaire, l’axe 4 est presque exclusivement l’information sur le NH4."
  },
  {
    "objectID": "references_linear.html",
    "href": "references_linear.html",
    "title": "References",
    "section": "",
    "text": "liste &lt;- \n  readLines('MAF.bib') |&gt; \n  as_tibble() |&gt; \n  filter(stringr::str_detect(value, pattern = '@|keywords')) |&gt; \n  rowid_to_column() %&gt;% \n  mutate(int_part = floor((rowid-1)/2), parity = rowid %% 2) %&gt;% \n  select(-rowid) %&gt;% \n  pivot_wider( values_from = value, names_from = parity, names_prefix = \"key\") |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = '@[:alnum:]+\\\\{')) |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = ',')) \n  \nmaf_liste &lt;- liste %&gt;% \n  filter(str_detect(key0, 'MAF')) %&gt;% \n  select(key1) %&gt;% \n  pull()\n\nlinear_liste &lt;- liste %&gt;% \n  filter(!str_detect(key0, 'MAF')) %&gt;% \n  select(key1) %&gt;% \n  pull()\n  \nNoCite(bib = myBib, linear_liste)"
  },
  {
    "objectID": "references_linear.html#pour-mieux-comprendre-lalgèbre-linéaire-utilisé",
    "href": "references_linear.html#pour-mieux-comprendre-lalgèbre-linéaire-utilisé",
    "title": "References",
    "section": "Pour mieux comprendre l’algèbre linéaire utilisé",
    "text": "Pour mieux comprendre l’algèbre linéaire utilisé\nBrunton, S. (2020). Singular Value Decomposition. URL: https://www.youtube.com/watch?v=gXbThCXjZFM.\nCohen, M. X. (2022). Practical linear algebra for data science. O’Reilly Media, Inc.\nHarville, D. A. (1998). Matrix algebra from a statistician’s perspective.\nYoshida, R. (2021). Linear algebra and its applications with R. Chapman and Hall/CRC. URL: https://shainarace.github.io/LinearAlgebra/."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Méthodes d’Analyse factorielle",
    "section": "",
    "text": "Description du cours\nCe cours présente des techniques statistiques pour décire et viusualiser des données multivariés. Il présentera à la fois les fondements mathématiques (géométriques) mais fera surtout la part belle à la mise en oeuvre pratioque de ces outils. A l’issue de ce cours, vous disposerez d’un ensemble de méthodes pour analyser des ensembles de données complexes et créer des représentations visuelles qui révèlent des motifs, des tendances et des relations entre plusieurs variables. Le cours couvre les sujets suivants :\n\n\nContenu\n\nAnalyse en Composantes Principales (ACP) : Un outil puissant de réduction dimensionnelle qui simplifie les grands ensembles de données tout en préservant autant que possible la variation. Les étudiants apprendront à visualiser des données à haute dimension à l’aide de l’ACP, rendant ainsi plus faciles à interpréter les relations complexes. Une extension, l’Analyse Factorielle Multiple (AFM) permet de prendre en compte des variables quantitatives organisées par groupe (on veut distinguer les variables physiques, des variables chimiques par exemple).\nAnalyse Factorielle Discriminante (AFD) : Cette méthode aide à classifier les observations dans des groupes prédéfinis. Le cours se concentrera sur la manière de différencier visuellement les groupes en utilisant plusieurs variables prédictives et d’interpréter les résultats.\nAnalyse Factorielle des Correspondances (AFC) : Il s’agit ici d’étudier la relation entre deux variables catégorielles et de visualiser les individus.\nAnalyse des Correspondances Multiples (ACM) : Cette méthode généralise l’AFC au cas à plus de deux variables qualitatives.\n\nLe cours mettra un accent particulier sur la visualisation des ensembles de données multivariés complexes. Ces outils visuels sont précieux pour communiquer les résultats des analyses multivariées de manière intuitive et accessible.\nÀ la fin du cours, les étudiants seront compétents dans l’application des méthodes multivariées à une variété d’ensembles de données et auront les compétences nécessaires pour créer des visualisations qui transmettent efficacement les intuitions que l’on peut avoir à partir des données et des éléments clés de la modélisation qui peut suivre.\n\n\nOrganisation du cours\n\n12h de cours\n12h de De TD/TP\n\nChaque cours contiendra un exemple détaillé et la mise en oeuvre pratique de la méthode étudiée ainsi que la présentation des concepts mathématiques (essentiellement géométriques) sur lesquels elle repose.\n\n\nPrérequis\nUne connaissance de base des statistiques, de l’algèbre linéaire et une maîtrise des logiciels statistiques (R essentiellement) sont recommandées"
  },
  {
    "objectID": "TP3.html",
    "href": "TP3.html",
    "title": "Lab3 - AFC et ACM",
    "section": "",
    "text": "$$\n$$"
  },
  {
    "objectID": "TP3.html#objectifs-de-la-séance",
    "href": "TP3.html#objectifs-de-la-séance",
    "title": "Lab3 - AFC et ACM",
    "section": "Objectifs de la séance",
    "text": "Objectifs de la séance\nLe but de la séance est d’utiliser l’AFC et l’ACM sur deux problématiques réelles."
  },
  {
    "objectID": "TP3.html#analyse-factorielle-des-correspondances---exemple",
    "href": "TP3.html#analyse-factorielle-des-correspondances---exemple",
    "title": "Lab3 - AFC et ACM",
    "section": "Analyse factorielle des correspondances - Exemple",
    "text": "Analyse factorielle des correspondances - Exemple\nLes données sont extraites des résultats de la plateforme Parcoursup.\n\nContexte\nLe but de l’étude menée ici etcette étude est d’étudier le lien entre type de formation et département.\n\nQuels sont les départements ayant des offres de formation similaire ?\nQuels sont les types de formations présents préférentiellement dans certains département ?\n\nDonnées :\n\nFichier : parcoursup2023.csv\nVariables qualitatives d’intérêts : Dept le département de la formation concernée, ’Formation`le type de formation.\nVariables additionnelles : Selection vaut sélective si la formation est sélective, Parite est une variable pouvant prendre trois modalités : femininesi la formation comporte plus de 65% de femmes, paritaire si la formation compte entre 35 et 65% de femmes, masculine sinon,Detail`précise le type de formation.\nDimensions : 11 formations disciplines et 97 départements (les départements hors france métropolitaines et l’étranger sont rassemble dans un département fictif 99)\n\n\n\nExemple de code à commenter et discuter\nIdentifier ce que fait le code ci-dessous et comment il peut être mobilisé pour aborder la question de la typologie des départements selon leur offre de formation.\n\npsup_dta &lt;- read.csv(\"https://marieetienne.github.io/datasets/parcoursup2023.csv\",fileEncoding = \"UTF-8\") \n\nhead(psup_dta)\n\ndta_dep_form &lt;- psup_dta |&gt; \n  group_by(Dept, Formation) |&gt; \n  count() |&gt; \n  pivot_wider(names_from = Formation, values_from = n, values_fill = 0) \n\ndta_dep_selection &lt;- psup_dta |&gt; \n  group_by(Dept, Selection) |&gt; \n  count() |&gt; \n  pivot_wider(names_from = Selection, values_from = n, values_fill = 0) \n\ndta_dep_parite &lt;- psup_dta |&gt; \n  group_by(Dept, Parite) |&gt; \n  count() |&gt; \n  pivot_wider(names_from = Parite, values_from = n, values_fill = 0) \n\ndta_dep_detail &lt;- psup_dta |&gt; \n  group_by(Dept, Detail) |&gt; \n  count() |&gt; \n  pivot_wider(names_from = Detail, values_from = n, values_fill = 0) \n\n\ndta_dep_filiere &lt;- dta_dep_form |&gt; inner_join(dta_dep_parite) |&gt; inner_join(dta_dep_selection) |&gt;  column_to_rownames('Dept')\n\n\ndep_filiere.ca &lt;-  CA(dta_dep_filiere , col.sup = 12:ncol(dta_dep_filiere))\n\nfviz_eig(dep_filiere.ca, choice = \"eigenvalue\")\n\ninertia.row &lt;- tibble(Dept= row.names(dta_dep_filiere),\n                      poids = dep_filiere.ca$call$marge.row, \n                  inertie = dep_filiere.ca$row$inertia,\n                  percent.inertie = dep_filiere.ca$row$inertia / sum(dep_filiere.ca$row$inertia),\n                  contrib_Dim1 = round(dep_filiere.ca$row$contrib[,1],2),\n                  contrib_Dim2 = round(dep_filiere.ca$row$contrib[,2],2),\n                  contrib_Dim3 = round(dep_filiere.ca$row$contrib[,3],2))\ninertia.row |&gt;  arrange(-inertie)|&gt; flextable()\n\n\ninertia.col &lt;- tibble(Formation= colnames(dta_dep_filiere[1:11]),\n                      poids = dep_filiere.ca$call$marge.col, \n                  inertie = dep_filiere.ca$col$inertia,\n                  percent.inertie = dep_filiere.ca$col$inertia / sum(dep_filiere.ca$col$inertia), \n                  contrib_Dim1 = round(dep_filiere.ca$col$contrib[,1],2),\n                  contrib_Dim2 = round(dep_filiere.ca$col$contrib[,2]),\n                  contrib_Dim3 = round(dep_filiere.ca$col$contrib[,3]))\ninertia.col |&gt;  arrange(-inertie) |&gt; flextable()\n\n\nfviz_ca_row(dep_filiere.ca, axes = 1:2)\n\nfviz_ca_col(dep_filiere.ca, axes = 1:2, invisible = c(\"col.sup\")) ## bug montre encore les colonnes supplémenatiares\nfviz_ca_col(dep_filiere.ca, axes = 1:2, invisible = c(\"col.sup\"), select.col = list(contrib = 11)) ## trick\n\n\nfviz_ca(dep_filiere.ca, axes = 1:2)\nfviz_ca(dep_filiere.ca, axes = 1:2, select.col =  list(cos2 = 20),  alpha.col=\"cos2\", select.row= list(contrib = 15))"
  },
  {
    "objectID": "TP3.html#analyse-factorielle-des-correspondances-afc---a-vous-de-jouer",
    "href": "TP3.html#analyse-factorielle-des-correspondances-afc---a-vous-de-jouer",
    "title": "Lab3 - AFC et ACM",
    "section": "Analyse factorielle des correspondances (AFC) - A vous de jouer",
    "text": "Analyse factorielle des correspondances (AFC) - A vous de jouer\n\nContexte\nLe but de cette étude est d’étudier le lien entre domaine d’étude, niveau d’étude et genre à l’université :\n\nQuelles sont les disciplines pour lesquelles le profil des étudiants est le même ?\nQuelles sont les disciplines privilégiées par les femmes (resp. par les hommes) ?\nQuelles sont les disciplines pour lesquelles les études sont plus longues ?\n\nDonnées :\n\nFichier : universite.csv\nVariables qualitatives croisées : Discipline et Niveau-sexe\nDimensions : 10 disciplines et croisements de niveau (licence, master, doctorat) avec sexe (homme, femme).\n\n\n\nÉtapes de l’analyse\n\nImporter le jeu de données\n\nIdentifier le format (éditeur de texte).\nImporter sous R.\n\nStatistiques descriptives\n\nIndépendance entre Discipline et sexe ?\nIndépendance entre Discipline et niveau ?\nIndépendance entre niveau et sexe ?\n\nMise en œuvre de l’AFC\n\nChoisir les lignes et colonnes actives.\nUtiliser la fonction CA.\n\nInterprétation des résultats\n\nInterpréter le test du \\(χ^2\\).\nChoisir le nombre d’axes.\nVisualiser et interpréter."
  },
  {
    "objectID": "TP3.html#analyse-des-correspondances-multiples-acm",
    "href": "TP3.html#analyse-des-correspondances-multiples-acm",
    "title": "Lab3 - AFC et ACM",
    "section": "Analyse des correspondances multiples (ACM)",
    "text": "Analyse des correspondances multiples (ACM)\n\nContexte\nObjectif : Caractériser la clientèle d’un organisme de crédit.\nDonnées :\n\nFichier : credit.csv\n66 clients ayant souscrit un crédit à la consommation.\n11 variables qualitatives :\n\nExemple : Marché, Apport, Impayé, Taux d'endettement, etc.\n\n\n\n\nÉtapes de l’analyse\n\nImporter le jeu de données\n\nIdentifier le format (éditeur de texte).\nImporter sous R.\nVérifier le type des variables.\n\nStatistiques descriptives\n\nIdentifier les modalités rares.\nRegrouper les modalités si nécessaire.\nIdentifier les variables liées.\n\nMise en œuvre de l’ACM\n\nChoisir les éléments actifs et supplémentaires.\nUtiliser la fonction MCA.\n\nInterprétation des résultats\n\nChoisir le nombre d’axes.\nVisualiser et interpréter les axes factoriels.\n\nSynthèse des résultats\n\nRédiger un rapport de l’analyse : 2 pages, 3 graphiques, 5 statistiques numériques maximum."
  },
  {
    "objectID": "TP1.html",
    "href": "TP1.html",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "",
    "text": "$$\n$$"
  },
  {
    "objectID": "TP1.html#préparation-de-lenvironnement",
    "href": "TP1.html#préparation-de-lenvironnement",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Préparation de l’environnement",
    "text": "Préparation de l’environnement\n\nOuvrir un navigateur web et se connecter au serveur de calcul.\nCréer un Projet (File –&gt; New Project) ou bien en cliquant en haut à droite. Le travail par projet facilite l’accès aux données (notamment lorsque l’on passe d’un ordinateur à l’autre) et permet surtout de “zapper” d’un projet à un autre.\nChoisissez Créer un projet depuis un Nouveau Repertoire, nommez le MAF_TD1 (comme toujours en programmation on évite les caractères spéciaux, c’est-à-dire, les accents, les espaces entre autres)\nPour pouvoir garder le code et l’interprétation des résultats au même endroit nous allons utiliser un type de document Quarto qui est adapté pour mélanger code et texte. Quarto accepte du code R mais aussi Python et Julia. Créer un fichier TP1_Exo1.qmd. Vous pouvez utiliser le fichier d’exemple.\nPassez en mode source(en haut à gauche) au lieu de Visual ceci permet de mieux comprendre la structure d’un document quarto."
  },
  {
    "objectID": "TP1.html#structure-document-quarto",
    "href": "TP1.html#structure-document-quarto",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Structure Document Quarto",
    "text": "Structure Document Quarto\nUn document Quarto se divise en plusieurs sections clés qui facilitent l’organisation de l’analyse, l’intégration de code, et la présentation des résultats. Voici une présentation des principales composantes :\n\nEn-tête YAML\nC’est la section de métadonnées du document. Elle est située en haut du fichier et est encadrée par des lignes —. On y définit des informations essentielles telles que : title : le titre du document ; author : l’auteur ou les auteurs du document ; date : la date de création, qui peut être dynamique avec R, par exemple en utilisant date: “r Sys.Date()” ; format : le format de sortie (HTML, PDF, Word, revealjs pour les présentations, etc.).\nExemple d'en-tête YAML :\n\n---\ntitle: \"Analyse de Données avec R\"\nauthor: \"Votre Nom\"\ndate: \"`r Sys.Date()`\"\nformat: html\n---\n\n\n\nTexte en Markdown\nLa rédaction du texte dans Quarto utilise la syntaxe Markdown pour structurer le contenu de manière simple et lisible. Markdown permet de formater le texte (titres, listes, liens, etc.) sans avoir à écrire du code complexe. Par exemple :\nExemple :\n\n## Introduction\nCe document présente une analyse de données en utilisant **R**.\n- Point 1\n- Point 2\n\nLe markup langage markdown permet aussi d’insérer des formules mathématiques, comme du latex.\n\n\nBlocs de Code\nQuarto permet d’intégrer du code R (mais aussi Python, et Julia) grâce à des blocs de code, chunks. Les blocs de code sont délimités par trois accents graves (triple backtick), avec le langage spécifié entre accolades ({}). Les blocs peuvent exécuter du code directement dans le document et afficher les résultats en ligne.\nExemple de bloc de code en R :\nLes options de rendu du bloc de code peuvent être précisées. Par exemple ici * #| echo: true permet de montrer le code * #| eval: false permet de ne pas executer le code\nUne présentation plus complète des options, pour un rendu plus fin est disponible sur le site de Quarto.\nLe bloc peut être défini en tapant * manuellement les triples backticks, * ou en utilisant le menu Code –&gt; Insert Chunk, * ou avec le raccourci CTRL + ALT + i\n\n\nRendu et Exportation du Document\nUne fois le document terminé, on peut le rendre dans le format souhaité en utilisant la commande suivante dans le terminal quarto render mon_document.qmdou en cliquant sur Render dans RStudio.\nCette commande crée une version finalisée du document dans le format spécifié (HTML, PDF, etc.).\nAvec Quarto on peut tout autant faire des slides, des rapports en pdf, en word etc. Ceci permet de s’assurer que les résulats présentés sont ceux de l’analyse et c’est un premier pas important dans le sens d’assurer plus de reproductibilité en science. (d’autres outils sont utiles voir ici )\nC’est très utile en TP puisque vous pouvez commenter les analyses proposées, les résultats obtenus directement dans le fichier qui contient les codes permettant d’obetenir ces résultats.\nPlus largement, en suivant cette structure, vous pouvez organiser vos analyses de manière professionnelle et claire.\n\n\nCréation du document\nLors de la mise en place de l’analyse, on peut éxécuter chaque chunk avec le raccourci CTL + Enter, ou en cliquant sur la petite flèxche verte en haut à droite du chunk."
  },
  {
    "objectID": "TP1.html#comprendre-les-données",
    "href": "TP1.html#comprendre-les-données",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Comprendre les données",
    "text": "Comprendre les données\n\nImportation\nNous allons importer les données et les manipuler en utiliser les possibilités de la suite de package tidyverse. Les données sont disponibles sur ce lien\n\nlibrary(tidyverse) # Pour la manipulation de données\ndonnees_sols &lt;- read.table(\"https://marieetienne.github.io/datasets/donnees_sols.txt\",\n                           sep = \";\", # separateur de champs\n                           header = TRUE, # 1ere ligne donne le nom des colonnes\n                           encoding = \"UTF-8\")  # Encodage initial du fichier\n\nLe jeu de données donnees_sols regroupe donc les mesures chimiques surtous les types de sols. Les auteurs précisent le préfixe Exc signifie échangeable et le préfixe P signifie Available.\n\n\nUne première exploration\nProposer des résumés univariés de chaque variable présente dans le jeu de données.\n\nCombien y a t-il de variables quantitatives / qualiltatives?\nCombien d’échantillons sont mesurés par site ?\nSont-ils tous prélevés à la même profondeur ?\nQuel est le pH moyen tout site/Sol et Profondeur confondu ?\nChercher le sens de chaque variable.\nAv.P Phospore disponible\nC Carbone\nN Azote\nNO3 Nitrate\nNH4 Amonium\nExc.Ac Actinium Echangeable\nExc.Al Aluminium Echangeable\nExc.Ca Calcium Echangeable\nExc.Mg Magnésium 2changeable\nExc.K Potassium échangeable\nExc.Na Sodium échangeable\nExc.Cations Cations (ions chargés positivement) échangeables\nSatBase Taux de Saturation du sol\nArgile pourcentage d’argile dans le sol,\nLimon pourcentage de Limon dans le sol,\nSable pourcentage de sable dans le sol.\nQuelle la variance de la teneur en Eau ? Quelle est la variance de la teneur en Sodium (Na) ?\n\n\n\nReprésentation bivariée\nPour appréhender le jeu de données, il est utile de commencer par comprendre les relations deux à deux entre les variables. On peut commencer par la corrélation entre celles-ci\nEn utilisant le package GGallyet notamment la fonction ggpairs, proposer une représentation bivariée des différents couples de variables.\nLa visualisation est difficile, d’où l’intérêt d’une approche multivariée."
  },
  {
    "objectID": "TP1.html#approche-factorielle",
    "href": "TP1.html#approche-factorielle",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Approche factorielle",
    "text": "Approche factorielle\nLe but est de faire émerger des typologies de sol. Pour le moment nous mettons de coté les variables qualitatives.\n\nMise en place de l’approche factorielle\n\nComment décider le poids attribuer à chaque individu ?\n\n\n\nQuelle distance entre variables choisir ?\n\n\n\nQuelles varaibles choisissez vous de considérer comme supplémentaires (qualitative et ou quantitative)\n\n\n\nQuelle doit être l’inertie du nuage ?\n\n\nCes choix étant faits, on peut lancer une analyse en composante principale.\n\n\nACP “à la main”\nL’ACP consiste à construire une nouvelle base de \\({\\mathbb{R}}^p\\) pour représenter les individus.\n\nCombien vaut \\(p\\) ici ?\nCette base est formée des veteurs propres d’une matrice. De quelle matrice parle-t-on ?\n\n\n\nA l’aide de la fonction eigen représenter la suite décroissante des valeurs propres. A partir de combien de vecteurs de base considérez-vous que l’information apportée devient négligeable?\n\nPour réaliser l’ACP, on utilise deux packages FactomineR qui fait les calculs et factoextrapour des sorties plus agréables\n\nlibrary(FactoMineR)\nlibrary(factoextra)\n\nVous pouvez maintenant lancer l’ACP sur le jeu de données du sol.\n\nsols.pca &lt;- PCA(X = donnees_sols,\n    scale.unit = , ## ACP normée ou non ? \n    ncp = , ## nombre de composantes principales à garder, dans le doute on garde tout\n    ind.sup = , ## numero des lignes des individus supplémentaires\n    quanti.sup = , ## numero des colonnes des variables quanti sup\n    quali.sup = , ## numero des colonnes des variables quanti sup\n    row.w = , ## poids des individus\n    col.w = , ## poids des variables \n    graph = , ## TRUE or FALSe doit on sortir les graphes\n    axes = ,  ## pour quels axes \n    )\n\n\nsols.pca &lt;- PCA(X = donnees_sols[, -2],\n    scale.unit = TRUE, ## ACP normée ou non ? \n    ncp = 18, ## nombre de composantes principales à garder, dans le doute on garde tout\n    quali.sup = c(1,2), ## numero des colonnes des variables quali sup\n    graph = FALSE\n    )\n\n\nIndiquer comment est construit l’objet sols.pca et détailler ce qu’il contient.\nA l’aide de la commande sols.pca$eig, visualisez le pourcentage d’information expliqué par chaque composante principale (ou nouvelle colonne). Comparer avec ce qui a été trouvé “à la main”. Les vecteurs propres sont disponibles dans sols.pca$svd$V, comparer également les deux premiers axes principaux et les vecteurs propres trouvés à la main."
  },
  {
    "objectID": "TP1.html#mise-en-oeuvre-pratique-de-lacp-pour-analyse-des-données-de-sol",
    "href": "TP1.html#mise-en-oeuvre-pratique-de-lacp-pour-analyse-des-données-de-sol",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Mise en oeuvre pratique de l’ACP pour analyse des données de sol",
    "text": "Mise en oeuvre pratique de l’ACP pour analyse des données de sol\n\nReprésentez l’éboulis des valeurs propres à partir de la sortie sols.pca (ce qui a déjà été fait à la main précédemment).\n\n\nA partir de combien d’axes factoriels considérez vous que l’information apportée devient négligeable?\n\n\nVariables\nLe package factoextradonne des outils pour produire des sorties les plus lisibles possibles.\nPour représenter le cercle des corrélations dans un plan principal, on utilise la fonction fviz_pca_var. Sur chaque graphe, qu’est ce qui est représenté?\n\nPour plus de lisibilité, refaites le même graphique avec seulement les variables bien représentées (par exemple celles pour lesquelles le cos2 de l’angle entre la variable initiale et la variable projetée dans le plan représenté est supérieur à 0.8). Jouer sur les différentes repésentations pour bien comprendre quelle information est disponible sur chaque projection\n\nIl est important de noter qu’on peut grâce à resultat_acp, tracer ce graphique nous même et donc modifier son apparence à notre guise.\n\nAvec la fonction corrplot et l’objet sols.pca$var$cor, représentez les corrélations entre anciennes et nouvelles variables.\n\n\nQuel est l’intérêt du cercle de corrélation par rapport à ce dernier graphique?\n\n\n\nIndividus\nPour représenter la projection des individus dans un plan principal, on utilise la fonction fviz_pca_ind.\n\nDans la fonction fviz_pca_ind, en rajoutant col.ind = donnees_sols$Sol, coloriez les individus selon leur typologie de sol.\n\n\n\n\n\nReprésenter la projection des individus dans les premiers plans principaux. Quel plan vous semble bien distinguer les types de sol? Comment interprétez-vous alors les typologies de sols au vu des premières variables?\nFaites le même exercice avec les profondeurs et essayez d’interpréter quel(s) gradient(s) distingue(nt) bien les profondeurs?"
  },
  {
    "objectID": "TP1.html#comment-trouver-la-représentation-qui-discrimine-le-mieux-les-types-de-sol.",
    "href": "TP1.html#comment-trouver-la-représentation-qui-discrimine-le-mieux-les-types-de-sol.",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Comment trouver la représentation qui discrimine le mieux les types de sol.",
    "text": "Comment trouver la représentation qui discrimine le mieux les types de sol.\n\nQuelle méthode vous semble adaptée ?\nPouvez-vous proposer un métodologie pour la mettre en oeuvre"
  },
  {
    "objectID": "TP1.html#plan-de-létude",
    "href": "TP1.html#plan-de-létude",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Plan de l’étude",
    "text": "Plan de l’étude\n\nUne étude descriptive simple et bivariée pour identifier des individus atypiques, les variables les plus corrélées.\nMettre en place une ACP\n\nBien réfléchir aux variables actives et supplémentaires\nChoisir la métrique adaptée et les poids des individus.\nRéaliser l’ACP.\n\nInterprétation\n\nDiscuter la qualité de la représentation\nExpliquer ce qui est visible sur les différents plans factoriels\nCombien de plan factoriels vous semblent intéressants ?\nDonner un sens aux axes factoriels.\nIdentifier les disciplines qui se ressemblent (elles mettent en jeu les mêmes compétences physiques)\nQuelles sont les disciplines qui contribuent le plus au premier axe factoriel ?\nQuels sont les individus qui contribuent le plus à ce même premier axe ?\nComment le score est il lié aux différentes disciplines ?\nEst ce qu’un athlète qui est excellent au 100m, est aussi excellent au saut en longueur ?\n\nTechnique\n\nCalculer manuellenent (sans package) la corrélation entre les performances au 100m et le premier axe factoriel\nReconstruisez à la main les coordonnées des individus dans le premier plan factoriel\ncalculer à la main les contributions des différents individus"
  },
  {
    "objectID": "01_intro.html#où-lon-commence-par-parler-de-manchots",
    "href": "01_intro.html#où-lon-commence-par-parler-de-manchots",
    "title": "Introduction",
    "section": "Où l’on commence par parler de manchots",
    "text": "Où l’on commence par parler de manchots\n\nData presentationData descriptionLes questions que l’on se pose\n\n\nFrom the palmerpenguins package, data courtesy of Dr. Kristen Gorman and the Palmer Station, Antarctica LTER.\n\nlibrary(palmerpenguins)\ndata(penguins)\nhead(penguins, n= 10)\n\n# A tibble: 10 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\npenguins &lt;- penguins %&gt;% na.omit() %&gt;% mutate(year=as.factor(year))\n\n\n\nArtwork by @allison_horst\n\n\n\nPoint de vue science des données\n\nComment représenter ces données en perdant le moins d’information possible? Visualisation\nToutes les variables sont-elles utiles ? Compression\nPeut-on mettre en évidence des liens entre variables ? Compression\nPeut-on mettre en évidence des liens entre individus ? Compression\n\nPoint de vue biologique\n\nQuelles sont les différences morpholgiques entre espèces, entre sexe et entre les îles ?\nExiste-t-il des relations morphométriques ?"
  },
  {
    "objectID": "01_intro.html#représenter-cest-déjà-comprendre",
    "href": "01_intro.html#représenter-cest-déjà-comprendre",
    "title": "Introduction",
    "section": "Représenter c’est déjà comprendre",
    "text": "Représenter c’est déjà comprendre\n\nReprésenter les liens entre variables 2 à 2DANGEREt si on essayait de faire mieux ?\n\n\n\n\npenguins %&gt;%\n  select(species, body_mass_g, ends_with(\"_mm\")) %&gt;% \n  GGally::ggpairs(aes(color = species),\n          columns = c(\"flipper_length_mm\", \"body_mass_g\", \n                      \"bill_length_mm\", \"bill_depth_mm\")) +\n  scale_colour_manual(values = c(\"darkorange\",\"purple\",\"cyan4\")) +\n  scale_fill_manual(values = c(\"darkorange\",\"purple\",\"cyan4\"))\n\n\n\n\n\n\n\n\n\nProjection sur un espace à deux dimensions\n\n\nLe mensonge de la projection\n\n\n\n\n\n\n\n\nComment ?\nEn\n\nTrouvant une (ou plusieurs) représentations en 2 dimensions la plus fidèle possible,\nFaisant apparaître les liens plus complexes entre variables (\\(X_3 = X_1 + X_2\\))\nétant capable d’identifier les individus qui se ressemblent globalement"
  },
  {
    "objectID": "01_intro.html#mise-en-forme-des-données",
    "href": "01_intro.html#mise-en-forme-des-données",
    "title": "Introduction",
    "section": "Mise en forme des données",
    "text": "Mise en forme des données\nToutes les méthodes d’analyse factorielle organisent les données dans un tableau composé de n individus (lignes) et de p colonnes (colonnes).\nUne ligne regroupe toutes les caractéristiques d’un individu.\n\nComment représenter les différentes variablesRappel des données sur les manchots\n\n\n\nSi une caractéristique est quantitative, alors on note dans une colonne la valeur mesurée sur l’individu.\nSi une caractéristique \\(j\\) est qualitative,\n\nsoit on note sa modalité dans la colonne \\(j\\),\nsoit on utilise la représentation one hot encoding, qui consiste à représenter cette caractéristique qualitative sur autant de colonnes que de modalités et attribuer un \\(1\\) dans la colonne correspondant à la modalité de l’individu et 0 aux autres.\n\n\n\n\nDonnées disponibles dans le package palmerpenguins mises à disposition par le Dr. Kristen Gorman et the Palmer Station, Antarctica LTER.\nOn a mesuré les caractéristiques morphologiques de divers manchots :\n\n\nLes 3 premières lignes (parmi 333 )\n\n\n# A tibble: 3 × 8\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n3 Adelie  Torgersen           40.3          18                 195        3250\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;fct&gt;\n\n\n\n\nspecies : 3 espèces possibles (Adelie, Chinstrap, Gentoo)\nisland : l’île sur laquelle le mancho a été observé (Biscoe, Dream, Torgersen)\nbill_length_mm : la longueur du bec,\nbill_depth_mm : l’épaisseur du bec,\nflipper_length_mm : la longueur de la nageoire,\nbody_mass_g : le poids du corps.\nsex : le sexe du manchot (male,female)\nyear : l’année de l’observation"
  },
  {
    "objectID": "01_intro.html#mise-en-forme-des-données-1",
    "href": "01_intro.html#mise-en-forme-des-données-1",
    "title": "Introduction",
    "section": "Mise en forme des données",
    "text": "Mise en forme des données\n\nNotationExemple\n\n\nDans la suite on va noter \\({\\boldsymbol{X}}\\) la matrice des données, \\({\\boldsymbol{X}}\\in {\\mathbb{R}}^{n\\times p}\\).\n\\(x_{\\class{alea}{i}\\class{orange}{j}}\\) est la valeur de la variable \\(\\class{orange}{j}\\) mesurée pour l’individu \\(\\class{alea}{i}.\\)\n\\[{\\boldsymbol{X}}= \\overset{\\color{orange}{\\begin{matrix}var_1& \\ldots \\ &  \\ \\ldots \\ &\\  \\ldots\\  & \\  var_p \\end{matrix}}}{\\begin{pmatrix}\nx_{\\class{alea}{1}}^{\\class{orange}{1}} &  \\ldots &  \\ldots &\\ldots &  x_{\\class{alea}{1}}^{\\class{orange}{p}}\\\\\n\\vdots & & &  &\\vdots \\\\\n& &  x_{\\class{alea}{i}}^{\\class{orange}{j}} & & \\\\\n\\vdots & & & & \\vdots \\\\\nx_{\\class{alea}{n}}^{\\class{orange}{1}} & & & & \\ldots x_{\\class{alea}{n}}^{\\class{orange}{p}}\\\\\n\\end{pmatrix}}\\]\n\n\nEcrire les 2 premières lignes de \\(\\Xbf\\) pour l’exemple des manchots\n\n\n\nComment visualiser au mieux ces données pour faire apparaître les liens entre variables et identifier des resemblances entre individus ?"
  },
  {
    "objectID": "01_intro.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau",
    "href": "01_intro.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau",
    "title": "Introduction",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nIdée 1 : on représente les liens des variables 2 à 2 – Focus sur les données quantitatives"
  },
  {
    "objectID": "01_intro.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-1",
    "href": "01_intro.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-1",
    "title": "Introduction",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nIdée 1 : on a dit que c’était dangereux"
  },
  {
    "objectID": "01_intro.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-2",
    "href": "01_intro.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-2",
    "title": "Introduction",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nObjectifs\n\nReprésenter sans perdre trop d’information,\n\nPour cela, on veut pouvoir\n\nQuantifier la quantité d’information disponible ou perdue par une représentation\n\n\nComprendre quelles sont les informations redondantes (variables liées),\nIdéalement des individus éloignés dans le nuage initial, restent éloignés dans la représentation"
  },
  {
    "objectID": "01_intro.html#deux-points-de-vue-complémentaires",
    "href": "01_intro.html#deux-points-de-vue-complémentaires",
    "title": "Introduction",
    "section": "Deux points de vue complémentaires",
    "text": "Deux points de vue complémentaires\n\n\nLe nuage des individus \\(C^n\\)\nOn peut considérer qu’un individu \\(i\\) est un vecteur \\(\\class{alea}{\\boldsymbol{x}_{i}}\\) dans un espace de dimension \\(p\\). Par convention tous les vecteurs sont des vecteurs colonnes, donc on peut écrire\n\\[{\\boldsymbol{X}}=\\begin{pmatrix}\n\\class{alea}{\\boldsymbol{x}_{1}}^\\top\\\\\n\\vdots \\\\\n\\class{alea}{\\boldsymbol{x}_{n}}^\\top\\\\\n\\end{pmatrix},\\]\nL’ensemble des \\(n\\) vecteurs forme le nuage des individus (ce qu’on représente classiquement).\n\n\n\n\n\n\n\n\n\n\nLe nuage des variables \\(C^p\\)\nOn peut considérer qu’une variable \\(j\\) est un vecteur \\(\\class{orange}{\\boldsymbol{x}^{j}}\\) dans un espace de dimension \\(n\\) et on peut écrire\n\\[{\\boldsymbol{X}}=\\begin{pmatrix}\n\\class{orange}{\\boldsymbol{x}^{1}} & \\ldots & \\class{orange}{\\boldsymbol{x}^{p}}\n\\end{pmatrix},\\]\nL’ensemble des \\(p\\) vecteurs forme le nuage des variables.\n\n\n\n\n\n\n\n\n\n\n\nBien sûr les deux nuages sont intimement liés"
  },
  {
    "objectID": "01_intro.html#un-aperçu-du-type-de-données",
    "href": "01_intro.html#un-aperçu-du-type-de-données",
    "title": "Introduction",
    "section": "Un aperçu du type de données",
    "text": "Un aperçu du type de données\n\nACPAFC\n\n\nComprendre les relations entre des variables toute quantitatives.\nExample\nQuels sont les liens entre les différentes variables morphométriques ?\n\n\nX_pca &lt;- penguins %&gt;%select(where(is.numeric)) \nhead(X_pca)\n\n\n# A tibble: 6 × 4\n  bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1           39.1          18.7               181        3750\n2           39.5          17.4               186        3800\n3           40.3          18                 195        3250\n4           36.7          19.3               193        3450\n5           39.3          20.6               190        3650\n6           38.9          17.8               181        3625\n\n\n\\[\\Xbf \\in \\R^{n\\times d}; \\quad \\Xbf = \\begin{pmatrix}\nx_{1,1} &  \\ldots & x_{1,p} \\\\\n\\vdots & &\\vdots \\\\\nx_{n,1} &  \\ldots & x_{n,p} \\\\\n\\end{pmatrix}.\n\\]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOn souhaite étudier les liens entre deux variables qualitatives.\nExample\nComment la répartition entre espèce diffère entre les îles.\n\n\nX_acm &lt;- penguins %&gt;%select(species, island) \nhead(X_acm)\n\n\n# A tibble: 6 × 2\n  species island   \n  &lt;fct&gt;   &lt;fct&gt;    \n1 Adelie  Torgersen\n2 Adelie  Torgersen\n3 Adelie  Torgersen\n4 Adelie  Torgersen\n5 Adelie  Torgersen\n6 Adelie  Torgersen\n\n\n\\[\\Xbf = \\begin{pmatrix}\n\\class{bleu}{a_1} & \\class{orange}{b_1} \\\\\n\\class{bleu}{\\vdots} &\\class{orange}{\\vdots} \\\\\n\\class{bleu}{a_n} & \\class{orange}{b_n} \\\\\n\\end{pmatrix}, \\quad a_{i}\\in \\mathcal{A}, \\ \\#\\mathcal{A}= p,\\quad   b_{i}\\in \\mathcal{B}, \\ \\#\\mathcal{B}= q.  \n\\]"
  },
  {
    "objectID": "01_intro.html#organisation-du-cours",
    "href": "01_intro.html#organisation-du-cours",
    "title": "Introduction",
    "section": "Organisation du cours",
    "text": "Organisation du cours\n\nCes deux méthodes ont beaucoup de points communs et de nombreuses variantes intéressantes\nComprendre finement l’ACP permet de bien comprendre toutes les extensions suivantes\nLa mise en oeuvre requiert un peu de pratique car il faut faire des choix avisés."
  },
  {
    "objectID": "01_intro.html#objectifs-de-ce-cours",
    "href": "01_intro.html#objectifs-de-ce-cours",
    "title": "Introduction",
    "section": "Objectifs de ce cours",
    "text": "Objectifs de ce cours\nDécouvrir des méthodes permettant de\n\nTrouver une (ou plusieurs) représentations en 2 dimensions la plus fidèle possible,\nFaire apparaître les liens entre les différentes variables,\nIdentifier les individus qui se ressemblent.\n\nLes ingrédients\n\nune mesure de la quantité d’information présente dans un jeu de données,\nun peu de géométrie et d’algèbre linéaire,\nun bon esprit pratique pour bien poser le problème au départ\ndes données bien rangées dans un tableau \\(\\Xbf\\) où\n\nune ligne \\(i\\) correspond à un individu\nune colonne \\(j\\) à une variable \\(X_{ij}\\) la valeur de la variable \\(j\\) mesurée sur l’individu \\(i\\)."
  },
  {
    "objectID": "01_intro.html#plan-du-cours",
    "href": "01_intro.html#plan-du-cours",
    "title": "Introduction",
    "section": "Plan du cours",
    "text": "Plan du cours\n\nQuantifier l’information\nAnalyse en composantes principales ACP\n\nUn exemple d’ACP\n\nComprendre les mécanismes derrière l’ACP (notion d’inertie, distance entre individus, changement de repères, la correlation comme un cosinus)\n\nAnalyse Factorielle multiple AFM : une extension de l’ACP pour tenir de groupes de variables\nAnalyse Factorielle Discriminante AFD : une extension de l’ACP pour tenir compte de groupes d’individus\nAnalyse Factorielle des Correspondances AFC\nAnalyse des Correspondances multiples ACM : lorsqu’on a plus que deux variables qualitatives"
  },
  {
    "objectID": "01_afm.html#quelques-exemples",
    "href": "01_afm.html#quelques-exemples",
    "title": "Analyse Factorielle Multiple",
    "section": "Quelques exemples",
    "text": "Quelques exemples\n\nOn (re)commence dans le DoubsNotes des élèvesAnalyse sensorielle\n\n\nOn a mesuré les caractéristiques physico chimiques sur 30 sites différents le long de la rivière Doubs.\n\n\nLes 4 premières lignes (parmi 30) du jeu de données doubs.env\n\n\n# A tibble: 30 × 11\n    das   alt   pen   deb    pH   dur   pho   nit   amm   oxy   dbo\n  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1   0.3   934  48    0.84   7.9    45  0.01  0.2   0     12.2   2.7\n2   2.2   932   3    1      8      40  0.02  0.2   0.1   10.3   1.9\n3  10.2   914   3.7  1.8    8.3    52  0.05  0.22  0.05  10.5   3.5\n4  18.5   854   3.2  2.53   8      72  0.1   0.21  0     11     1.3\n# ℹ 26 more rows\n\n\nOn mesure des caractéristiques physiques, des caractéristiques chimiques, des caractéristiques écologiques.\n\n\ndas : distance à la source ( \\(km\\) ),\nalt : altitude ( \\(m\\) )\npen : la pente (dénivelé pour 1000m)\ndeb : le débit () \\(m^3.s^{-1}\\) )\npH : le pH de l’eau,\ndur : la concentration en calcium ( \\(mg.L^{-1}\\) ),\npho : concentration en phosphate ( \\(mg.L^{-1}\\) ),\nnit : concentration en nitrate ( \\(mg.L^{-1}\\) ),\namn : concentration en ammonium ( \\(mg.L^{-1}\\) ),\noxy : concentration d’oxygène dissous ( \\(mg.L^{-1}\\) ),\ndbo : Demande biologique en oxygène ( \\(mg.L^{-1}\\) ).\n\n\nSi on travaille sur une ACP normée, puisqu’il ya 4 descripteurs pour les caractéristiques physiques, et seulement 2 pour les caractéristiques écologiques, les varaibles physiques auront par construction plus de poids que les variables écologiques.\n\n\nOn s’intéresse aux notes des 30 élèves d’une classe. Le tableau de note complet contient\n\n8 notes de mathématiques\n4 notes d’anglais\n3 notes d’histoire géographie\n3 notes de français\n1 note de dessin\n\nOn aimerait visualiser les notes à l’aide d’une méthode factorielle, notamment pour savoir si ce sont les mêmes élèves qui rencontrent des difficultés dans les différentes matières.\n\nOn normalise les données car les gammes de variation des notes dans les différentes matières sont assez différentes\nQue se passe-t-il si on fait une ACP normée ?\n\nLes mathématiques ont 8 fois plus de poids dans la détermination des axes que la note de dessin.\nEst ce vraiment ce qu’on veut ?\n(ça dépend qui “on” désigne)\n\n\nExemple tiré des cours de F. Husson\n10 vins blancs du Val de Loire : 5 Vouvray - 5 Sauvignon • descripteurs sensoriels : acidité, amertume, odeur agrume, etc.\n\n\n\nvins &lt;- read.table(\"https://husson.github.io/MOOC_AnaDo/AnaDo_JeuDonnees_VinsJury.csv\", \n      header=TRUE, sep=\";\",dec=\".\", row.names=1, check.names=FALSE, fileEncoding=\"latin1\")\nhead(vins, n= 4)\n\n                      cepage Int.av.agitation Int.ap.agitation Expression\nS Michaud          Sauvignon            7.750            8.000   7.142857\nS Renaudie         Sauvignon            7.125            7.625   7.000000\nS Trotignon        Sauvignon            7.125            7.375   7.142857\nS Buisse Domaine   Sauvignon            5.500            6.250   5.428571\n                    O.fruit O.passion O.agrume O.fruit.confit O.vanille\nS Michaud          4.250000  2.428571 5.714286      0.6666667 0.5000000\nS Renaudie         4.428571  3.142857 5.250000      0.6666667 0.5000000\nS Trotignon        5.142857  4.000000 5.250000      1.0000000 0.5000000\nS Buisse Domaine   4.250000  2.428571 3.571429      1.5000000 0.6666667\n                    O.boisee   O.champ O.vegetale O.florale O.alcool\nS Michaud          0.3333333 0.3333333   6.500000  6.571429 1.666667\nS Renaudie         0.3333333 0.3333333   6.125000  6.428571 3.400000\nS Trotignon        0.3333333 0.5000000   4.625000  5.142857 2.833333\nS Buisse Domaine   0.5000000 0.3333333   4.571429  5.750000 2.600000\n                   Typicite.olf.chenin Int.attaque   Sucree Acide Amere\nS Michaud                     2.333333    6.000000 3.500000 5.875 4.125\nS Renaudie                    1.125000    6.428571 3.285714 6.750 3.750\nS Trotignon                   0.625000    6.571429 3.000000 6.125 4.125\nS Buisse Domaine              2.571429    5.142857 3.875000 5.625 2.500\n                   Astringence Fraicheur Oxydation  Finesse\nS Michaud             1.428571     6.625 0.4285714 5.285714\nS Renaudie            2.333333     6.625 0.2857143 5.142857\nS Trotignon           2.375000     6.875 0.4285714 5.285714\nS Buisse Domaine      3.000000     6.250 0.4285714 4.571429\n                   Persistance.gustative Persistance.aromatique Int.couleur\nS Michaud                       7.142857               6.714286       5.000\nS Renaudie                      7.166667               6.571429       3.375\nS Trotignon                     6.142857               6.142857       3.000\nS Buisse Domaine                4.857143               5.142857       4.125\n                   Nuance.couleur Impression.surface O.Av.Intensite_E\nS Michaud                3.857143                2.5         5.361111\nS Renaudie               3.285714                2.6         5.138889\nS Trotignon              2.428571                2.8         5.277778\nS Buisse Domaine         4.285714                3.5         4.444444\n                   O.Ap.Intensite_E O.Alcool_E O.Vegetale_E O.Champignon_E\nS Michaud                  6.384507   4.121799     3.119488       2.722222\nS Renaudie                 5.966049   4.002137     2.916667       2.416667\nS Trotignon                5.972222   3.805556     3.000000       2.916667\nS Buisse Domaine           5.333333   4.333333     3.305556       2.361111\n                   O.Fruitpassion_E O.Typicite_E G.Intensite_E Sucree_E\nS Michaud                  4.916667     5.861111      5.444444 4.861111\nS Renaudie                 6.027778     5.638889      5.444444 4.666667\nS Trotignon                6.111111     5.055556      5.094377 5.055556\nS Buisse Domaine           5.083333     5.916667      4.722222 4.916667\n                    Acide_E  Amere_E Astringent_E G.Alcool_E Equilibre_E\nS Michaud          5.194444 4.027778     3.694444   5.250000    5.194444\nS Renaudie         5.277778 3.527778     3.527778   4.916667    4.750000\nS Trotignon        4.916667 3.583333     3.708656   4.805556    5.222222\nS Buisse Domaine   4.750000 3.750000     3.388889   4.972222    4.750000\n                   G.Typicite_E O.Av.Intensite_C O.Ap.Intensite_C O.Alcool_C\nS Michaud              5.416667         4.045455         5.200166   4.087040\nS Renaudie             5.500000         5.318182         6.000000   3.492589\nS Trotignon            5.361111         5.590909         6.090909   3.681818\nS Buisse Domaine       5.342321         4.136364         5.000000   4.227273\n                   O.Vegetale_C O.Champignon_C O.Fruitpassion_C O.Typicite_C\nS Michaud              4.636364       4.490000         5.090909     4.488404\nS Renaudie             4.454545       3.909091         6.454545     4.636364\nS Trotignon            4.590909       2.272727         6.954545     4.889068\nS Buisse Domaine       4.454545       3.636364         4.272727     4.727273\n                   G.Intensite_C Sucree_C  Acide_C  Amere_C Astringent_C\nS Michaud               4.500000 4.772727 4.409091 5.136364     4.272727\nS Renaudie              5.181818 5.363636 5.409091 4.318182     4.545455\nS Trotignon             5.045455 4.863636 5.090909 4.727273     5.727273\nS Buisse Domaine        4.318182 5.363636 4.909091 4.545455     4.636364\n                   G.Alcool_C Equilibre_C G.Typicite_C Juge1 Juge2 Juge3 Juge4\nS Michaud            5.090909    5.189683     5.000000     7   5.5   2.5     1\nS Renaudie           5.045455    5.090909     4.636364     6   5.5   2.5     2\nS Trotignon          4.603636    5.090909     4.772727     3   4.0   3.0     3\nS Buisse Domaine     4.909091    4.181818     4.272727     6   4.0   2.0     1\n                   Juge5 Juge6 Juge7 Juge8 Juge9 Juge10 Juge11 Juge12 Juge13\nS Michaud            5.0   3.5   4.5     1     1      1    2.5      5      1\nS Renaudie           3.5   1.0   3.5     2     8      1    2.5      5      1\nS Trotignon          4.5   2.0   4.0     2     6      4    2.0      8      1\nS Buisse Domaine     3.0   3.0   3.5     4     7      2    2.0      4      1\n                   Juge14 Juge15 Juge16 Juge17 Juge18 Juge19 Juge20 Juge21\nS Michaud               4    3.0      1    2.0    6.0    5.5    3.5      1\nS Renaudie              5    4.0      1    1.5    4.0    4.5    2.5      2\nS Trotignon             5    4.5      6    3.0    7.5    5.5    3.5      2\nS Buisse Domaine        6    3.0      3    4.0    3.0    2.5    2.5      6\n                   Juge22 Juge23 Juge24 Juge25 Juge26 Juge27 Juge28 Juge29\nS Michaud             2.5      5    4.5      4    3.0    1.5    2.0    1.5\nS Renaudie            3.5      2    1.0      4    3.0    2.5    2.5    1.5\nS Trotignon           2.5      4    3.0      5    4.5    3.5    2.5    1.5\nS Buisse Domaine      1.5      1    3.0      4    3.5    3.0    2.0    2.0\n                   Juge30 Juge31 Juge32 Juge33 Juge34 Juge35 Juge36 Juge37\nS Michaud             3.5    2.0    4.5    6.5    2.5      3    3.5      2\nS Renaudie            5.0    2.0    2.0    6.0    2.5      8    1.5      2\nS Trotignon           5.0    2.5    5.5    6.0    4.0      6    4.0      5\nS Buisse Domaine      4.5    3.0    5.0    7.0    4.5      3    4.0      4\n                   Juge38 Juge39 Juge40 Juge41 Juge42 Juge43 Juge44 Juge45\nS Michaud             7.0    2.5    3.5    5.5      4      6    3.5      1\nS Renaudie            5.5    2.5    2.0    4.0      3      3    5.0      2\nS Trotignon           4.5    4.0    8.5    5.0      3      7    4.0      1\nS Buisse Domaine      3.5    3.0    5.5    5.5      3      8    2.5      4\n                   Juge46 Juge47 Juge48 Juge49 Juge50 Juge51 Juge52 Juge53\nS Michaud               4    4.5    3.5    5.0      6    3.5    4.5    2.5\nS Renaudie              4    2.0    3.0    4.5      6    2.5    3.5    1.0\nS Trotignon             4    3.5    3.5    5.5      5    3.0    4.0    3.0\nS Buisse Domaine        1    5.0    3.0    8.0      5    2.0    3.0    3.0\n                   Juge54 Juge55 Juge56 Juge57 Juge58 Juge59 Juge60\nS Michaud             6.5    1.0      6    2.0      8    4.5      5\nS Renaudie            6.5    1.0      2    4.0      1    2.0      1\nS Trotignon           7.5    1.5      3    1.0      1    1.0      2\nS Buisse Domaine      4.0    2.5      3    1.5      6    5.0      3\n\n\n\n10 vins blancs du Val de Loire : 5 Vouvray - 5 Sauvignon\n\ndescripteurs sensoriels : acidité, amertume, odeur agrume, etc.\ndescription sensorielle de 3 jurys : oenologue, consommateurs, étudiant\nnotes hédoniques de 60 consommateurs : [appréciation globale]{. vert}\n\nAu total 118 variables, dont 60 sont des notes hédoniques\n\nOn souhaite étudier les relations entre les différentes varaibles mais aussi entre les groupes de variables\nIl est important d’équilibrer le poids de chaque ensemble de variables"
  },
  {
    "objectID": "01_afm.html#formalisation-du-problème",
    "href": "01_afm.html#formalisation-du-problème",
    "title": "Analyse Factorielle Multiple",
    "section": "Formalisation du problème",
    "text": "Formalisation du problème\n\n\n\\[\\begin{align}\nX & = \\begin{pmatrix}\n\\class{bleu}{X^{1}_1} & \\class{bleu}{X^{2}_1}  &  \\class{bleu}{X^{3}_1} & \\class{orange}{X^{4}_1}& \\class{orange}{X^{5}_1} & \\class{vert}{X^{6}_1}& \\class{vert}{X^{7}_1} \\\\\n\\class{bleu}{\\vdots} & \\class{bleu}{\\vdots}  &  \\class{bleu}{\\vdots} & \\class{orange}{\\vdots}& \\class{orange}{\\vdots} & \\class{vert}{\\vdots}& \\class{vert}{\\vdots} \\\\\n\\class{bleu}{X^{1}_n} & \\class{bleu}{X^{2}_n}  &  \\class{bleu}{X^{3}_n} & \\class{orange}{X^{4}_n}& \\class{orange}{X^{5}_n} & \\class{vert}{X^{6}_n}& \\class{vert}{X^{7}_n} \\\\\n\\end{pmatrix}\\\\\n& = \\begin{pmatrix}\n\\class{bleu}{\\boldsymbol{X^{1}}} &  \\class{orange}{\\boldsymbol{X^{2}}}  & \\class{vert}{\\boldsymbol{X^{3}}} \\\\\n\\end{pmatrix}\n\\end{align}\\]\nOn souhaite mettre en évidence\n\nLes relations entre les groupes de variables\nEquilibrer les contribution de chaque groupe de variables\n\n\nPremière idée\n\nRééquilibrer les variables entre groupes en attribuant à chaque variable \\(k\\) du groupe \\(i\\) un poids \\(1/n_k\\), où \\(n_k\\) est le nombre de variables dans le groupe \\(k\\)."
  },
  {
    "objectID": "01_afm.html#illustration",
    "href": "01_afm.html#illustration",
    "title": "Analyse Factorielle Multiple",
    "section": "Illustration",
    "text": "Illustration\n\nLe DoubsPremière idée\n\n\n\n\n\n\n\n\n\nACP normée\n\n\n\n\n\n\n\n\n\nACP sur les données réduites en prenant un poids \\(1/n_k\\) pour les variables du groupe \\(k\\)\n\n\n\n\n\nPoids des groupes de variables (variance préservée )\n\n\n  Methode Physique Chimique Ecologique\n1     ACP      9.4      9.3        7.3\n2     ACP      4.8      5.6        2.1\n3     ACP      1.9      4.6         NA\n4     n_k      4.7      4.1        5.2\n5     n_k      2.4      2.5        1.5\n6     n_k      0.9      2.1         NA\n\n\nContribution des variables aux différents axes\n\n\n      Dim.1_acp  Dim.2_acp  Dim.1_nk   Dim.2_nk\ndas 12.18484089  8.1162594  8.964225 13.0124095\nalt 11.24282498 10.7604372  7.666427 16.4183870\npen  3.43552777  6.8155752  2.520991  6.5171959\ndeb  9.47810542 12.4294474  6.400995 17.5657350\npH   0.04182411  6.0997890  0.102880  2.8386816\ndur  8.37968810  9.7425152  4.794697  9.1768600\npho 11.55522175 10.2926487  8.904811  3.1296232\nnit 13.64945308  0.2871669  8.934501  0.4216564\namm 10.45910917 13.8240211  8.289503  4.8797800\noxy  9.80107556  7.0888953 21.782875  8.4296737\ndbo  9.77232918 14.5432445 21.638094 17.6099978\n\n\n\n\n\n\nRééquilibrer les variables entre groupes en attribuant à chaque variable \\(k\\) du groupe \\(i\\) un poids \\(1/n_k\\), où \\(n_k\\) est le nombre de variables dans le groupe \\(k\\).\n\nProblème\n\nles deux variables écologiques sont presque parfaitement corrélées, l’information qu’elles portent se résume très bien avec un seul axe. Ainsi cet axe porte presque la même information que l’ensemble des variables, elles ont donc beaucoup de poids dans la création des axes finaux.\nLes variables chimiques (pH, dureté, phosphate, nitrite et ammoniaque) sont moins corélées, l’information qu’elles portent se diffusent sur plusieurs axes et donc le poids de ces variables est réparti sur plusieurs axes.\n\nLa première idée n’est pas toujours la bonne !\nOn souhaiterait que l’axe résume aussi bien les différents types de variable, et donc que chaque groupe de variable ait un poids 1 pour le premier axe."
  },
  {
    "objectID": "01_afm.html#lafm-en-pratique",
    "href": "01_afm.html#lafm-en-pratique",
    "title": "Analyse Factorielle Multiple",
    "section": "L’AFM en pratique",
    "text": "L’AFM en pratique\nPour chaque groupe de variable \\(k\\),\n\nOn calcule la 1ère valeur propre \\(\\lambda_{k1}\\) du groupe de variable \\(k\\), (chaque variable ayant été normée)\nOn réalise l’ACP globale sur le tableau pondéré :\n\n\\[\\begin{align}\nX & = \\begin{pmatrix}\n\\class{bleu}{\\frac{X^{1}_1}{\\sqrt{\\lambda_{11}}}} & \\class{bleu}{\\frac{X^{2}_1}{\\sqrt{\\lambda_{11}}}}  &  \\class{bleu}{\\frac{X^{3}_1}{\\sqrt{\\lambda_{11}}}} & \\class{orange}{\\frac{X^{4}_1}{\\sqrt{\\lambda_{21}}}} & \\class{orange}{\\frac{X^{5}_1}{\\sqrt{\\lambda_{21}}}} & \\class{vert}{\\frac{X^{6}_1}{\\sqrt{\\lambda_{31}}}}& \\class{vert}{\\frac{X^{7}_1}{\\sqrt{\\lambda_{31}}}} \\\\\n\\class{bleu}{\\vdots} & \\class{bleu}{\\vdots}  &  \\class{bleu}{\\vdots} & \\class{orange}{\\vdots}& \\class{orange}{\\vdots} & \\class{vert}{\\vdots}& \\class{vert}{\\vdots} \\\\\n\\class{bleu}{\\frac{X^{1}_n}{\\sqrt{\\lambda_{11}}}} & \\class{bleu}{\\sqrt{\\frac{X^{2}_n}{\\lambda_{11}}}}  &  \\class{bleu}{\\frac{X^{3}_n}{\\lambda_{11}}} & \\class{orange}{\\frac{X^{4}_n}{\\lambda_{21}}} & \\class{orange}{\\frac{X^{5}_n}{\\sqrt{\\lambda_{21}}}} & \\class{vert}{\\sqrt{\\frac{X^{6}_n}{\\lambda_{31}}}}& \\class{vert}{\\frac{X^{7}_n}{\\lambda_{31}}} \\\\\n\\end{pmatrix}\\\\\n& = \\begin{pmatrix}\n\\class{bleu}{\\frac{\\boldsymbol{X^{1}}}{\\sqrt{\\lambda_{11}}}} &  \\class{orange}{\\frac{\\boldsymbol{X^{2}}}{\\sqrt{\\lambda_{21}}}}  & \\class{vert}{\\frac{\\boldsymbol{X^{3}}}{\\sqrt{\\lambda_{31}}}} \\\\\n\\end{pmatrix}\\\\\n\\end{align}\\]\nOn a ainsi la pondération\n\n\n  Methode Physique Chimique Ecologique\n1     ACP      9.4      9.3        7.3\n2     ACP      4.8      5.6        2.1\n3     ACP      1.9      4.6         NA\n4     n_k      4.7      4.1        5.2\n5     n_k      2.4      2.5        1.5\n6     n_k      0.9      2.1         NA\n7     AFM      1.0      1.0        1.0\n8     AFM      0.5      0.6        0.3\n9     AFM      0.2      0.5         NA"
  },
  {
    "objectID": "01_afm.html#lafm-une-acp-particulière",
    "href": "01_afm.html#lafm-une-acp-particulière",
    "title": "Analyse Factorielle Multiple",
    "section": "L’AFM : une ACP Particulière",
    "text": "L’AFM : une ACP Particulière\nFinalement dans une AFM, on étudie\n\nle nuage de points \\(\\boldsymbol{X}\\),\nLes points sont potentiellement pondérés avec la matrice de poids \\(W \\in {\\mathbb{R}}^{n\\times n}\\),\non utilise la mérique \\[M = Diag\\left (\\frac{1}{s_1^2 \\lambda_{c_1}},\\ldots ,\\frac{1}{s_p^2 \\lambda_{c_p}} \\right)\\]\n\noù Diag désigne la matrice diagonale, le terme \\(i\\) est donné par \\(\\frac{1}{s_i^2 \\lambda_{c_i},}\\) \\(s_i\\) est l’écart type de la variable \\(i\\) et \\(\\lambda_{c_i}\\) est la première valeur propre de la classe à laquelle appartient la variable \\(i\\).\nOn a notre tryptique \\[(X, W, M)\\]"
  },
  {
    "objectID": "01_afm.html#en-pratique",
    "href": "01_afm.html#en-pratique",
    "title": "Analyse Factorielle Multiple",
    "section": "En pratique",
    "text": "En pratique\n\n\ndoubs_mfa &lt;- MFA(doubs.env, \n    group = c(4, 5, 2), # un vecteur qui spécifie le nombre de variable dans chaque groupe. Les variables doivent être organisées comme il faut\n    type = rep(\"s\", 3), # pour indiquer que ce sont de svariables quanti que l'on souhaite normaliser et ce pour chaque groupe\n    ncp=11, # on garde tous les axes\n    name.group=c(\"Physique\",\"Chimique\",\"Ecologique\"), graph = TRUE)\n#summary(doubs_mfa)\n# library(Factoshiny)\n# MFAshiny(doubs_mfa)"
  },
  {
    "objectID": "01_afm.html#ce-que-vous-pensez-devoir-retenir",
    "href": "01_afm.html#ce-que-vous-pensez-devoir-retenir",
    "title": "Analyse Factorielle Multiple",
    "section": "Ce que vous pensez devoir retenir",
    "text": "Ce que vous pensez devoir retenir\nOn choisit de faire une AFM si on veut mettre l’accent sur les liens entre les groupes de variables\n\nPour ce faire, on veut que chaque groupe contribue de la même manière à construire des premmiers axes principaux\nPour normaliser l’importance de chaque groupe, on calcule la première valeur propre de chaque groupe et on normalise les données par la racine de cette vp, ou de manière équivalente on prend une métrique $M£ dans maquelle le terme \\(M_{ii}\\) contient la première valeur propre du groupe de variables auquel appartient \\(i\\).\n\nLa méthode est proche de l’ACP, c’est une ACP avec une métrique particulière.\nOn va inetrpéter les relations entre les groupes de variables."
  },
  {
    "objectID": "01_afc.html#les-manchots-comme-exemple-introductif",
    "href": "01_afc.html#les-manchots-comme-exemple-introductif",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Les manchots comme exemple introductif",
    "text": "Les manchots comme exemple introductif\nL’étude sur les manchots de Palmer s’intéresse à diverses espèces de manchots sur diverses îles.\nQuestion : est ce que les différentes espèces sont présentes de la même naière sur les difféérentes îles ?\n\n\nislandAdelieChinstrapGentooBiscoe440119Dream55680Torgersen4700\n\n\nAvec peu d’espèces, et peu d’îles, il est facile de constater que les espèces ne sont pas présentes de la même manière sur toutes les îles.\nConclusion : Il y a un lien entre espèce et île où le manchot est observé."
  },
  {
    "objectID": "01_afc.html#exemple-causes-de-décès-en-france",
    "href": "01_afc.html#exemple-causes-de-décès-en-france",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Exemple causes de décès en France",
    "text": "Exemple causes de décès en France\nLe fichier des décès en France contient pour 65 causes de décès le nombre cumulés de morts en 1979 et 2006 par tranche d’age, puis dans Les 65 lignes suivantes uniquement ce cumul pour 1979, puis pour 2006 et enfin pour chaque année le nombre de décès par tranche d’ages, toutes causes confondues.\n\n\nCauseX0.1X1.4X5.14X15.24X25.34X35.44X45.54X55.64X65.74X75.84X85.94X95.et.plusAbus alcool et psychose alcoolique000292147631,8391,5431,203636955Accidents de transport521946554,6532,4511,8411,9271,4091,4791,21127212Arthrite rhumatoïde et ostéoarthrite003266265930152630157Asthme96929395918326653584646467Autres accidents6464275351,6851,4311,4642,2532,2193,1535,1104,7341,304Autres cardiopathies10462771863597922,3354,29613,37034,83433,6717,454\n\n\nObjectif : Etude de la liaison entre age et cause de décès.\nLes tranches d’âge sont définies a priori pour représenter des causes de décès similaires,"
  },
  {
    "objectID": "01_afc.html#cadre-général",
    "href": "01_afc.html#cadre-général",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Cadre général",
    "text": "Cadre général\nL’analyse factorielle des correspondances (AFC) est une méthode factorielle pour l’exploration statistique d’une table de contingence définie par deux variables qualitatives.\nObjectif : Le but est d’étudier la liaison entre ces deux variables qualitatives(notamment quelles associations de modalités sont sur-représentées).\n\n\n\n\n\n\nNote\n\n\nLa terminologie analyse des correspondances vient du fait que l’on analyse un tableau mettant en correspondance deux ensembles, * L’ensemble des lignes du tableau * L’ensemble des colonnes du tableau"
  },
  {
    "objectID": "01_afc.html#les-données",
    "href": "01_afc.html#les-données",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Les données",
    "text": "Les données\n\nLes données brutesLe tableau disjonctif completLa table de contingence\n\n\nOn considère deux variables qualitatives \\(A\\) et \\(B\\) ayant respectivement \\(I\\) ( \\(a_1, \\ldots, a_I\\)) et \\(J\\) ( \\(b_1, \\ldots, b_J\\)) modalités. Ces variables sont observées simultanément sur \\(n\\) individus affectés de poids identiques \\(1/n\\).\n\n\nLes données se présentent initialement sous la forme d’un tableau à \\(n\\) lignes et 2 (ou 3 colonnes si on ajoute un identifiant).\n\nExemple de table de données\n\n\n\nID\nA\nB\n\n\n\n\n001\n\\(a_1\\)\n\\(b_2\\)\n\n\n002\n\\(a_1\\)\n\\(b_2\\)\n\n\n003\n\\(a_2\\)\n\\(b_2\\)\n\n\n004\n\\(a_2\\)\n\\(b_1\\)\n\n\n005\n\\(a_1\\)\n\\(b_1\\)\n\n\n005\n\\(a_1\\)\n\\(b_3\\)\n\n\n\n\n\n\n\n\nIl est fréquent de recoder (ou même de récolter) les variables sous la forme d’un tableau disjoinctif complet. A chaque variable \\(\\ell\\), on associe une table \\(X^{\\ell},\\) à \\(n\\) et autant de colonnes que la variable \\(\\ell\\), qui contient pour chaque individu \\(k,\\) à la colonne \\(m\\) un \\(1\\) si l’individu \\(k\\) possède la modalité \\(m\\) et un \\(0\\) sinon.\n\nSur l’exemple précédent\n\\[\\bf{X} =\\begin{pmatrix} \\class{orange}{X^{1}} & \\class{rouge}{X^{2}} \\end{pmatrix}\\] \\[\\bf{X} = \\overset{{\\begin{matrix} \\class{orange}{a_1} & \\class{orange}{a_2} & \\class{rouge}{b_1} & \\class{rouge}{b_2} & \\class{rouge}{b_3}\\end{matrix}}}{\n\\begin{pmatrix}\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0}\\\\\n\\class{orange}{0} & \\class{orange}{1} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0}\\\\\n\\class{orange}{0} & \\class{orange}{1} &  \\class{rouge}{1} & \\class{rouge}{0} & \\class{rouge}{0}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{1} & \\class{rouge}{0} & \\class{rouge}{0}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{0} & \\class{rouge}{1}\\\\\n\\end{pmatrix}}\\]\n\n\n\n\n\nIl s’agit de la matrice \\(K\\) à \\(I\\) lignes et \\(J\\) colonnes, dont le terme général \\(k_{ij}\\) compte le nombre d’individus possédant simultanément les carcatéristiques \\(a_i\\) et \\(b_j\\).\n\\[\\class{vert}{K}=\\begin{bmatrix}\n\\class{vert}{k_{ij}}\n\\end{bmatrix}_{\\begin{array}{r}\ni=1,\\ldots,I\\\\\nj=1,\\ldots,J\n\\end{array}}.\\]\n\n\n\nRemarque 1\n\n\n\\[\\class{vert}{K} = (\\class{orange}{X^1})^\\top  \\class{rouge}{X^2}\\]\n\n\n\n\n\n\nRemarque 2\n\n\n\\[{\\boldsymbol{X}}^\\top {\\boldsymbol{X}}= \\begin{pmatrix} \\class{orange}{C_1} & \\class{vert}{K} \\\\ \\class{vert}{K^\\top} & \\class{rouge}{C_2}\\end{pmatrix},\\] \\(C_{\\ell}\\) une matrice diagonale, dont la diagonale est le nombre d’observations dans chaque modalité.\n\n\n\n\nSur l’exemple précédent\n\\[\\class{vert}{K}  = \\begin{pmatrix}\n\\class{vert}{1} & \\class{vert}{2} &  \\class{vert}{1} \\\\\n\\class{vert}{1} & \\class{vert}{1} & \\class{vert}{0} \\\\\n\\end{pmatrix}\\]\n\\[{\\boldsymbol{X}}^\\top {\\boldsymbol{X}}=\n\\begin{pmatrix}\n\\class{orange}{4} & 0 & \\class{vert}{1} & \\class{vert}{2} & \\class{vert}{1} \\\\\n0 & \\class{orange}{2} & \\class{vert}{1} & \\class{vert}{1} & \\class{vert}{0} \\\\\n\\class{vert}{1} & \\class{vert}{1} & \\class{rouge}{2} & 0 & 0 \\\\\n\\class{vert}{2} & \\class{vert}{1} & 0 & \\class{rouge}{3} & 0 \\\\\n\\class{vert}{1} & \\class{vert}{0} & 0 & 0 & \\class{rouge}{1} \\\\\n\\end{pmatrix}\\]"
  },
  {
    "objectID": "01_afc.html#quelques-notations",
    "href": "01_afc.html#quelques-notations",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Quelques notations",
    "text": "Quelques notations\n\n\nFormellement\nOn note les effectifs\n\n\\(k_{\\class{orange}{i+}} = \\sum_{\\class{rouge}{j=1}}^{\\class{rouge}{J}} k_{ij}\\) le nombre total d’individus ayant la modalité \\(\\class{orange}{i}\\)\n\\(k_{\\class{rouge}{+j}} =  \\sum_{\\class{orange}{i=1}}^{\\class{orange}{I}}  k_{ij}\\) le nombre total d’individus ayant la modalité \\(\\class{rouge}{j}\\)\n\\(n = \\sum_{\\class{orange}{i=1}}^{\\class{orange}{I}}\\sum_{\\class{rouge}{j=1}}^{\\class{rouge}{J}}  k_{ij}\\)\n\nles proportions\n\n\\(f_{ij} = k_{ij}/n,\\)\n\nEt les proportions marginales\n\n\\(f_{\\class{orange}{i+}} = \\sum_{\\class{rouge}{j=1}}^{\\class{rouge}{J}} f_{ij}\\) la proportion d’individus ayant la modalité \\(\\class{orange}{i}\\)\n\\(f_{\\class{rouge}{+j}} =  \\sum_{\\class{orange}{i=1}}^{\\class{orange}{I}}  f_{ij}\\) la proportion d’individus ayant la modalité \\(\\class{rouge}{j}\\)\n\\(f_{++}= 1\\)\n\n\nSur l’exemple\n\\[\\class{vert}{K}  = \\begin{array}{ccc||c}\n&& & Eff. marg\\\\\n\\class{vert}{1=k_{11}} & \\class{vert}{2=k_{12}} &  \\class{vert}{1=k_{13}} & 4 = k_{1+}\\\\\n\\class{vert}{1=k_{21}} & \\class{vert}{1=k_{22}} & \\class{vert}{0=k_{23}} & 2 =  k_{2+}\\\\ \\hline\n2 =  k_{+1} & 3 =  k_{+2} & 1 =  k_{+3} & 6 = n\\\\\n\\end{array}\\]"
  },
  {
    "objectID": "01_afc.html#modèle-dindépendance",
    "href": "01_afc.html#modèle-dindépendance",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Modèle d’indépendance",
    "text": "Modèle d’indépendance\nOn dit que deux variables \\(A\\) et \\(B\\) sont non liées si et seulement si \\[\\forall (i,j)\\in\\{1,\\ldots,I\\}\\times\\{1,\\ldots,J\\}: \\; k_{ij}=\\frac{k_{i +} k_{+ j}}{n}\\]\nCette notion est bien sûr liée à l’indépendance en probabilité. En effet, deux variables aléatoires \\(A\\) et \\(B\\) sont indépendantes ssi\n\\[\\begin{align*} \\underbrace{\\mathbb{P}(A=i  \\cap B=j)}_{\\text{estimée par } \\frac{k_{ij}}{n}= f_{ij}} = \\underbrace{\\mathbb{P}(A=i)}_{\\text{estimée par} \\frac{k_{i +}}{n} = f_{i +}} \\times \\underbrace{\\mathbb{P}(B=j)}_{\\text{estimée par} \\frac{k_{+ j}}{n}=f_{+j}}, \\forall (i,j)\\;\n\\end{align*}\\]\nOn souhaite étudier la liaison entre \\(A\\) et \\(B\\) à partir de nos observations.\nLa représentation graphique des profils-lignes ou des profils-colonnes, au moyen de diagrammes en barres parallèles, ainsi que le calcul de coefficients de liaison (Cramer) donnent une première idée de la variation conjointe des deux variables.\nLe test du \\(\\chi^2\\) permet de plus de s’assurer du caractère significatif de cette liaison."
  },
  {
    "objectID": "01_afc.html#test-dindépendance-du-chi2",
    "href": "01_afc.html#test-dindépendance-du-chi2",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Test d’indépendance du \\(\\chi^2\\)",
    "text": "Test d’indépendance du \\(\\chi^2\\)\n(cf cours sur les tests du 2d semestre)\n\nl’hypothèse nulle est \\(H_0\\): \\(A\\) et \\(B\\) sont indépendantes,\nl’hypothèse alternative est \\(H_1\\): \\(A\\) et \\(B\\) ne sont pas indépendantes.\n\nLa statistique de test est \\[T = \\sum_{i=1}^{I} \\sum_{j=1}^{J}  \\frac{\\left(\\text{Effectif observé}_{ij} - \\text{Effectif ettendu}_{ij} \\right)^2}{\\text{Effectif attendu}_{ij} } =  \\sum_{i=1}^{I} \\sum_{j=1}^{J} \\frac{( n f_{ij} - n f_{i+ } f_{ +j})^2}{n f_{i+} f_{+j}}= n \\class{bleu}{\\sum_{i=1}^{I} \\sum_{j=1}^{J} \\frac{(  f_{ij} -  f_{i+ } f_{ +j})^2}{f_{i+} f_{+j}}} = n \\class{bleu}{\\Phi^2} .\\]\nPour des grandes valeurs de \\(n\\), et si \\(H_0\\) est vraie, \\[T \\sim \\chi^2_{(I-1)(J-1)}.\\]\nSi \\(T\\) est grand, on rejette \\(H_0\\).\nLa force de la dépendance est capturée par \\(\\class{bleu}{\\Phi^2}\\)"
  },
  {
    "objectID": "01_afc.html#probabilité-conditionnelle",
    "href": "01_afc.html#probabilité-conditionnelle",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Probabilité conditionnelle",
    "text": "Probabilité conditionnelle\nRappel\n\\[P(A=i\\vert B= j) = \\frac{P(A=i,  B= j)}{P(B= j)}\\]\nDéclinaison sur les fréquences\n\n\\(\\frac{f_{ij}}{f_{i+}}\\) est la fréquence d’apparition de la modalité \\(j\\) sachant qu’on s”intéresse à la population \\(A=i\\). Si \\(A\\) et \\(B\\) sont indépendantes, alors \\(\\frac{f_{ij}}{f_{i+}}= f_{+j}\\)\n\\(\\frac{f_{ij}}{f_{+j}}\\) est la fréquence d’apparition de la modalité \\(i\\) sachant qu’on s”intéresse à la population \\(B=j\\). Si \\(A\\) et \\(B\\) sont indépendantes, alors \\(\\frac{f_{ij}}{f_{+j}}= f_{i+}\\)"
  },
  {
    "objectID": "01_afc.html#profils-lignes-n_i",
    "href": "01_afc.html#profils-lignes-n_i",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Profils-lignes \\(N_I\\)",
    "text": "Profils-lignes \\(N_I\\)\nLe tableau des profils-lignes \\(X\\) est le tableau des fréquences conditionnelles de la modalité \\(j\\) de \\(B\\) sachant la modalité \\(i\\) de \\(A\\):\n\nLes pointsLes poidsLa métrique\n\n\n\\[X=\\begin{pmatrix}\n\\frac{f_{ij}}{f_{i+}}\n\\end{pmatrix}_{\\begin{array}{r}\ni=1,\\ldots,I\\\\\nj=1,\\ldots,J\n\\end{array}}\\]\nAinsi avec les notations du cours d’ACP \\[\nX = \\begin{pmatrix}\nx_1^\\top\\\\\n\\vdots\\\\\nx_i^\\top\\\\\n\\vdots\\\\\nx_I^\\top\\\\\n\\end{pmatrix}\n\\text{ avec }\nx_i = \\begin{pmatrix}\nf_{i1}/f_{i+}\\\\\n\\vdots\\\\\nf_{ij}/f_{i+}\\\\\n\\vdots\\\\\nf_{iJ}/f_{i+}\\\\\n\\end{pmatrix}\\in\\mathbb{R}^J.\\]\n\n\n\nA chaque ligne \\(i\\), on fait correspondre un point dans \\({\\mathbb{R}}^J\\) dont la j\\(^\\text{ème}\\) coordonnée vaut \\(f_{ij}/f_{i+}\\).\n\n\n\n\n\nChaque point \\(i\\) est affecté du poids \\(f_{i+}.\\)\nLe point moyen \\(G_I\\) est défini par\n\\[G_I = \\sum_{i=1}^I f_{i+} x_i = (f_{+1}, \\ldots, f_{+J})\\] On a le nuage de points \\(X\\), complété par les poids \\(f_{i+}.\\)\n\n\nLa distance dont on munit l’espace \\({\\mathbb{R}}^J\\) consiste à donner un poids \\(1/f_{+j}\\) à la j\\(^\\text{ème}\\) dimension, la distance au carré (dite distance du \\(\\chi^2\\)) entre les points \\(i_1\\) et \\(i_2\\) est définie par\n\\[ d_{\\chi^2}^2(x_{i_1}, x_{i_2}) = \\sum_{j=1}^J \\frac{1}{f_{+j}}\\left (\\frac{f_{i_1j}}{f_{i_1+}} -\\frac{f_{i_2j}}{f_{i_2+}} \\right)^2\\]\nCe choix est motivé par l’inertie du point \\(x_i\\) par rapport au centre de garivité \\(G_I\\), en effet\n\\[Inertie_{G_I}(x_i) = f_{i+} d_{\\chi^2}^2(x_{i}, G_I) =  f_{i+}  \\sum_{j=1}^J \\frac{1}{f_{+j}}\\left (\\frac{f_{ij}}{f_{i+}} -f_{+j} \\right)^2=  \\sum_{j=1}^J \\frac{\\left ( f_{ij} - f_{i+}f_{+j} \\right)^2 }{f_{i+} f_{+j}}.\\]\nAinsi l’inertie totale du nuage par rapport à \\(G_I\\) vaut\n\\[I_{G_I} = \\sum_{i=1}^I  \\sum_{j=1}^J \\frac{\\left ( f_{ij} - f_{i+}f_{+j} \\right)^2 }{f_{i+} f_{+j}} = \\Phi^2\\] L’inertie mesure l’écart à l’indépendance. L’étude du nuage \\(N_I\\) rend compte de la structure des données."
  },
  {
    "objectID": "01_afc.html#profils-colonnes",
    "href": "01_afc.html#profils-colonnes",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Profils-colonnes",
    "text": "Profils-colonnes\nDans le tableau de contingence, lignes et colonnes jouent des rôles symétriques\nLe tableau des profils-colonnes \\(X\\) est le tableau des fréquences conditionnelles de la modalité \\(i\\) de \\(A\\) sachant la modalité \\(j\\) de \\(B\\):\n\nLes pointsLes poidsLa métrique\n\n\n\\[X=\\begin{pmatrix}\n\\frac{f_{ij}}{f_{+j}}\n\\end{pmatrix}_{\\begin{array}{r}\ni=1,\\ldots,I\\\\\nj=1,\\ldots,J\n\\end{array}}\\]\nAinsi avec les notations du cours d’ACP \\[\nX = \\begin{pmatrix}\nx^1  & \\ldots & x^j & \\ldots & x^J\n\\end{pmatrix}\n\\text{ avec }\nx^j = \\begin{pmatrix}\nf_{1j}/f_{+j}\\\\\n\\vdots\\\\\nf_{ij}/f_{+j}\\\\\n\\vdots\\\\\nf_{Ij}/f_{+j}\\\\\n\\end{pmatrix}\\in\\mathbb{R}^I.\\]\n\n\n\nA chaque colonne \\(j\\), on fait correspondre un point dans \\({\\mathbb{R}}^I\\) dont la i\\(^\\text{ème}\\) coordonnée vaut \\(f_{ij}/f_{+j}\\).\n\n\n\n\n\nChaque point \\(j\\) est affecté du poids \\(f_{+j}.\\)\nLe point moyen \\(G_J\\) est défini par\n\\[G_J = \\sum_{j=1}^J f_{+j}\\, x^j = (f_{1+}, \\ldots, f_{I+})\\] On a le nuage de points \\(X\\), complété par les poids \\(f_{+j}.\\)\n\n\nLa distance dont on munit l’espace \\({\\mathbb{R}}^I\\) consiste à donner un poids \\(1/f_{i+}\\) à la i\\(^\\text{ème}\\) dimension, la distance au carré (dite distance du \\(\\chi^2\\)) entre les points \\(j_1\\) et \\(j_2\\) est définie par\n\\[I_{G_J}(x^j) = f_{+j} d_{\\chi^2}^2(x^{j}, G_J) =  f_{+j}  \\sum_{i=1}^I \\frac{1}{f_{i+}}\\left (\\frac{f_{ij}}{f_{+j}} -f_{i+} \\right)^2=  \\sum_{i=1}^I \\frac{\\left ( f_{ij} - f_{i+}f_{+j} \\right)^2 }{f_{i+} f_{+j}}.\\]\nAinsi l’inertie totale du nuage par rapport à \\(G_I\\) vaut\n\\[I_{G_J} = \\sum_{i=1}^I  \\sum_{j=1}^J \\frac{\\left ( f_{ij} - f_{i+}f_{+j} \\right)^2 }{f_{i+} f_{+j}} = \\Phi^2\\]\nL’inertie mesure l’écart à l’indépendance. L’étude du nuage \\(N_J\\) rend compte de la structure des données."
  },
  {
    "objectID": "01_afc.html#acp-des-nuages-lignes-et-colonnes",
    "href": "01_afc.html#acp-des-nuages-lignes-et-colonnes",
    "title": "Analyse Factorielle des Correspondances",
    "section": "ACP des nuages lignes et colonnes",
    "text": "ACP des nuages lignes et colonnes\n\nACP de \\(N_I\\)ACP de \\(N_J\\)Nombre d’axes\n\n\nRéalisé une l’ACP profils lignes.\n\nL’origine des axes est placée au centre \\(G_I\\) du nuage \\(N_I\\)\nOn recherche une suite d’axes othogonaux d’inertie maximale\nLe nuage est projeté sur ces axes et on représente ces projections en associant deux axes pour créer un plan.\nla proximité entre deux profils lignes, s’exprime par la même manière de s’écarter de l’indépendance.\n\n\n\nRéalisé une l’ACP profils colonnes\n\nL’origine des axes est placée au centre \\(G_J\\) du nuage \\(N_J\\)\nOn recherche une suite d’axes othogonaux d’inertie maximale\nLe nuage est projeté sur ces axes et on représente ces projections en associant deux axes pour créer un plan.\nla proximité entre deux profiils colonne, s’exprime par la même manière de s’écarter de l’indépendance.\n\n\n\nPuisque le nuage \\(N_I\\) se place dans l’espace \\({\\mathbb{R}}^J\\), on peut penser qu’il faut \\(J\\) axes pour tout représenter. Mais\n\nLa somme des coordonnées d’un profil vaut 1, on est donc dans un espace de dimension \\({\\mathbb{R}}^{J-1}\\)\nLe nuage \\(N_I\\) centré comporte \\(I\\) lignes, il est possible de les représenter tous avec \\(I-1\\) dimensions\n\nOn représente donc toute l’information avec \\(\\min(I-1, J-1)\\) axes."
  },
  {
    "objectID": "01_afc.html#représentation",
    "href": "01_afc.html#représentation",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Représentation",
    "text": "Représentation\n\nReprésentation des profils lignesReprésentation des profils colonnes\n\n\n\n\npenguins.CA &lt;- CA(penguin_cont, graph = FALSE)\nplot(penguins.CA, invisible = \"col\" )\n\n\n\n\n\n\n\n\n\n\n\n\n\nplot(penguins.CA, invisible = \"row\" )"
  },
  {
    "objectID": "01_afc.html#représentation-jointe-lignes-et-colonnes",
    "href": "01_afc.html#représentation-jointe-lignes-et-colonnes",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Représentation jointe lignes et colonnes",
    "text": "Représentation jointe lignes et colonnes\n\nRemarquesVisualisation\n\n\n\nLes deux nuages \\(N_I\\) et \\(N_J\\) ont la même inertie\nL’inertie projetée sur l’axe \\(\\ell\\) est données par l’inertie du nuage projeté sur cet axe.\n\nconcernant les profils lignes \\(\\sum_{i}^I f_{i+} \\lVert OH_i^{\\ell}\\rVert^2 = \\lambda_{\\ell}\\)\nconcernant les profils colonnes \\(\\sum_{j}^J f_{+j} \\lVert OH_j^{\\ell}\\rVert^2 = \\lambda_{\\ell}\\) Ainsi les deux nuages ont la même inertie projetée sur chaque axe.\n\nLien entre coordonnées des lignes et des colonnes : relations pseudo-barycentriques suivantes pour \\(\\ell=1,\\ldots,min(I-1, J-I)\\)\n\n\\[F_{\\ell}(i) =\\frac{1}{\\sqrt{\\lambda_{\\ell}}} \\sum_{j=1}^J \\frac{f_{ij}}{f_{i+}} G_{\\ell(j)},\\] \\[G_{\\ell}(j) =\\frac{1}{\\sqrt{\\lambda_{\\ell}}} \\sum_{i=1}^I \\frac{f_{ij}}{f_{+j}} F_{\\ell(i)},\\]\noù \\(F_{\\ell}(i)\\) désigne la coordonnée de la ligne \\(i\\) sur l’axe \\(\\ell\\), tandis que \\(G_{\\ell}(j)\\) désigne la coordonnée de la colonne \\(j\\) sur l’axe \\(\\ell\\).\n\n\nOn peut donc représenter lignes et colonnes sur la même projection.\n\n\nfviz_ca(penguins.CA)\n\n\n\n\n\n\n\n\npenguin_cont |&gt; rownames_to_column(var = 'island') |&gt; \n  flextable()\n\nislandAdelieChinstrapGentooBiscoe440119Dream55680Torgersen4700"
  },
  {
    "objectID": "01_afc.html#interprétation-jointe-lignes-et-colonnes",
    "href": "01_afc.html#interprétation-jointe-lignes-et-colonnes",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Interprétation jointe lignes et colonnes",
    "text": "Interprétation jointe lignes et colonnes\nPuisque l’origine du repère est confondue avec le barycentre des nuages.\n\nSi un profil ligne a une coordonnée positive sur un axe, il s’associe\n\nplus que dans le modèle d’indépendance aux modalités \\(j\\) ayant une coordonnées positive\nmoins que dans le modèle d’indépendance aux modalités \\(j\\) ayant une coordonnées négative"
  },
  {
    "objectID": "01_afc.html#inerties-associés-aux-axes",
    "href": "01_afc.html#inerties-associés-aux-axes",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Inerties associés aux axes",
    "text": "Inerties associés aux axes\nEn AFC, l’inertie a un sens particulier.\nEn effet, si on considère la projection de \\(N_I\\) sur l’axe \\(\\ell\\).\n\nSi on place chaque profil colonne \\(G_{\\ell}(j)\\) à l’exact barycentre, alors \\(N_J\\) est au centre du nuage \\(N_I\\) et donc \\(N_I\\) ne peut-être un nuage de barycentre de \\(N_J\\).\nC’est la valeur \\(\\lambda_{\\ell}\\) qui dilate les barycentres de \\(1/\\sqrt{\\lambda_{\\ell}}\\) et donc \\(\\lambda_{\\ell}\\leq 1\\).\n\nLa valeur propre \\(1\\) signifie que donc une association parfaite entre ligne et colonnes.\n\n\npenguins.CA$eig[,1]\n\n\n    dim 1     dim 2 \n0.6568035 0.1978211"
  },
  {
    "objectID": "01_afc.html#qualité-de-la-représentation",
    "href": "01_afc.html#qualité-de-la-représentation",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Qualité de la représentation",
    "text": "Qualité de la représentation\n\n\nQualité de la représentation d’un profil ligne \\(i\\)\nLa qualité de la réprésentation de l’individu \\(i\\) sur l’axe \\(\\ell\\) est donné par \\[Qual_{\\ell}(i) = \\frac{\\text{inertie de }i\\text{ projeté sur }\\ell}{\\text{inertie de } i}= \\frac{(OH_i^{\\ell)^2}}{(Oi)^2}\\] \n\nContribution d’un profil \\(i\\) à l’inertie d’un axe\n\\[Cont_{\\ell}(i) = \\frac{\\text{inertie de }i\\text{ projeté sur }\\ell}{\\text{inertie de } N_{I}\\text{ projeté sur }\\ell }= \\frac{f_{i+}(OH_i^{\\ell)^2}}{\\lambda_{\\ell}}\\]"
  },
  {
    "objectID": "01_afc.html#statistiques-descriptives",
    "href": "01_afc.html#statistiques-descriptives",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Statistiques descriptives",
    "text": "Statistiques descriptives\nLe fichier présente pour chaque tranche d’âge\n\n65 lignes présentant le cumul de décès par cause en 1979 et 2006\n65 lignes présentant le cumul de décès par cause en 2006\n64 lignes présentant le cumul de décès par cause en 1979 (le SIDA n’est pas pris en compte)\n28 lignes présentant le cumul de décès toutes causes confondues cause en 1979 à 2006.\n\n\n\ndeces_dta &lt;- read.table(\"http://factominer.free.fr/livreV2/deces.csv\", header = TRUE, sep = \";\",  \n                        check.names = TRUE, fileEncoding = \"latin1\") |&gt; \n  rename(Cause = X) |&gt; \n  column_to_rownames(var = \"Cause\")\ndeces_dta &lt;- deces_dta |&gt; rownames_to_column(\"Cause\") |&gt; \n  mutate(Periode = case_when(\n    str_detect(Cause, pattern = \"^[70][0-9]_\") ~ str_extract(Cause, pattern = \"^[70][0-9]\"),\n    str_detect(Cause, pattern = \"^[12]+\") ~ \"Deces_annuel\",\n    str_detect(Cause, pattern = \"^[0-9]+\", negate = TRUE) ~ \"Deces_1979et2006\",\n    TRUE ~ NA_character_ # valeur par defaut\n  ))\n\ndeces_dta |&gt; \n  group_by(Periode) |&gt; \n  count()\ndim(deces_dta)\n\n# effectifs lignes\ndeces_dta |&gt; \n  filter(Periode == \"Deces_1979et2006\") |&gt; \n  mutate(k_i_plus = rowSums(across(where(is.numeric))) ) |&gt; \n  select(k_i_plus) |&gt; head()\n# effectifs colonnes\ndeces_dta |&gt; \n  filter(Periode == \"Deces_1979et2006\") |&gt; \n  select(-Periode) |&gt; \n  column_to_rownames(\"Cause\") |&gt; \n  summarise_all(sum)\n\n\n# A tibble: 4 × 2\n# Groups:   Periode [4]\n  Periode              n\n  &lt;chr&gt;            &lt;int&gt;\n1 06                  65\n2 79                  64\n3 Deces_1979et2006    65\n4 Deces_annuel        28\n[1] 222  14\n  k_i_plus\n1     6327\n2    16156\n3     1287\n4     2512\n5    24961\n6    97540\n   X0.1 X1.4 X5.14 X15.24 X25.34 X35.44 X45.54 X55.64 X65.74 X75.84 X85.94\n1 10429 2226  3395  12431  14758  26600  69546 105126 200976 337313 231583\n  X95.et.plus\n1       43374"
  },
  {
    "objectID": "01_afc.html#test-dindépendance",
    "href": "01_afc.html#test-dindépendance",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Test d’indépendance",
    "text": "Test d’indépendance\nTest sur toutes les données\n\n\ndeces_dta |&gt; select(-Periode) |&gt; \n  column_to_rownames(\"Cause\") |&gt; chisq.test()\n\n\n\n    Pearson's Chi-squared test\n\ndata:  column_to_rownames(select(deces_dta, -Periode), \"Cause\")\nX-squared = 2695798, df = 2431, p-value &lt; 2.2e-16\n\n\nTest sur les données actives\n\n\ndeces_dta |&gt; \n  filter(Periode == \"Deces_1979et2006\") |&gt; \n  select(-Periode) |&gt; \n  column_to_rownames(\"Cause\") |&gt; chisq.test()\n\n\n\n    Pearson's Chi-squared test\n\ndata:  column_to_rownames(select(filter(deces_dta, Periode == \"Deces_1979et2006\"),     -Periode), \"Cause\")\nX-squared = 1080254, df = 704, p-value &lt; 2.2e-16"
  },
  {
    "objectID": "01_afc.html#analyse-factorielle-des-correspondances-afc",
    "href": "01_afc.html#analyse-factorielle-des-correspondances-afc",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Analyse factorielle des correspondances (AFC)",
    "text": "Analyse factorielle des correspondances (AFC)\nCalcul et résumé de l’AFC\n\n\ndeces_dta &lt;- deces_dta |&gt; \n  column_to_rownames(\"Cause\") |&gt; \n  select(-Periode)\nres.ca &lt;- CA(deces_dta, row.sup = 66:nrow(deces_dta), ncp = 25, \n             graph = FALSE)\nsummary(res.ca, nb.dec = 4)\n\n\n\nCall:\nCA(X = deces_dta, ncp = 25, row.sup = 66:nrow(deces_dta), graph = FALSE) \n\nThe chi square of independence between the two variables is equal to 1080254 (p-value =  0 ).\n\nEigenvalues\n                        Dim.1    Dim.2    Dim.3    Dim.4    Dim.5    Dim.6\nVariance               0.5505   0.2570   0.1385   0.0338   0.0199   0.0143\n% of var.             53.9002  25.1628  13.5653   3.3141   1.9439   1.4022\nCumulative % of var.  53.9002  79.0630  92.6283  95.9424  97.8863  99.2885\n                        Dim.7    Dim.8    Dim.9   Dim.10   Dim.11\nVariance               0.0037   0.0017   0.0013   0.0004   0.0001\n% of var.              0.3665   0.1624   0.1256   0.0439   0.0132\nCumulative % of var.  99.6550  99.8174  99.9430  99.9868 100.0000\n\nRows (the 10 first)\n                                                                       \nAbus alcool et psychose alcoolique                                    |\nAccidents de transport                                                |\nArthrite rhumatoïde et ostéoarthrite                                  |\nAsthme                                                                |\nAutres accidents                                                      |\nAutres cardiopathies                                                  |\nAutres causes externes de blessure et empoisonnement                  |\nAutres maladie appareil circulatoire                                  |\nAutres maladies chroniques voies respiratoires inférieures            |\nAutres maladies appareil digestif                                     |\n                                                                      Iner*1000\nAbus alcool et psychose alcoolique                                      10.5781\nAccidents de transport                                                 139.9313\nArthrite rhumatoïde et ostéoarthrite                                     0.1716\nAsthme                                                                   0.0468\nAutres accidents                                                        17.9324\nAutres cardiopathies                                                    20.1181\nAutres causes externes de blessure et empoisonnement                     0.0647\nAutres maladie appareil circulatoire                                     4.9198\nAutres maladies chroniques voies respiratoires inférieures               1.7971\nAutres maladies appareil digestif                                        1.0660\n                                                                       \nAbus alcool et psychose alcoolique                                    |\nAccidents de transport                                                |\nArthrite rhumatoïde et ostéoarthrite                                  |\nAsthme                                                                |\nAutres accidents                                                      |\nAutres cardiopathies                                                  |\nAutres causes externes de blessure et empoisonnement                  |\nAutres maladie appareil circulatoire                                  |\nAutres maladies chroniques voies respiratoires inférieures            |\nAutres maladies appareil digestif                                     |\n                                                                         Dim.1\nAbus alcool et psychose alcoolique                                     -0.0441\nAccidents de transport                                                  0.2416\nArthrite rhumatoïde et ostéoarthrite                                   -0.1274\nAsthme                                                                 -0.0606\nAutres accidents                                                        0.2720\nAutres cardiopathies                                                   -0.1172\nAutres causes externes de blessure et empoisonnement                   -0.0615\nAutres maladie appareil circulatoire                                   -0.1224\nAutres maladies chroniques voies respiratoires inférieures             -0.1222\nAutres maladies appareil digestif                                      -0.0868\n                                                                           ctr\nAbus alcool et psychose alcoolique                                      0.0021\nAccidents de transport                                                  0.1620\nArthrite rhumatoïde et ostéoarthrite                                    0.0036\nAsthme                                                                  0.0016\nAutres accidents                                                        0.3172\nAutres cardiopathies                                                    0.2301\nAutres causes externes de blessure et empoisonnement                    0.0018\nAutres maladie appareil circulatoire                                    0.1595\nAutres maladies chroniques voies respiratoires inférieures              0.0445\nAutres maladies appareil digestif                                       0.0426\n                                                                          cos2\nAbus alcool et psychose alcoolique                                      0.0011\nAccidents de transport                                                  0.0064\nArthrite rhumatoïde et ostéoarthrite                                    0.1151\nAsthme                                                                  0.1867\nAutres accidents                                                        0.0974\nAutres cardiopathies                                                    0.0630\nAutres causes externes de blessure et empoisonnement                    0.1523\nAutres maladie appareil circulatoire                                    0.1785\nAutres maladies chroniques voies respiratoires inférieures              0.1363\nAutres maladies appareil digestif                                       0.2199\n                                                                       \nAbus alcool et psychose alcoolique                                    |\nAccidents de transport                                                |\nArthrite rhumatoïde et ostéoarthrite                                  |\nAsthme                                                                |\nAutres accidents                                                      |\nAutres cardiopathies                                                  |\nAutres causes externes de blessure et empoisonnement                  |\nAutres maladie appareil circulatoire                                  |\nAutres maladies chroniques voies respiratoires inférieures            |\nAutres maladies appareil digestif                                     |\n                                                                         Dim.2\nAbus alcool et psychose alcoolique                                      0.8558\nAccidents de transport                                                  2.6280\nArthrite rhumatoïde et ostéoarthrite                                   -0.2631\nAsthme                                                                  0.0506\nAutres accidents                                                        0.6706\nAutres cardiopathies                                                   -0.3450\nAutres causes externes de blessure et empoisonnement                    0.0872\nAutres maladie appareil circulatoire                                   -0.2382\nAutres maladies chroniques voies respiratoires inférieures             -0.2587\nAutres maladies appareil digestif                                      -0.1465\n                                                                           ctr\nAbus alcool et psychose alcoolique                                      1.7048\nAccidents de transport                                                 41.0482\nArthrite rhumatoïde et ostéoarthrite                                    0.0328\nAsthme                                                                  0.0024\nAutres accidents                                                        4.1296\nAutres cardiopathies                                                    4.2716\nAutres causes externes de blessure et empoisonnement                    0.0077\nAutres maladie appareil circulatoire                                    1.2937\nAutres maladies chroniques voies respiratoires inférieures              0.4273\nAutres maladies appareil digestif                                       0.2596\n                                                                          cos2\nAbus alcool et psychose alcoolique                                      0.4141\nAccidents de transport                                                  0.7538\nArthrite rhumatoïde et ostéoarthrite                                    0.4910\nAsthme                                                                  0.1299\nAutres accidents                                                        0.5918\nAutres cardiopathies                                                    0.5456\nAutres causes externes de blessure et empoisonnement                    0.3060\nAutres maladie appareil circulatoire                                    0.6758\nAutres maladies chroniques voies respiratoires inférieures              0.6110\nAutres maladies appareil digestif                                       0.6257\n                                                                       \nAbus alcool et psychose alcoolique                                    |\nAccidents de transport                                                |\nArthrite rhumatoïde et ostéoarthrite                                  |\nAsthme                                                                |\nAutres accidents                                                      |\nAutres cardiopathies                                                  |\nAutres causes externes de blessure et empoisonnement                  |\nAutres maladie appareil circulatoire                                  |\nAutres maladies chroniques voies respiratoires inférieures            |\nAutres maladies appareil digestif                                     |\n                                                                         Dim.3\nAbus alcool et psychose alcoolique                                     -0.8057\nAccidents de transport                                                  1.3196\nArthrite rhumatoïde et ostéoarthrite                                    0.0775\nAsthme                                                                 -0.0768\nAutres accidents                                                        0.3978\nAutres cardiopathies                                                    0.2760\nAutres causes externes de blessure et empoisonnement                   -0.0029\nAutres maladie appareil circulatoire                                    0.0971\nAutres maladies chroniques voies respiratoires inférieures              0.0364\nAutres maladies appareil digestif                                       0.0512\n                                                                           ctr\nAbus alcool et psychose alcoolique                                      2.8026\nAccidents de transport                                                 19.1986\nArthrite rhumatoïde et ostéoarthrite                                    0.0053\nAsthme                                                                  0.0101\nAutres accidents                                                        2.6950\nAutres cardiopathies                                                    5.0713\nAutres causes externes de blessure et empoisonnement                    0.0000\nAutres maladie appareil circulatoire                                    0.3989\nAutres maladies chroniques voies respiratoires inférieures              0.0157\nAutres maladies appareil digestif                                       0.0589\n                                                                          cos2\nAbus alcool et psychose alcoolique                                      0.3670\nAccidents de transport                                                  0.1901\nArthrite rhumatoïde et ostéoarthrite                                    0.0425\nAsthme                                                                  0.2992\nAutres accidents                                                        0.2082\nAutres cardiopathies                                                    0.3492\nAutres causes externes de blessure et empoisonnement                    0.0003\nAutres maladie appareil circulatoire                                    0.1123\nAutres maladies chroniques voies respiratoires inférieures              0.0121\nAutres maladies appareil digestif                                       0.0766\n                                                                       \nAbus alcool et psychose alcoolique                                    |\nAccidents de transport                                                |\nArthrite rhumatoïde et ostéoarthrite                                  |\nAsthme                                                                |\nAutres accidents                                                      |\nAutres cardiopathies                                                  |\nAutres causes externes de blessure et empoisonnement                  |\nAutres maladie appareil circulatoire                                  |\nAutres maladies chroniques voies respiratoires inférieures            |\nAutres maladies appareil digestif                                     |\n\nColumns (the 10 first)\n                                                                       \nX0.1                                                                  |\nX1.4                                                                  |\nX5.14                                                                 |\nX15.24                                                                |\nX25.34                                                                |\nX35.44                                                                |\nX45.54                                                                |\nX55.64                                                                |\nX65.74                                                                |\nX75.84                                                                |\n                                                                      Iner*1000\nX0.1                                                                   537.4139\nX1.4                                                                    22.0580\nX5.14                                                                   17.0360\nX15.24                                                                 124.7712\nX25.34                                                                  63.1510\nX35.44                                                                  40.7880\nX45.54                                                                  46.5309\nX55.64                                                                  40.5819\nX65.74                                                                  21.2153\nX75.84                                                                  24.3797\n                                                                       \nX0.1                                                                  |\nX1.4                                                                  |\nX5.14                                                                 |\nX15.24                                                                |\nX25.34                                                                |\nX35.44                                                                |\nX45.54                                                                |\nX55.64                                                                |\nX65.74                                                                |\nX75.84                                                                |\n                                                                         Dim.1\nX0.1                                                                    7.3618\nX1.4                                                                    1.3816\nX5.14                                                                   0.6620\nX15.24                                                                  0.3351\nX25.34                                                                  0.2194\nX35.44                                                                  0.0728\nX45.54                                                                 -0.0176\nX55.64                                                                 -0.0615\nX65.74                                                                 -0.0942\nX75.84                                                                 -0.1067\n                                                                           ctr\nX0.1                                                                   97.0714\nX1.4                                                                    0.7297\nX5.14                                                                   0.2555\nX15.24                                                                  0.2397\nX25.34                                                                  0.1220\nX35.44                                                                  0.0242\nX45.54                                                                  0.0037\nX55.64                                                                  0.0684\nX65.74                                                                  0.3063\nX75.84                                                                  0.6596\n                                                                          cos2\nX0.1                                                                    0.9943\nX1.4                                                                    0.1821\nX5.14                                                                   0.0826\nX15.24                                                                  0.0106\nX25.34                                                                  0.0106\nX35.44                                                                  0.0033\nX45.54                                                                  0.0004\nX55.64                                                                  0.0093\nX65.74                                                                  0.0795\nX75.84                                                                  0.1489\n                                                                       \nX0.1                                                                  |\nX1.4                                                                  |\nX5.14                                                                 |\nX15.24                                                                |\nX25.34                                                                |\nX35.44                                                                |\nX45.54                                                                |\nX55.64                                                                |\nX65.74                                                                |\nX75.84                                                                |\n                                                                         Dim.2\nX0.1                                                                   -0.5257\nX1.4                                                                    0.9320\nX5.14                                                                   1.4590\nX15.24                                                                  2.6950\nX25.34                                                                  1.8681\nX35.44                                                                  1.1096\nX45.54                                                                  0.5937\nX55.64                                                                  0.3045\nX65.74                                                                  0.0227\nX75.84                                                                 -0.2094\n                                                                           ctr\nX0.1                                                                    1.0605\nX1.4                                                                    0.7114\nX5.14                                                                   2.6586\nX15.24                                                                 33.2157\nX25.34                                                                 18.9464\nX35.44                                                                 12.0489\nX45.54                                                                  9.0171\nX55.64                                                                  3.5848\nX65.74                                                                  0.0381\nX75.84                                                                  5.4395\n                                                                          cos2\nX0.1                                                                    0.0051\nX1.4                                                                    0.0829\nX5.14                                                                   0.4010\nX15.24                                                                  0.6841\nX25.34                                                                  0.7710\nX35.44                                                                  0.7591\nX45.54                                                                  0.4980\nX55.64                                                                  0.2270\nX65.74                                                                  0.0046\nX75.84                                                                  0.5734\n                                                                       \nX0.1                                                                  |\nX1.4                                                                  |\nX5.14                                                                 |\nX15.24                                                                |\nX25.34                                                                |\nX35.44                                                                |\nX45.54                                                                |\nX55.64                                                                |\nX65.74                                                                |\nX75.84                                                                |\n                                                                         Dim.3\nX0.1                                                                   -0.1434\nX1.4                                                                    0.8240\nX5.14                                                                   1.0125\nX15.24                                                                  1.6028\nX25.34                                                                  0.7294\nX35.44                                                                 -0.0637\nX45.54                                                                 -0.5186\nX55.64                                                                 -0.5395\nX65.74                                                                 -0.2775\nX75.84                                                                  0.0559\n                                                                           ctr\nX0.1                                                                    0.1463\nX1.4                                                                    1.0313\nX5.14                                                                   2.3750\nX15.24                                                                 21.7932\nX25.34                                                                  5.3575\nX35.44                                                                  0.0736\nX45.54                                                                 12.7615\nX55.64                                                                 20.8826\nX65.74                                                                 10.5621\nX75.84                                                                  0.7193\n                                                                          cos2\nX0.1                                                                    0.0004\nX1.4                                                                    0.0648\nX5.14                                                                   0.1931\nX15.24                                                                  0.2420\nX25.34                                                                  0.1175\nX35.44                                                                  0.0025\nX45.54                                                                  0.3800\nX55.64                                                                  0.7129\nX65.74                                                                  0.6897\nX75.84                                                                  0.0409\n                                                                       \nX0.1                                                                  |\nX1.4                                                                  |\nX5.14                                                                 |\nX15.24                                                                |\nX25.34                                                                |\nX35.44                                                                |\nX45.54                                                                |\nX55.64                                                                |\nX65.74                                                                |\nX75.84                                                                |\n\nSupplementary rows (the 10 first)\n                                                                          Dim.1\n06_Abus alcool et psychose alcoolique                                 | -0.0381\n06_Accidents de transport                                             |  0.1937\n06_Arthrite rhumatoïde et ostéoarthrite                               | -0.1364\n06_Asthme                                                             | -0.0774\n06_Autres accidents                                                   | -0.0345\n06_Autres cardiopathies                                               | -0.1233\n06_Autres causes externes de blessure et empoisonnement               | -0.0886\n06_Autres maladie appareil circulatoire                               | -0.1279\n06_Autres maladies chroniques voies respiratoires inférieures         | -0.1314\n06_Autres maladies appareil digestif                                  | -0.1077\n                                                                         cos2  \n06_Abus alcool et psychose alcoolique                                  0.0006 |\n06_Accidents de transport                                              0.0049 |\n06_Arthrite rhumatoïde et ostéoarthrite                                0.0633 |\n06_Asthme                                                              0.1241 |\n06_Autres accidents                                                    0.0053 |\n06_Autres cardiopathies                                                0.0286 |\n06_Autres causes externes de blessure et empoisonnement                0.2500 |\n06_Autres maladie appareil circulatoire                                0.0775 |\n06_Autres maladies chroniques voies respiratoires inférieures          0.1044 |\n06_Autres maladies appareil digestif                                   0.0709 |\n                                                                        Dim.2\n06_Abus alcool et psychose alcoolique                                  0.9276\n06_Accidents de transport                                              2.4590\n06_Arthrite rhumatoïde et ostéoarthrite                               -0.4156\n06_Asthme                                                             -0.0128\n06_Autres accidents                                                    0.0542\n06_Autres cardiopathies                                               -0.4238\n06_Autres causes externes de blessure et empoisonnement               -0.0724\n06_Autres maladie appareil circulatoire                               -0.3344\n06_Autres maladies chroniques voies respiratoires inférieures         -0.3419\n06_Autres maladies appareil digestif                                  -0.2782\n                                                                         cos2  \n06_Abus alcool et psychose alcoolique                                  0.3769 |\n06_Accidents de transport                                              0.7892 |\n06_Arthrite rhumatoïde et ostéoarthrite                                0.5876 |\n06_Asthme                                                              0.0034 |\n06_Autres accidents                                                    0.0131 |\n06_Autres cardiopathies                                                0.3378 |\n06_Autres causes externes de blessure et empoisonnement                0.1671 |\n06_Autres maladie appareil circulatoire                                0.5298 |\n06_Autres maladies chroniques voies respiratoires inférieures          0.7070 |\n06_Autres maladies appareil digestif                                   0.4731 |\n                                                                        Dim.3\n06_Abus alcool et psychose alcoolique                                 -0.8676\n06_Accidents de transport                                              1.1321\n06_Arthrite rhumatoïde et ostéoarthrite                                0.2837\n06_Asthme                                                              0.0811\n06_Autres accidents                                                    0.3172\n06_Autres cardiopathies                                                0.4442\n06_Autres causes externes de blessure et empoisonnement                0.0776\n06_Autres maladie appareil circulatoire                                0.2516\n06_Autres maladies chroniques voies respiratoires inférieures          0.1652\n06_Autres maladies appareil digestif                                   0.2177\n                                                                         cos2  \n06_Abus alcool et psychose alcoolique                                  0.3297 |\n06_Accidents de transport                                              0.1673 |\n06_Arthrite rhumatoïde et ostéoarthrite                                0.2737 |\n06_Asthme                                                              0.1362 |\n06_Autres accidents                                                    0.4490 |\n06_Autres cardiopathies                                                0.3712 |\n06_Autres causes externes de blessure et empoisonnement                0.1918 |\n06_Autres maladie appareil circulatoire                                0.2999 |\n06_Autres maladies chroniques voies respiratoires inférieures          0.1650 |\n06_Autres maladies appareil digestif                                   0.2895 |"
  },
  {
    "objectID": "01_afc.html#afc---marges",
    "href": "01_afc.html#afc---marges",
    "title": "Analyse Factorielle des Correspondances",
    "section": "AFC - Marges",
    "text": "AFC - Marges\nMarges des colonnes et lignes\n\n\nround(res.ca$call$marge.col, 3)\nround(res.ca$call$marge.row[order(res.ca$call$marge.row)], 3)\n\ntibble(marge_col = res.ca$call$marge.col, Age = colnames(deces_dta))  |&gt; ggplot() +  aes(x=Age, y =marge_col ) +\n  geom_bar(stat=\"identity\") + ylab(\"Marge sur les colonnes\")\n\n\n\n\n\n\n\n\ntibble(marge_row = res.ca$call$marge.row, Cause = row.names(deces_dta[1:65,]))  |&gt; ggplot() +  aes(x=Cause, y =marge_row ) + geom_bar(stat=\"identity\") + ylab(\"Marge sur les lignes\") +\n  coord_flip()\n\n\n\n\n\n\n\n\n       X0.1        X1.4       X5.14      X15.24      X25.34      X35.44 \n      0.010       0.002       0.003       0.012       0.014       0.025 \n     X45.54      X55.64      X65.74      X75.84      X85.94 X95.et.plus \n      0.066       0.099       0.190       0.319       0.219       0.041 \n                                            Infection à méningocoques \n                                                                0.000 \n                       Complic. de grossesse accouch. et puerpéralité \n                                                                0.000 \n                                       Pharmacodépendance toxicomanie \n                                                                0.000 \n                           Malformations congénitales système nerveux \n                                                                0.000 \n                                                           Méningites \n                                                                0.001 \n                                               SIDA et maladies à VIH \n                                                                0.001 \n                                   Syndrome de mort subite nourrisson \n                                                                0.001 \n                                                            Homicides \n                                                                0.001 \n                                                    Hépatites virales \n                                                                0.001 \n                                                               Grippe \n                                                                0.001 \n                                 Arthrite rhumatoïde et ostéoarthrite \n                                                                0.001 \n                 Autres malformations congén. et anom. chromosomiques \n                                                                0.001 \n                                            Tumeur maligne col utérus \n                                                                0.001 \n                                          Intoxications accidentelles \n                                                                0.001 \n                     Malformations congénitales appareil circulatoire \n                                                                0.002 \n                                                  Mélanome malin peau \n                                                                0.002 \n                                                               Asthme \n                                                                0.002 \n                             Événements dont intention non déterminée \n                                                                0.003 \n                 Autres causes externes de blessure et empoisonnement \n                                                                0.003 \n                                                          Tuberculose \n                                                                0.003 \n                                               Ulcère gastro-duodénal \n                                                                0.003 \n                      Infections peau et tissu cellulaire sous-cutané \n                                                                0.003 \n                                     Infections en période périnatale \n                                                                0.003 \nAutres maladies système ostéo-articulaire muscles et tissu conjonctif \n                                                                0.004 \n                             Autres maladies appareil génito-urinaire \n                                                                0.004 \n                            Maladies sang et organes hématopoïétiques \n                                                                0.004 \n                                                  Tumeur maligne rein \n                                                                0.005 \n                                 Tumeur maligne autres parties utérus \n                                                                0.005 \n                                                Tumeur maligne ovaire \n                                                                0.005 \n                                   Abus alcool et psychose alcoolique \n                                                                0.006 \n                                                Tumeur maligne vessie \n                                                                0.008 \n                                        Tumeur maligne rectum et anus \n                                                                0.009 \n                                             Tumeur maligne oesophage \n                                                                0.009 \n                       Tumeur maligne lèvre cavité buccale et pharynx \n                                                                0.009 \n                                                       Autres tumeurs \n                                                                0.010 \n               Tumeur maligne foie et voies biliaires intrahépatiques \n                                                                0.011 \n                         Autres maladies infectieuses et parasitaires \n                                                                0.011 \n                                              Tumeur maligne pancréas \n                                                                0.012 \n                                             Maladies rein et uretère \n                                                                0.013 \n                                               Tumeur maligne estomac \n                                                                0.013 \n        Autres maladies endocriniennes nutritionelles et métaboliques \n                                                                0.013 \n                                                            Pneumonie \n                                                                0.014 \n                                              Tumeur maligne prostate \n                                                                0.015 \n                                               Accidents de transport \n                                                                0.015 \n                              Autres troubles mentaux et comportement \n                                                                0.016 \n           Autres maladies chroniques voies respiratoires inférieures \n                                                                0.016 \n                                                 Chutes accidentelles \n                                                                0.017 \n                                                        Diabète sucré \n                                                                0.017 \n                                                  Tumeur maligne sein \n                                                                0.019 \n                                                             Suicides \n                                                                0.019 \n               Tumeur maligne tissus lymphatiques et hématopoïétiques \n                                                                0.019 \n                                                 Tumeur maligne côlon \n                                                                0.021 \n                                               Maladie chronique foie \n                                                                0.022 \n                                                     Autres accidents \n                                                                0.024 \n                                Autres maladies appareil respiratoire \n                                                                0.025 \n                                    Causes inconnues ou non précisées \n                                                                0.027 \n                                    Autres maladies appareil digestif \n                                                                0.031 \n                        Autres symptômes et états morbide mal définis \n                                                                0.036 \n                      Autres maladies système nerveux et organes sens \n                                                                0.037 \n                                              Autres tumeurs malignes \n                                                                0.046 \n                     Tumeur maligne larynx trachée bronches et poumon \n                                                                0.048 \n                                 Autres maladie appareil circulatoire \n                                                                0.059 \n                                            Cardiopathies ischémiques \n                                                                0.084 \n                                                 Autres cardiopathies \n                                                                0.092 \n                                          Maladies cérébrovasculaires \n                                                                0.093"
  },
  {
    "objectID": "01_afc.html#afc---valeurs-propres",
    "href": "01_afc.html#afc---valeurs-propres",
    "title": "Analyse Factorielle des Correspondances",
    "section": "AFC - Valeurs propres",
    "text": "AFC - Valeurs propres\n\n\ntibble(eigen = res.ca$eig[,1], Rank = 1:length(res.ca$eig[,1]))  |&gt; ggplot() +  aes(x=Rank, y =eigen ) +\n  geom_bar(stat=\"identity\") + ylab(\"Valeurs propres\")"
  },
  {
    "objectID": "01_afc.html#inertie-par-colonnes-et-lignes",
    "href": "01_afc.html#inertie-par-colonnes-et-lignes",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Inertie par colonnes et lignes",
    "text": "Inertie par colonnes et lignes\n\n\ninertia.col &lt;- tibble(Age= colnames(deces_dta),\n                      poids = res.ca$call$marge.col, \n                  inertie = res.ca$col$inertia,\n                  percent.inertie = res.ca$col$inertia / sum(res.ca$col$inertia), \n                  contrib_Dim1 = round(res.ca$col$contrib[,1],2),\n                  contrib_Dim2 = round(res.ca$col$contrib[,2]),\n                  contrib_Dim3 = round(res.ca$col$contrib[,3]))\ninertia.col |&gt;  arrange(-inertie) |&gt; flextable()\n\ninertia.row &lt;- tibble(Cause= row.names(deces_dta[1:65,]),\n                      poids = res.ca$call$marge.row, \n                  inertie = res.ca$row$inertia,\n                  percent.inertie = res.ca$row$inertia / sum(res.ca$row$inertia),\n                  contrib_Dim1 = round(res.ca$row$contrib[,1],2),\n                  contrib_Dim2 = round(res.ca$row$contrib[,2],2),\n                  contrib_Dim3 = round(res.ca$row$contrib[,3],2))\ninertia.row |&gt;  arrange(-inertie)|&gt; flextable()\n\n\nAgepoidsinertiepercent.inertiecontrib_Dim1contrib_Dim2contrib_Dim3X0.10.0098595420.537413930.5262217397.0710X15.240.0117522270.124771230.122172740.243322X25.340.0139521650.063150960.061835770.12195X85.940.2189378090.054581470.053444750.451016X45.540.0657485600.046530890.045561840.00913X35.440.0251475530.040787990.039938540.02120X55.640.0993857760.040581940.039736770.07421X95.et.plus0.0410056370.028761570.028162580.0738X75.840.3188946040.024379690.023871950.6651X1.40.0021044530.022058030.021598650.7311X65.740.1900020520.021215310.020773480.31011X5.140.0032096220.017035990.016681190.2632\nCausepoidsinertiepercent.inertiecontrib_Dim1contrib_Dim2contrib_Dim3Infections en période périnatale0.00335804920.330981420710.3240883880159.101.310.31Accidents de transport0.01527382940.139931258300.137017044150.1641.0519.20Syndrome de mort subite nourrisson0.00080736880.081079676940.0793911082514.440.340.09Malformations congénitales appareil circulatoire0.00178963600.066773538820.0653829103511.510.040.08Suicides0.01929271090.051057881250.049994547710.0016.250.00Autres malformations congén. et anom. chromosomiques0.00143983920.041716197560.040847414317.430.010.00Tumeur maligne larynx trachée bronches et poumon0.04784463730.027949913980.027367827920.091.2416.50Maladie chronique foie0.02232081660.027049806310.026486465930.023.0412.21Autres symptômes et états morbide mal définis0.03641006390.020945276910.020509069710.062.195.31Autres cardiopathies0.09221399620.020118124830.019699143930.234.275.07Malformations congénitales système nerveux0.00047742530.020024947060.019607906693.080.030.08Autres accidents0.02359804760.017932385930.017558925320.324.132.69Causes inconnues ou non précisées0.02664695200.013634830720.013350871181.531.640.00Maladies cérébrovasculaires0.09348082780.012213736990.011959373200.272.870.96Abus alcool et psychose alcoolique0.00598152510.010578073940.010357774540.001.702.80Tumeur maligne lèvre cavité buccale et pharynx0.00919492850.010351828650.010136241040.010.854.75Événements dont intention non déterminée0.00252326380.009829092960.009624391870.013.390.44Autres troubles mentaux et comportement0.01623340710.008644149320.008464125910.051.212.59Homicides0.00093499740.006384440490.006251477870.051.860.49Autres tumeurs malignes0.04646624890.006378527530.006245688050.070.393.18Infection à méningocoques0.00013897330.006308776120.006177389290.210.120.16Tumeur maligne sein0.01913293890.005875630510.005753264380.030.442.99Pneumonie0.01398619910.005431278850.005318166810.020.851.63SIDA et maladies à VIH0.00076482590.005364335420.005252617550.000.720.20Tumeur maligne oesophage0.00876099140.005252791610.005143396760.020.233.07Cardiopathies ischémiques0.08352107340.005178771740.005070918430.230.740.62Autres maladie appareil circulatoire0.05860892440.004919794940.004817335090.161.290.40Complic. de grossesse accouch. et puerpéralité0.00014180950.003613240990.003537991480.000.720.35Autres maladies système nerveux et organes sens0.03726659340.003341343620.003271756660.020.391.27Chutes accidentelles0.01685831430.003220241800.003153176910.030.281.30Tumeur maligne prostate0.01466688470.003064657470.003000832780.050.500.00Tumeur maligne foie et voies biliaires intrahépatiques0.01083802800.003050012520.002986492830.020.031.55Pharmacodépendance toxicomanie0.00020987810.002980355590.002918286580.000.640.13Intoxications accidentelles0.00147860050.002952618150.002891126800.000.920.21Autres maladies appareil respiratoire0.02510879150.002821865690.002763097400.030.710.60Tumeur maligne tissus lymphatiques et hématopoïétiques0.01935321630.002783867680.002725890730.010.320.09Tumeur maligne pancréas0.01215023870.002445922360.002394983480.030.001.30Autres maladies endocriniennes nutritionelles et métaboliques0.01324311730.002433202070.002382528110.000.270.78Maladies rein et uretère0.01290182910.002276589820.002229177470.030.540.44Méningites0.00059087300.002124302380.002080061570.300.060.00Tumeur maligne côlon0.02056616030.002100536210.002056790360.060.100.54Tumeur maligne estomac0.01303040300.001918411220.001878458310.030.000.79Autres maladies chroniques voies respiratoires inférieures0.01640830550.001797146160.001759718720.040.430.02Tumeur maligne ovaire0.00535661780.001671766140.001636949870.010.090.98Diabète sucré0.01710222670.001563476030.001530915020.050.300.00Infections peau et tissu cellulaire sous-cutané0.00325594630.001474549170.001443840150.010.250.45Tumeur maligne rectum et anus0.00874208350.001300407830.001273325480.020.000.59Tumeur maligne col utérus0.00144362080.001227907610.001202335160.000.160.40Tumeur maligne vessie0.00786948230.001107498890.001084434070.020.050.27Autres maladies appareil digestif0.03108748040.001066019440.001043818480.040.260.06Mélanome malin peau0.00208649060.001005081230.000984149370.000.200.20Autres maladies appareil génito-urinaire0.00414840080.000960222620.000940224980.010.220.19Tumeur maligne rein0.00495860580.000942757370.000923123470.010.010.50Tumeur maligne autres parties utérus0.00497656830.000821990870.000804872050.010.010.50Maladies sang et organes hématopoïétiques0.00424672210.000653203270.000639599630.000.000.09Autres maladies infectieuses et parasitaires0.01116513530.000557927440.000546308020.010.090.10Hépatites virales0.00100968370.000380537010.000372611930.000.080.07Autres tumeurs0.01001742370.000354017910.000346645120.010.020.01Autres maladies système ostéo-articulaire muscles et tissu conjonctif0.00373998940.000351048740.000343737790.010.060.10Grippe0.00111462270.000299293420.000293060330.000.040.12Tuberculose0.00264900160.000267626380.000262052780.000.010.13Arthrite rhumatoïde et ostéoarthrite0.00121672560.000171596060.000168022400.000.030.01Ulcère gastro-duodénal0.00281822760.000149731310.000146613000.010.010.04Autres causes externes de blessure et empoisonnement0.00260456800.000064736760.000063388550.000.010.00Asthme0.00237483660.000046792430.000045817930.000.000.01"
  },
  {
    "objectID": "01_afc.html#visualisation-des-résultats-axes-1-et-2",
    "href": "01_afc.html#visualisation-des-résultats-axes-1-et-2",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Visualisation des résultats : axes 1 et 2",
    "text": "Visualisation des résultats : axes 1 et 2\n\n\nfviz_ca(res.ca, axes = 1:2, invisible = c(\"row\", \"row.sup\"))\n\n\n\n\n\n\n\n\nfviz_ca(res.ca, axes = 2:3, invisible = c(\"row\", \"row.sup\"))\n\n\n\n\n\n\n\nfviz_ca(res.ca, axes = 1:2, invisible = c(\"row.sup\"))\n\n\n\n\n\n\n\nfviz_ca(res.ca, axes = 1:2, invisible = c(\"row.sup\"), select.row =  list(contrib = 10))\n\n\n\n\n\n\n\nfviz_ca(res.ca, axes = 2:3, invisible = c(\"row.sup\"), select.row =  list(contrib = 10))"
  },
  {
    "objectID": "01_afc.html#visualisation-des-résultats-axes-2-et-3",
    "href": "01_afc.html#visualisation-des-résultats-axes-2-et-3",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Visualisation des résultats : axes 2 et 3",
    "text": "Visualisation des résultats : axes 2 et 3\n\n\nfviz_ca(res.ca, axes = 2:3, invisible = c(\"row.sup\"), select.row =  list(contrib = 10))"
  },
  {
    "objectID": "01_afc.html#distance-et-résumé-des-contributions",
    "href": "01_afc.html#distance-et-résumé-des-contributions",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Distance et résumé des contributions",
    "text": "Distance et résumé des contributions\nDistances entre colonnes\n\n\nround(dist(res.ca$col$coord), 3)\n\n\n             X0.1  X1.4 X5.14 X15.24 X25.34 X35.44 X45.54 X55.64 X65.74 X75.84\nX1.4        6.818                                                             \nX5.14       7.221 2.069                                                       \nX15.24      7.965 3.656 2.008                                                 \nX25.34      7.611 3.263 1.874  1.840                                          \nX35.44      7.495 3.241 2.118  2.694  1.250                                   \nX45.54      7.480 3.322 2.352  3.166  1.944  0.874                            \nX55.64      7.483 3.354 2.428  3.329  2.171  1.175  0.412                     \nX65.74      7.480 3.346 2.428  3.374  2.249  1.343  0.767  0.445              \nX75.84      7.480 3.342 2.445  3.410  2.312  1.496  1.073  0.827  0.422       \nX85.94      7.486 3.351 2.485  3.449  2.373  1.619  1.282  1.094  0.754  0.380\nX95.et.plus 7.505 3.390 2.562  3.508  2.463  1.766  1.491  1.355  1.098  0.807\n            X85.94\nX1.4              \nX5.14             \nX15.24            \nX25.34            \nX35.44            \nX45.54            \nX55.64            \nX65.74            \nX75.84            \nX85.94            \nX95.et.plus  0.474\n\n\nDistances entre lignes\n\n\nround(dist(res.ca$row$coord), 3)"
  },
  {
    "objectID": "01_afc.html#résumé-des-contributions-axes-2-à-5",
    "href": "01_afc.html#résumé-des-contributions-axes-2-à-5",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Résumé des contributions (axes 2 à 5)",
    "text": "Résumé des contributions (axes 2 à 5)\n\n\nround(data.frame(CTR = res.ca$col$contrib[,2:5], \n                 CO2 = res.ca$col$cos2[,2:5]), 3)\n\n\n            CTR.Dim.2 CTR.Dim.3 CTR.Dim.4 CTR.Dim.5 CO2.Dim.2 CO2.Dim.3\nX0.1            1.060     0.146     0.015     0.599     0.005     0.000\nX1.4            0.711     1.031     2.089    58.057     0.083     0.065\nX5.14           2.659     2.375     4.075    15.458     0.401     0.193\nX15.24         33.216    21.793    13.518     0.920     0.684     0.242\nX25.34         18.946     5.357     4.207     6.381     0.771     0.118\nX35.44         12.049     0.074    19.113     1.596     0.759     0.003\nX45.54          9.017    12.762    11.460     2.453     0.498     0.380\nX55.64          3.585    20.883     0.002     2.923     0.227     0.713\nX65.74          0.038    10.562    11.896     0.471     0.005     0.690\nX75.84          5.439     0.719     9.790     5.097     0.573     0.041\nX85.94         10.447    16.309     6.272     0.298     0.492     0.414\nX95.et.plus     2.832     7.988    17.564     5.747     0.253     0.385\n            CO2.Dim.4 CO2.Dim.5\nX0.1            0.000     0.000\nX1.4            0.032     0.523\nX5.14           0.081     0.180\nX15.24          0.037     0.001\nX25.34          0.023     0.020\nX35.44          0.159     0.008\nX45.54          0.083     0.010\nX55.64          0.000     0.014\nX65.74          0.190     0.004\nX75.84          0.136     0.042\nX85.94          0.039     0.001\nX95.et.plus     0.207     0.040"
  },
  {
    "objectID": "01_afc.html#résultats-supplémentaires",
    "href": "01_afc.html#résultats-supplémentaires",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Résultats supplémentaires",
    "text": "Résultats supplémentaires\nSuppression et ajustement des éléments supplémentaires\n\n\nrow_sup =  res.ca$row.sup$coord[, 1:3] |&gt; as.data.frame() |&gt; rownames_to_column()\n\nrow_annee &lt;- row_sup |&gt; filter(str_detect(rowname, pattern = \"^[12]\"))\n\nannees = deces_dta |&gt; rownames_to_column(\"Cause\") |&gt; filter(str_detect(Cause, pattern = \"^[12]\")) |&gt; pull(Cause) |&gt; as.list()\n\n# fviz_ca(res.ca, invisible = c( \"col\"), select.row=  list(contrib = 10),  axes = 2:3) +\n# geom_point(data = row_annee, aes(x=`Dim 2`, y = `Dim 3`)) +\n# geom_text(data = row_annee, aes(x=`Dim 2`, y = `Dim 3`, label = rowname)) \n\nfviz_ca(res.ca, invisible = c( \"col\"), axes = 2:3) +\ngeom_point(data = row_annee, aes(x=`Dim 2`, y = `Dim 3`)) +\ngeom_text(data = row_annee, aes(x=`Dim 2`, y = `Dim 3`, label = rowname))"
  },
  {
    "objectID": "01_afc.html#ce-que-vous-pensez-devoir-retenir",
    "href": "01_afc.html#ce-que-vous-pensez-devoir-retenir",
    "title": "Analyse Factorielle des Correspondances",
    "section": "Ce que vous pensez devoir retenir",
    "text": "Ce que vous pensez devoir retenir\npour des données qualitatives, avec seulement deux variables qualitatives\nLe tableau de contingence est à la base de la méthode\nOn commence par un test du chi2 qui teste l’independance\nLes notions de profils lignes et profils colonnes\nOn fait deux ACPS : * une ACP sur les profils lignes affcetés du poids de sa marge avec la métrique 1/ marge de la colonne * une ACP sur les profils colonnes affcetés du poids de leur marge avec la métrique 1/ marge de la ligne\nla métrique est choisi pour que l’inertie totale soit le coefficient phi du test de chi2 (chi2/n)\nC’est une mesure d’écart à l’independance\nUne des forces de l’ACP est la représentation jointe de slignes et des colonnes grâce aux relations barycenytriques\nles profils lignes ayant de svaleur positives sur un axe sont associés préférentiellement aux colonnes ayant des valeurs, tandis qu’ils s’associent moins qu’attendu avec les colonnes qui ont des valeurs négatives\nLes contributions, des lignes/ et des colonnes ssont intéressantes. Il faut vérifier la qualité d ela représentaion"
  },
  {
    "objectID": "01_acm.html#objectif",
    "href": "01_acm.html#objectif",
    "title": "Analyse Correspondances Multiples",
    "section": "Objectif",
    "text": "Objectif\nLe but de l’analyse des correspondances multiples (ACM) est de généraliser l’AFC en étudiant les liaisons entre plusieurs variables qualitatives.\n\nC’est l’équivalent de l’ACP pour des variables qualitatives.\n\nLes données décrivent\n\n\\(n\\) individus\nau travers de \\(p\\) variables qualitatives\nayant respectivement \\(m_1, \\ldots, m_p\\) modalités.\n\nOn note \\(m\\) le nombre total de modalités de sorte que :\n\\[\nm=\\sum_{j=1}^p m_j.\n\\]"
  },
  {
    "objectID": "01_acm.html#exemple-position-sur-les-ogm",
    "href": "01_acm.html#exemple-position-sur-les-ogm",
    "title": "Analyse Correspondances Multiples",
    "section": "Exemple : Position sur les OGM",
    "text": "Exemple : Position sur les OGM\n\n\nogm_dta &lt;- read_delim(\"ogm.csv\", delim = \";\", \n                  escape_double = FALSE, locale = locale(encoding = \"WINDOWS-1252\"), \n                  trim_ws = TRUE)\nogm_dta &lt;- ogm_dta |&gt; mutate(across(where(is.character), as.factor))\nsummary(ogm_dta[,1:15]) \nsummary(ogm_dta[,16:21]) \n\n\n        Concerné               Position Culture               Position Al H\n Beaucoup   :36   Favorable            :45      Favorable            :37   \n Moyen      :53   Pas Favorable du Tout:33      Pas Favorable du Tout:50   \n Pas du Tout:15   Plutôt Défavorable   :54      Plutôt Défavorable   :47   \n Un Peu     :31   Très Favorable       : 3      Très Favorable       : 1   \n               Position Al A Manif     Media Actif Info Active\n Favorable            :44    Non:122   Non:78      Non:82     \n Pas Favorable du Tout:44    Oui: 13   Oui:57      Oui:53     \n Plutôt Défavorable   :39                                     \n Très Favorable       : 8                                     \n Produits Phytosanitaires Famine   Amélioration Agr Futur Progrès Danger  \n Non:56                   Non:67   Non:93           Non:54        Non:39  \n Oui:79                   Oui:68   Oui:42           Oui:81        Oui:96  \n                                                                          \n                                                                          \n Menace   Risque Eco Procédé Inutile\n Non:48   Non:67     Non:123        \n Oui:87   Oui:68     Oui: 12        \n                                    \n                                    \n Grds Parents Sexe         Age                    CSP     Relation\n Non:49       F:71   [26; 40]:24   Etudiant         :69   Non:79  \n Oui:86       H:64   [41; 60]:24   Cadre            :17   Oui:56  \n                     &lt; 25    :73   Retraité         :14           \n                     &gt; 60    :14   Autre            : 9           \n                                   Fonction Publique: 9           \n                                   Technicien       : 6           \n                                   (Other)          :11           \n       Parti Politique\n Centre        :32    \n Extrême gauche: 9    \n PS            :47    \n UMP           :40    \n Verts         : 7"
  },
  {
    "objectID": "01_acm.html#lien-avec-lafc",
    "href": "01_acm.html#lien-avec-lafc",
    "title": "Analyse Correspondances Multiples",
    "section": "Lien avec l’AFC",
    "text": "Lien avec l’AFC\n\n\n\nL’AFC fait le lien entre les modalités de deux variables qualitatives.\nDans l’AFC, on ne prête plus attention aux individus (ici un répondant) et on s’intéresse au tableau de contingence uniquement (défini à partir du tableau disjonctif complet)\nLa distance entre deux profils est mesurée à l’aide de la distance du \\(\\chi^2\\)."
  },
  {
    "objectID": "01_acm.html#représentation-des-variables-qualitatives",
    "href": "01_acm.html#représentation-des-variables-qualitatives",
    "title": "Analyse Correspondances Multiples",
    "section": "Représentation des variables qualitatives",
    "text": "Représentation des variables qualitatives\nDans les données initiales, pour chaquae individu, et pour chaque variable qualitative, on note la modalité observée.\nPour manipuler les données, on recode souvent ces données initiales sous forme du tableau disjonctif complet \\(Z\\).\nDans ce tableau, une colonne représente une modalité, pour une des variables et on note \\(1\\) si l’individu possède cette variable \\(0\\) sinon\nQuestions :\n\nQuelles sont les dimensions de \\(Z\\) ?\n\\(\\sum_{k=1}^m Z_{ik} = ??\\)\n\\(\\sum_{i=1}^n Z_{ik} = ??\\)\n\n\nNotation :\n\\[\nZ = \\begin{pmatrix}Z_1 \\ldots Z_p\\end{pmatrix}\n\\] \\(Z_j\\) est donc un tableau à \\(n\\) lignes et \\(m_j\\) colonnes."
  },
  {
    "objectID": "01_acm.html#tableau-de-burt",
    "href": "01_acm.html#tableau-de-burt",
    "title": "Analyse Correspondances Multiples",
    "section": "Tableau de Burt",
    "text": "Tableau de Burt\n\nDefinitionExemple avec trois variables qualitatives\n\n\nOn définit le tableau de Burt \\(B\\) par :\n\\[\nB = Z^\\top Z = \\begin{pmatrix}\nB_1 & B_{12}& \\ldots &B_{1p} \\\\\nB_{21} & B_{2}& \\ldots & \\vdots \\\\\n\\vdots & & \\ddots & \\vdots \\\\\nB_{p1} & \\ldots & & B_p\n\\end{pmatrix},\n\\]\nComme vu pour l’AFC sur l’onglet Table de contingence\n\nLes blocs diagonaux \\(B_j\\) représentent les effectifs de chaque modalité de la variable \\(j\\) (\\(j=1, \\ldots,p\\)).\nLes blocs non diagonaux \\(B_{j\\ell}\\) comptent les individus croisant les modalités des variables \\(j\\) et \\(\\ell\\).\n\nLa somme des valeurs dans chaque ligne ou colonne correspond à l’effectif total des individus.\nQuestions :\n\nQuelles sont les dimensions de \\(B\\) ?\n\\(\\sum_{k=1}^K B_{ik} = ??\\)\n\\(\\sum_{i=1}^I B_{ik} = ??\\)\n\n\n\n\n\n\\[\\bf{Z} = \\overset{{\\begin{matrix} \\class{orange}{a_1} & \\class{orange}{a_2} & \\class{rouge}{b_1} & \\class{rouge}{b_2} & \\class{rouge}{b_3}& \\class{vert}{c_1} & \\class{vert}{c_2} & \\class{vert}{c_3}\\end{matrix}}}{\n\\begin{pmatrix}\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0} &  \\class{vert}{0} & \\class{vert}{0} & \\class{vert}{1}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0}&  \\class{vert}{0} & \\class{vert}{1} & \\class{vert}{0}\\\\\n\\class{orange}{0} & \\class{orange}{1} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0} & \\class{vert}{0} & \\class{vert}{1} & \\class{vert}{0}\\\\\n\\class{orange}{0} & \\class{orange}{1} &  \\class{rouge}{1} & \\class{rouge}{0} & \\class{rouge}{0} &  \\class{vert}{1} & \\class{vert}{0} & \\class{vert}{0}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{1} & \\class{rouge}{0} & \\class{rouge}{0}&  \\class{vert}{0} & \\class{vert}{0} & \\class{vert}{1}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{0} & \\class{rouge}{1}&  \\class{vert}{1} & \\class{vert}{0} & \\class{vert}{0}\\\\\n\\end{pmatrix}}\\]\n\n\\[\\bf{B} =  ??\\]\n\n\\[\\bf{B} = \\begin{pmatrix}\n\\class{orange}{4} & \\class{orange}{0} & {1} & {2}& {1} & {1} & {1}& {2}\\\\\n\\class{orange}{0} & \\class{orange}{2} & {1} & {1}& {0} & {1} & {1}& {0}\\\\\n{1} &  {1} &  \\class{rouge}{2}  & \\class{rouge}{0}& \\class{rouge}{0} & {1} & {0}& {1}\\\\\n{2} &  {1} &  \\class{rouge}{0}  & \\class{rouge}{3}& \\class{rouge}{0} & {0} & {2}& {1}\\\\\n{1} &  {0} &  \\class{rouge}{0}  & \\class{rouge}{0}& \\class{rouge}{1} & {1} & {0}& {0}\\\\\n{1} &  {1} &  {1}  & {0}& {1} & \\class{vert}{2} & \\class{vert}{0}& \\class{vert}{0}\\\\\n{1} &  {1} &  {0}  & {2}& {0} & \\class{vert}{0} & \\class{vert}{2}& \\class{vert}{0}\\\\\n{2} &  {0} &  {1}  & {1}& {0} & \\class{vert}{0} & \\class{vert}{0}& \\class{vert}{2}\\\\\n\\end{pmatrix}\n\\]"
  },
  {
    "objectID": "01_acm.html#intuition",
    "href": "01_acm.html#intuition",
    "title": "Analyse Correspondances Multiples",
    "section": "Intuition",
    "text": "Intuition\nOn veut généraliser ce qu’on a fait dans l’AFC, c’est à dire\n\ndéfinir des distances entre des profils lignes (remarque ici profil ligne et profil colonne sont identiques)\nfaire abstraction des individus, pour ne regarder que les liens entre les différentes modalités.\n\nOn a besoin de définir une “AFC” sur le tableau de Burt\n\nle poids associé à chaque ligne sera la fréquence de la modalité considérée\nla distance pondère les colonnes, avec \\(1/f_{+j}\\)"
  },
  {
    "objectID": "01_acm.html#les-points",
    "href": "01_acm.html#les-points",
    "title": "Analyse Correspondances Multiples",
    "section": "Les points",
    "text": "Les points\n\nQue vaut la matrice \\(X\\) ?Exemple avec trois variables qualitatives\n\n\n\nOn considère \\(X = \\frac{1}{p} \\Delta^{-1} B\\), où \\(\\Delta\\) est une matrice diagonale qui contient les effectifs de chaque modalité, c’est c’est-à -dire \\[Diag(\\Delta)= Diag (B).\\]\nCeci revient à diviser chaque ligne \\(i\\) par l’effectif dans la modalité \\(j\\).\n\\(X_{ij} = \\frac{k_{ik}}{k_{i+}}.\\)\n\n\n\n\n\n\\[\\bf{\\Delta^{-1}} = \\begin{pmatrix}\n\\class{orange}{1/4} & \\class{orange}{0} & {0} & {0}& {0} & {0} & {0}& {0}\\\\\n\\class{orange}{0} & \\class{orange}{1/2} & {0} & {0}& {0} & {0} & {0}& {0}\\\\\n{0} &  {0} &  \\class{rouge}{1/2}  & \\class{rouge}{0}& \\class{rouge}{0} & {0}& {0}& {0}\\\\\n{0} &  {0} &  \\class{rouge}{0}  & \\class{rouge}{1/3}& \\class{rouge}{0} & {0} & {0}& {0}\\\\\n{0} &  {0} &  \\class{rouge}{0}  & \\class{rouge}{0}& \\class{rouge}{1} &{0} & {0}& {0}\\\\\n{0} &  {0} &  {0}  & {0}& {0} & \\class{vert}{1/2} & \\class{vert}{0}& \\class{vert}{0}\\\\\n{0} &  {0} &  {0}  & {0}& {0} & \\class{vert}{0} & \\class{vert}{1/2}& \\class{vert}{0}\\\\\n{0} &  {0} &  {0}  &{0}& {0} & \\class{vert}{0} & \\class{vert}{0}& \\class{vert}{1/2}\\\\\n\\end{pmatrix}\n\\] \\[\\bf{B} = \\begin{pmatrix}\n\\class{orange}{4} & \\class{orange}{0} & {1} & {2}& {1} & {1} & {1}& {2}\\\\\n\\class{orange}{0} & \\class{orange}{2} & {1} & {1}& {0} & {1} & {1}& {0}\\\\\n{1} &  {1} &  \\class{rouge}{2}  & \\class{rouge}{0}& \\class{rouge}{0} & {1} & {0}& {1}\\\\\n{2} &  {1} &  \\class{rouge}{0}  & \\class{rouge}{3}& \\class{rouge}{0} & {0} & {2}& {1}\\\\\n{1} &  {0} &  \\class{rouge}{0}  & \\class{rouge}{0}& \\class{rouge}{1} & {1} & {0}& {0}\\\\\n{1} &  {1} &  {1}  & {0}& {1} & \\class{vert}{2} & \\class{vert}{0}& \\class{vert}{0}\\\\\n{1} &  {1} &  {0}  & {2}& {0} & \\class{vert}{0} & \\class{vert}{2}& \\class{vert}{0}\\\\\n{2} &  {0} &  {1}  & {1}& {0} & \\class{vert}{0} & \\class{vert}{0}& \\class{vert}{2}\\\\\n\\end{pmatrix}\n\\]\n\n\n\\[\\bf{\\frac{1}{p} \\Delta^{-1} B} = \\bf{X} =   \\frac{1}{3} \\begin{pmatrix}\n1& 0& 1/4 & 1/2 & 1/4 & 1/4 & 1/4 & 1/2  \\\\\n0 & 1 & 1/2  & 0.5 & 0& 1/2  & 1/2 & 0 \\\\\n1/2 & 1/2 & 1   & 0.0 & 0& 1/2  & 0 & 1/2 \\\\\n2/3  & 1/3  & 0& 1 & 0& 0& 2/3  & 1/3 \\\\\n1 & 0 & 0& 0.0 & 1   & 1   & 0 & 0 \\\\\n1/2 & 1/2 & 1/2  & 0.0 & 1/2  & 1   & 0 & 0 \\\\\n1/2 & 1/2 & 0& 1 & 0& 0& 1 & 0 \\\\\n1 & 0 & 1/2  & 1/2 & 0& 0& 0 & 1 \\\\\n\\end{pmatrix}\\]"
  },
  {
    "objectID": "01_acm.html#poids-de-chaque-ligne-ici-un-profil-ligne",
    "href": "01_acm.html#poids-de-chaque-ligne-ici-un-profil-ligne",
    "title": "Analyse Correspondances Multiples",
    "section": "Poids de chaque ligne (ici un profil ligne)",
    "text": "Poids de chaque ligne (ici un profil ligne)\n\nOn associe à chaque profil ligne le poids \\({f_{i+}}\\),\n\nDans le formalisme vu en ACP, ceci correspond à la matrice \\(W = \\frac{1}{np} \\Delta\\)"
  },
  {
    "objectID": "01_acm.html#metrique",
    "href": "01_acm.html#metrique",
    "title": "Analyse Correspondances Multiples",
    "section": "Metrique",
    "text": "Metrique\n\nOn veut utiliser la métrique du \\(\\chi^2\\), telle que la distance entre deux profils \\(i_1\\) et \\(i_2\\)\n\n\\[d(x_{i_1}, x_{i_2})^2 =\\sum_{k=1}^{m}  \\frac{1}{f_{+k}} \\left(\\frac{f_{i_1k}}{f_{i_1+}} -\\frac{f_{i_2k}}{f_{i_2+}}\\right)^2\\]\nDans le formalisme matriciel de l’ACP ceci revient à définir la métrique\n\\(M = D_{1/f_{+ j}} = np\\Delta^{-1}\\)"
  },
  {
    "objectID": "01_acm.html#inertie",
    "href": "01_acm.html#inertie",
    "title": "Analyse Correspondances Multiples",
    "section": "Inertie",
    "text": "Inertie\nOn est conduit à trouver les valeurs propres de\n\\[(X M^{1/2})^\\top W (X M^{1/2})\\]\nou de manière équivalente celles de la matrice\n\\[VM = X^\\top W X M =  \\Delta^{-1} \\frac{1}{p}  B^\\top \\frac{1}{np} \\Delta \\Delta^{-1} \\frac{1}{p}  B np  \\Delta^{-1} = \\left ( \\frac{1}{p} \\Delta^{-1}   B \\right )^2\\]\nOn peut montrer que l’inertie du nuage des profils-lignes est donnée par :\n\\[\nI = \\frac{m-p}{p^2} + \\frac{n}{p^2} \\sum_{j_1=1}^p \\sum_{j_2 \\neq j_1} \\mathcal{X}^2_{j_1,j_2},\n\\]\noù \\(\\mathcal{\\chi}^2_{j_1,j_2}\\) est le coefficient de liaison entre les variables \\(j_1\\) et \\(j_2\\).\nInterprétation de l’inertie\nL’inertie I obtenue par l’AFC de \\(B\\) mesure la liaison globale entre tous les couples de variables. Cette interprétation de l’inertie justifie de faire l’AFC sur le tableau B.\nLorsque els variables sont strictement indépendantes \\[I = \\frac{m-p}{p^2}\\]"
  },
  {
    "objectID": "01_acm.html#bilan-de-lafc-sur-le-tableau-de-burt",
    "href": "01_acm.html#bilan-de-lafc-sur-le-tableau-de-burt",
    "title": "Analyse Correspondances Multiples",
    "section": "Bilan de l’AFC sur le tableau de Burt",
    "text": "Bilan de l’AFC sur le tableau de Burt\n\nComme en ACP, on a le triplet \\((X, W, M)\\)\npermet de généraliser l’AFC à plus que 2 modalités\nMAIS Perte de l’information sur les individus"
  },
  {
    "objectID": "01_acm.html#intuition-1",
    "href": "01_acm.html#intuition-1",
    "title": "Analyse Correspondances Multiples",
    "section": "Intuition",
    "text": "Intuition\nOn veut garder l’information sur les individus\n\non va travailler à partir du tableau disjonctif complet \\(Z\\)\non veut garder la même métrique pour les variables que lors de l’AFC sur le tableau de Burt"
  },
  {
    "objectID": "01_acm.html#les-points-1",
    "href": "01_acm.html#les-points-1",
    "title": "Analyse Correspondances Multiples",
    "section": "Les points",
    "text": "Les points\nOn effectue l’AFC à partir du tableau \\(Z\\), qui conserve toutes les informations relatives à chaque individu.\n\nQue vaut la matrice \\(X\\) ?Exemple avec trois variables qualitatives\n\n\n\nOn considère \\(X =  \\frac{1}{p} Z\\).\n\n\n\n\\[\\bf{X} = \\frac{1}{p}\\bf{Z} = \\frac{1}{3} \\overset{{\\begin{matrix} \\class{orange}{a_1} & \\class{orange}{a_2} & \\class{rouge}{b_1} & \\class{rouge}{b_2} & \\class{rouge}{b_3}& \\class{vert}{c_1} & \\class{vert}{c_2} & \\class{vert}{c_3}\\end{matrix}}}{\n\\begin{pmatrix}\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0} &  \\class{vert}{0} & \\class{vert}{0} & \\class{vert}{1}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0}&  \\class{vert}{0} & \\class{vert}{1} & \\class{vert}{0}\\\\\n\\class{orange}{0} & \\class{orange}{1} &  \\class{rouge}{0} & \\class{rouge}{1} & \\class{rouge}{0} & \\class{vert}{0} & \\class{vert}{1} & \\class{vert}{0}\\\\\n\\class{orange}{0} & \\class{orange}{1} &  \\class{rouge}{1} & \\class{rouge}{0} & \\class{rouge}{0} &  \\class{vert}{1} & \\class{vert}{0} & \\class{vert}{0}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{1} & \\class{rouge}{0} & \\class{rouge}{0}&  \\class{vert}{0} & \\class{vert}{0} & \\class{vert}{1}\\\\\n\\class{orange}{1} & \\class{orange}{0} &  \\class{rouge}{0} & \\class{rouge}{0} & \\class{rouge}{1}&  \\class{vert}{1} & \\class{vert}{0} & \\class{vert}{0}\\\\\n\\end{pmatrix}}\\]"
  },
  {
    "objectID": "01_acm.html#poids-de-chaque-ligne",
    "href": "01_acm.html#poids-de-chaque-ligne",
    "title": "Analyse Correspondances Multiples",
    "section": "Poids de chaque ligne",
    "text": "Poids de chaque ligne\n\nOn associe à chaque “profil ligne” le poids \\(1/n\\),\n\nDans le formalisme vu en ACP, ceci correspond à la matrice \\(W = \\frac{1}{n} I_n\\)"
  },
  {
    "objectID": "01_acm.html#metrique-1",
    "href": "01_acm.html#metrique-1",
    "title": "Analyse Correspondances Multiples",
    "section": "Metrique",
    "text": "Metrique\n\nOn utilise la métrique de l’AFC\n\n\\[d(x_{i_1}, x_{i_2})^2 =\\sum_{k=1}^{m}  \\frac{1}{f_{+k}} \\left(x_{i_1k} - x_{i_2k} \\right)^2 =\\sum_{k=1}^{m}  \\frac{1}{p^2f_{+k}} \\left(z_{i_1k} - z_{i_2k} \\right)^2 \\]\nDans le formalisme matriciel de l’ACP ceci revient à définir la métrique\n\\(M = D_{1/f_{+ j}} = np\\Delta^{-1}\\)"
  },
  {
    "objectID": "01_acm.html#inertie-1",
    "href": "01_acm.html#inertie-1",
    "title": "Analyse Correspondances Multiples",
    "section": "Inertie",
    "text": "Inertie\nOn est conduit à trouver les valeurs propres de\n\\[(X M^{1/2})^\\top W (X M^{1/2})\\]\nou de manière équivalente celles de la matrice\n\\[VM = X^\\top W X M =   \\frac{1}{p}  Z^\\top \\frac{1}{n} I_n \\frac{1}{p} Z  np\\Delta^{-1} = \\left ( \\frac{1}{p} \\Delta^{-1}   B \\right )\\]\nComme dans le cas de l’ACP, L’inertie n’a pas d’intérêt en soi, on peut montrer qu’elle vaut toutefois :\n\\[ I = \\frac{m-p}{p} \\]\nCoordonnées du centre de gravité : \\[x_{\\bullet j} = \\sum_{i=1}^n w_i x_{ij} = \\frac{1}{n} \\sum_{i=1}^n \\frac{z_{ij}}{p}= \\frac{1}{n}  \\frac{k_{+j}}{p}\\]"
  },
  {
    "objectID": "01_acm.html#valeurs-propres",
    "href": "01_acm.html#valeurs-propres",
    "title": "Analyse Correspondances Multiples",
    "section": "Valeurs propres",
    "text": "Valeurs propres\n\nNotons \\(\\rho_1, \\ldots, \\rho_q\\) : Valeurs propres non triviales (i.e différentes de \\(0\\) ou \\(1\\)) de \\((\\frac{B\\Delta^{-1}}{p})^2\\) (AFC de \\(B\\)).\net \\(\\lambda_1, \\ldots, \\lambda_q\\) : Valeurs propres non triviales de \\((\\frac{B\\Delta^{-1}}{p})\\) (AFC de \\(Z\\)).\n\nPropriété :\n\\[\n\\rho_k = \\lambda_k^2,\n\\]\net les valeurs propres sont les mêmes.\nAinsi les axes construits par les deux AFC sont les mêmes, et à un changement d’échelle près on peut représenter individus et modalités sur le même graphique.\nDans les sorties de Rce sont les valeurs propres \\(\\lambda_k\\) qui sont fournies."
  },
  {
    "objectID": "01_acm.html#relation-de-transition",
    "href": "01_acm.html#relation-de-transition",
    "title": "Analyse Correspondances Multiples",
    "section": "Relation de transition",
    "text": "Relation de transition\nOn note\n\n\\(F_s(i)\\) les coordonnées de l’individu \\(i\\) (tableau disjonctif complet) sur l’axe \\(s\\)\n\\(G_s(j)\\) les coordonnées de la modalité \\(j\\) (tableaude Burt) sur l’axe \\(s\\)\n\nAlors\n\\[F_s(i) = \\frac{1}{\\lambda_s} \\sum_{j=1}^m \\frac{x_{ij}}{p} G_s(j)\\] \\[G_s(j) = \\frac{1}{\\lambda_s} \\sum_{i=1}^n \\frac{x_{ij}}{k_{+j}} F_s(j)\\]"
  },
  {
    "objectID": "01_acm.html#règles-pour-linterprétation",
    "href": "01_acm.html#règles-pour-linterprétation",
    "title": "Analyse Correspondances Multiples",
    "section": "Règles pour l’interprétation",
    "text": "Règles pour l’interprétation\n\nOn regarde l’éboulis des valaurs propres pour identifier le nombre d’axes pertinents.\n\nComme pour toutes les analyses factorielles, on interprète en\n\nregardant les individus/variables qui contribuent le plus aux axes\nlorsque l’on veut discuter de la position d’une variable ou d’un individu, on vérifie qu’il est bien représenté\npoids des variables (en fonction du nombre de modalités)\nApproche de test sur les différences entre modalités (dimdesc)"
  },
  {
    "objectID": "01_acm.html#démarche-danalyse",
    "href": "01_acm.html#démarche-danalyse",
    "title": "Analyse Correspondances Multiples",
    "section": "Démarche d’analyse",
    "text": "Démarche d’analyse\n\nQuelles Variables considérées pour la construction des axes\nQuels sont les axes pertinents à regarder\nComprendre les axes par les contributions\nInterpréter les positions des variables / des individus\nCreuser le lien entre deux types de variables avec une AFC (comme un zoom sur la relation entre deux variables)\nReprésenter les modalités supplémentaires – quel procédé ?\nDiscuter Ellipse de confiance (revu dans le dernier TD)\n\nLien vers le Script R"
  },
  {
    "objectID": "01_acm.html#a-nous-de-jouer",
    "href": "01_acm.html#a-nous-de-jouer",
    "title": "Analyse Correspondances Multiples",
    "section": "A nous de jouer",
    "text": "A nous de jouer"
  },
  {
    "objectID": "01_acm.html#synthèse",
    "href": "01_acm.html#synthèse",
    "title": "Analyse Correspondances Multiples",
    "section": "Synthèse",
    "text": "Synthèse\n\nL’AFC du tableau de Burt permet d’évaluer les liaisons globales entre les variables qualitatives.\nL’AFC du tableau disjonctif complet permet de représenter les individus et modalités dans le même espace factoriel."
  },
  {
    "objectID": "01_acm.html#applications",
    "href": "01_acm.html#applications",
    "title": "Analyse Correspondances Multiples",
    "section": "Applications",
    "text": "Applications\n\nÉtudes exploratoires pour des données qualitatives complexes.\nAnalyse de dépendances entre plusieurs variables qualitatives."
  },
  {
    "objectID": "01_acp.html#rappel-des-données-sur-les-manchots",
    "href": "01_acp.html#rappel-des-données-sur-les-manchots",
    "title": "Analyse en Composantes Principales",
    "section": "Rappel des données sur les manchots",
    "text": "Rappel des données sur les manchots\nDonnées disponibles dans le package palmerpenguins mises à disposition par le Dr. Kristen Gorman et the Palmer Station, Antarctica LTER.\nOn a mesuré les caractéristiques morphologiques de divers manchots :\n\n\nLes 6 premières lignes (parmi 333 )\n\n\n# A tibble: 333 × 4\n  bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1           39.1          18.7               181        3750\n2           39.5          17.4               186        3800\n3           40.3          18                 195        3250\n4           36.7          19.3               193        3450\n5           39.3          20.6               190        3650\n6           38.9          17.8               181        3625\n# ℹ 327 more rows\n\n\n\n\nbill_length_mm : la longueur du bec,\nbill_depth_mm : l’épaisseur du bec,\nflipper_length_mm : la longueur de la nageoire,\nbody_mass_g : le poids du corps.\n\n\nComment visualiser au mieux ces données pour faire apparaître les liens entre variables et identifier des resemblances entre individus ?"
  },
  {
    "objectID": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau",
    "href": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau",
    "title": "Analyse en Composantes Principales",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nIdée 1 : on représente les liens des variables 2 à 2"
  },
  {
    "objectID": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-1",
    "href": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-1",
    "title": "Analyse en Composantes Principales",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nIdée 1 : dangereuse"
  },
  {
    "objectID": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-2",
    "href": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-2",
    "title": "Analyse en Composantes Principales",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nObjectifs\n\nReprésenter sans perdre trop d’information,\nQuantifier la perte d’information,\nComprendre quelles sont les informations redondantes (variables liées),\nIdéalement des individus éloignés dans le nuage initial, restent éloignés dans la représentation\n\nDans toute la suite, sans perte de généralité, on va considérer que les variables sont centrées."
  },
  {
    "objectID": "01_acp.html#si-on-savait-faire-une-analyse-en-composantes-principales",
    "href": "01_acp.html#si-on-savait-faire-une-analyse-en-composantes-principales",
    "title": "Analyse en Composantes Principales",
    "section": "Si on savait faire une Analyse en Composantes Principales",
    "text": "Si on savait faire une Analyse en Composantes Principales\n\nDans R on feraitReprésentation des individusReprésentation des variablesVisualisation par ACP\n\n\n\n\nlibrary(FactoMineR)\ndta &lt;- penguins %&gt;% select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g) \npenguins.PCA &lt;- PCA(X = dta, ncp = 4, graph = FALSE)\n\n\n\n\n\nL’ACP permet de trouver la projection en 2 dimensions qui préserve au mieux l’information contenue dans le nuage de points (avec peu de déformation).\n\n\nplot(penguins.PCA, choix = \"ind\")\n\n\n\n\n\n\n\n\n\nReste à comprendre\n\nComment quantifier l’information contenue dans un nuage de points\nComment est construite cette meilleure projection\nQuels sont les individus bien représentés ?\n\n\n\nL’ACP définit de nouvelles variables, les composantes principales qui sont une combinaison linéaire des anciennes variables. On peut représenter les variables dans le premier plan de l’ACP.\n\n\nplot(penguins.PCA, choix = \"var\")\n\n\n\n\n\n\n\n\n\nReste à comprendre\n\nComment interpréter cette représentation ?\nQuelles sont les variables bien représentées ?\nQue peut-on déduire de ce graphique sur le lien entre les variables.\nComment lier graphique des individus et graphique des variables"
  },
  {
    "objectID": "01_acp.html#mise-en-forme-des-données",
    "href": "01_acp.html#mise-en-forme-des-données",
    "title": "Analyse en Composantes Principales",
    "section": "Mise en forme des données",
    "text": "Mise en forme des données\nL’ACP s’applique à des données quantitatives sous forme de tableau. Ce tableau est composé de n individus (lignes) et de p variables (colonnes).\nDans la suite on va noter \\({\\boldsymbol{X}}\\) la matrice des données, \\({\\boldsymbol{X}}\\in {\\mathbb{R}}^{n\\times p}\\).\n\\(x_{\\class{alea}{i}\\class{orange}{j}}\\) est la valeur de la variable \\(\\class{orange}{j}\\) mesurée pour l’individu \\(\\class{alea}{i}.\\)\n\\[{\\boldsymbol{X}}= \\overset{\\color{orange}{\\begin{matrix}var_1& \\ldots \\ &  \\ \\ldots \\ &\\  \\ldots\\  & \\  var_p \\end{matrix}}}{\\begin{pmatrix}\nx_{\\class{alea}{1}}^{\\class{orange}{1}} &  \\ldots &  \\ldots &\\ldots &  x_{\\class{alea}{1}}^{\\class{orange}{p}}\\\\\n\\vdots & & &  &\\vdots \\\\\n& &  x_{\\class{alea}{i}}^{\\class{orange}{j}} & & \\\\\n\\vdots & & & & \\vdots \\\\\nx_{\\class{alea}{n}}^{\\class{orange}{1}} & & & & \\ldots x_{\\class{alea}{n}}^{\\class{orange}{p}}\\\\\n\\end{pmatrix}}\\]"
  },
  {
    "objectID": "01_acp.html#deux-points-de-vue-complémentaires",
    "href": "01_acp.html#deux-points-de-vue-complémentaires",
    "title": "Analyse en Composantes Principales",
    "section": "Deux points de vue complémentaires",
    "text": "Deux points de vue complémentaires\n\n\nLe nuage des individus \\(C^n\\)\nOn peut considérer qu’un individu \\(i\\) est un vecteur \\(\\class{alea}{\\boldsymbol{x}_{i}}\\) dans un espace de dimension \\(p\\). Par convention tous les vecteurs sont des vecteurs colonnes, donc on peut écrire\n\\[{\\boldsymbol{X}}=\\begin{pmatrix}\n\\class{alea}{\\boldsymbol{x}_{1}}^\\top\\\\\n\\vdots \\\\\n\\class{alea}{\\boldsymbol{x}_{n}}^\\top\\\\\n\\end{pmatrix},\\]\nL’ensemble des \\(n\\) vecteurs forme le nuage des individus (ce qu’on représente classiquement).\n\n\n\n\n\n\n\n\n\n\nLe nuage des variables \\(C^p\\)\nOn peut considérer qu’une variable \\(j\\) est un vecteur \\(\\class{orange}{\\boldsymbol{x}^{j}}\\) dans un espace de dimension \\(n\\) et on peut écrire\n\\[{\\boldsymbol{X}}=\\begin{pmatrix}\n\\class{orange}{\\boldsymbol{x}^{1}} & \\ldots & \\class{orange}{\\boldsymbol{x}^{p}}\n\\end{pmatrix},\\]\nL’ensemble des \\(p\\) vecteurs forme le nuage des variables.\n\n\n\n\n\n\n\n\n\n\n\nBien sûr les deux nuages sont intimement liés"
  },
  {
    "objectID": "01_acp.html#linertie-par-rapport-à-un-point",
    "href": "01_acp.html#linertie-par-rapport-à-un-point",
    "title": "Analyse en Composantes Principales",
    "section": "L’inertie par rapport à un point",
    "text": "L’inertie par rapport à un point\n\n\n\nDefinition 1\n\n\nL’inertie par rapport à un point \\(a \\in {\\mathbb{R}}^{p}\\) est définie par\n\\[I_{\\boldsymbol{a}} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{a}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -a^k)^2\\]\n\n\n\n\nIntuitivementRéponseThéorème de Huyghens\n\n\nL’inertie par rapport à un point quantifie l’information perdue lorsque le jeu de données est résumé par ce point.\nQuel est selon vous le point \\(\\boldsymbol{a}\\) qui minimise l’inertie ?\n\\[argmin_{\\boldsymbol{a}} I_{\\boldsymbol{a}} = ??\\]\n\n\nBINGO !!!\nIl s’agit du point \\(\\boldsymbol{g}=\\boldsymbol{x_{\\bullet}}=({x}_{\\bullet}^1, \\ldots, {x}_{\\bullet}^p )^\\top,\\) avec \\({x}_{\\bullet}^k=\\frac{1}{n} \\sum_{i=1}^n x_{i}^k\\), la valeur moyenne de la variable \\(k\\) sur l’ensemble des individus.\nPuisque nous avons supposé que nos variables étaient centrées, \\(G=O\\) l’origine sur repère.\n\n\n\\[\\forall \\boldsymbol{a}\\in\\mathbb{R}^p,\\; I_\\boldsymbol{a}=I_\\boldsymbol{g} + \\lVert\\boldsymbol{a}- \\boldsymbol{g}\\rVert^2.\\]\nConséquence\nLe meilleur résumé du nuage de points se résumant à un point est le barycentre du nuage de points, c’est à dire la moyenne sur chacune des dimensions.\n\n\n\n\nRemarque\n\\[I_{\\boldsymbol{g}} = I = \\frac{1}{n}  \\sum_{i=1}^n     \\left( \\sum_{k=1}^p \\left( x_{i}^k - x_{\\bullet}^k  \\right)^2 \\right)  = \\sum_{k=1}^p  \\left( \\frac{1}{n}  \\sum_{i=1}^n  \\left( x_{i}^k - x_{\\bullet}^k  \\right)^2 \\right)  = \\sum_{k=1}^p  Var(\\boldsymbol{x}^{k})\\] Si les variables sont réduites\n\\[I = p\\]"
  },
  {
    "objectID": "01_acp.html#linertie-par-rapport-à-un-axe",
    "href": "01_acp.html#linertie-par-rapport-à-un-axe",
    "title": "Analyse en Composantes Principales",
    "section": "L’inertie par rapport à un axe",
    "text": "L’inertie par rapport à un axe\n\n\n\nDefinition 2\n\n\nL’inertie par rapport à l’axe \\(\\Delta\\) est définie par \\[I_{\\boldsymbol{\\Delta}} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{p_i}^{\\Delta}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -p^{k,\\Delta}_i)^2, \\quad \\mbox{où }\\  \\boldsymbol{p_i}^{\\Delta} \\mbox{projeté orthogonal de } \\boldsymbol{x_i} \\mbox{ sur }\\Delta.\\]\n\n\n\n\nIntuitivementQue veut-on faire ?Rappel projection orthogonale\n\n\n\n\nL’inertie par rapport à l’axe \\(\\Delta\\) quantifie l’information perdue lorsque l’on résume le nuage de points à son projeté sur \\(\\Delta\\).\n\n\n\n\n\n\n\n\n\n\n\n\n\nIdentifier \\(\\Delta\\) tel que \\(I_{\\Delta}\\) soit minimale\nCe qui revient à l’axe \\(\\Delta\\) qui assure que la projection sur \\(\\Delta\\) déforme le moins possible le nuage de points.\nDans le cadre de l’ACP, on veut construire une ensemble d’axes orthogonaux (une nouvelle base de \\({\\mathbb{R}}^p\\)), de façon à ce que\n\nla projection sur le premier axe, soit le meilleur résumé du nuage de points en une dimension,\nle deuxième axe est orthogonal au premier et représente “le deuxième meileur choix” …. dans un sens que l’on va définir\nle troisième …\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nProduit scalaire : Soient deux élements \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) de \\(\\mathbb{R}^p\\), le produit scalaire est noté \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt;\\) et \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt;=\\sum_{i=1}^p x_i y_i = \\boldsymbol{x}^\\top \\boldsymbol{y}.\\)\nOrthogonalité Soient deux élements \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) de \\(\\mathbb{R}^p\\), on dit que \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) sont orthogonaux (noté \\(\\boldsymbol{x}\\perp \\boldsymbol{y}\\)) si \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt; = \\boldsymbol{x}^\\top  \\boldsymbol{y}=0\\).\nProjection orthogonale On note \\(\\boldsymbol{a}_u\\) le projeté de \\(\\boldsymbol{a}\\) sur la droite \\(\\Delta\\) définit par son vecteur directeur unitaire \\(\\boldsymbol{u}\\) et passant par l’origine \\[\\boldsymbol{a}_u = &lt; \\boldsymbol{a}, \\boldsymbol{u} &gt; \\boldsymbol{u} = (\\boldsymbol{a}^\\top \\boldsymbol{u})\\,  \\boldsymbol{u}.\\] Le vecteur \\(\\boldsymbol{a_u}\\) est orthogonal à \\(\\boldsymbol{a}-\\boldsymbol{a_u}\\): \\[&lt; \\boldsymbol{a_u}, \\boldsymbol{a}-\\boldsymbol{a_u}&gt; = \\left ((\\boldsymbol{a}^\\top \\boldsymbol{u}) \\boldsymbol{u}\\right)^\\top \\left ( \\boldsymbol{a} -  (\\boldsymbol{a}^\\top \\boldsymbol{u})\\,  \\boldsymbol{u} \\right)=(\\boldsymbol{a}^\\top \\boldsymbol{u}) (\\boldsymbol{u}^\\top \\boldsymbol{a}) - (\\boldsymbol{a}^\\top \\boldsymbol{u})^2 \\boldsymbol{u}^\\top \\boldsymbol{u} =0  \\]"
  },
  {
    "objectID": "01_acp.html#linertie-par-rapport-à-un-sous-espace-affine",
    "href": "01_acp.html#linertie-par-rapport-à-un-sous-espace-affine",
    "title": "Analyse en Composantes Principales",
    "section": "L’inertie par rapport à un sous espace affine",
    "text": "L’inertie par rapport à un sous espace affine\n\nEspace orthogonal Soit \\(E\\) un sous-espace vectoriel de \\(\\mathbb{R}^p\\). On definit \\(E^\\perp=\\{\\boldsymbol{x}\\in \\mathbb{R}^p:\\; \\forall \\boldsymbol{y}\\in E,\\; \\boldsymbol{x}\\perp \\boldsymbol{y}\\}\\).\n\n\nExempleSolution\n\n\nDans \\({\\mathbb{R}}^2\\), on considère le sous espace vectoriel \\(E\\), tel que \\[ E =\\left \\lbrace  \\boldsymbol{x}=\\begin{pmatrix} x_1 &  x_2 \\end{pmatrix}^\\top \\in {\\mathbb{R}}^2 : x_1 = x_2  \\right \\rbrace \\] \\(E\\) est la droite d’équation \\(y=x\\).\nQui est \\(E^\\perp\\) ?\n\n\nSoit \\(\\boldsymbol{y}\\in E^\\perp,\\) alors\n\\[\\begin{align}\n0 & = \\boldsymbol{x}^\\top \\boldsymbol{y}\\\\\n  & = \\begin{pmatrix} x_1 &  x_2 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\  y_2 \\end{pmatrix}\\\\\n  & = x_1 y_1 + x_2 y_2 \\\\\n  & = x_1 (y_1 + y_2) \\quad (\\boldsymbol{x}\\in E \\Rightarrow x_1 =x_2) \\\\\n\\end{align}\\]\n\\[E^\\perp =  \\left \\lbrace  \\boldsymbol{y}=\\begin{pmatrix} y_1 &  y_2 \\end{pmatrix}^\\top \\in {\\mathbb{R}}^2 : y_1 + y_2 = 0 \\right \\rbrace  \\]\n\n\n\n\n\n\n\nDefinition 3\n\n\nL’inertie par rapport à un sous espace vectoriel \\(E\\) est définie par \\[I_{E} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{p_i}^{E}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -p^{k,E}_i)^2, \\quad \\mbox{où }\\  \\boldsymbol{p_i}^{E} = argmin_{\\boldsymbol{y}\\in E} d(\\boldsymbol{y}, \\boldsymbol{x}_{i}), \\mbox{i.e. projeté orthogonal de } \\boldsymbol{x_i} \\mbox{ sur }E.\\]\n\n\n\nC’est l’inertie perdue lorsque l’on résume le nuage de points à sa projection sur le sous espace \\(E\\)."
  },
  {
    "objectID": "01_acp.html#décomposition-de-linertie",
    "href": "01_acp.html#décomposition-de-linertie",
    "title": "Analyse en Composantes Principales",
    "section": "Décomposition de l’inertie",
    "text": "Décomposition de l’inertie\n\nSoit \\(E\\) un sous espace vectoriel de \\({\\mathbb{R}}^p\\), alors \\[I = I_E + I_{E^\\perp}.\\]\n\nPreuve\n\n\nUn dessin vaut mieux qu’un long discours et Pythagore est ton ami !\n\\[d(\\class{alea}{\\boldsymbol{x}_{i}}, O)^2 = d(\\boldsymbol{x}_{i}, \\class{bleu}{\\boldsymbol{x}_{i}^E})^2  +  d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{rouge}{\\boldsymbol{x}_{i}^{E^\\perp}})^2.\\]\n\\[\\begin{align}\nI & = \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, O)^2 \\\\\n   & = \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{bleu}{\\boldsymbol{x}_{i}^E})^2   +  \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{rouge}{\\boldsymbol{x}_{i}^{E^\\perp}})^2 \\\\\n   & = \\class{bleu}{I_E} + \\class{rouge}{I_{E^\\perp}}\n\\end{align}\\]"
  },
  {
    "objectID": "01_acp.html#principe-de-la-décomposition-à-venir",
    "href": "01_acp.html#principe-de-la-décomposition-à-venir",
    "title": "Analyse en Composantes Principales",
    "section": "Principe de la décomposition à venir",
    "text": "Principe de la décomposition à venir\n\nIdentifier le vecteur \\(\\boldsymbol{u_1}\\) de \\({\\mathbb{R}}^p\\), tel que \\(I_{E_1}\\) soit minimale avec \\(E_1=\\left \\lbrace \\lambda \\boldsymbol{u_1}, \\lambda \\in {\\mathbb{R}}\\right\\rbrace,\\)\nDans \\(E_1^\\perp\\), identifier le vecteur \\(\\boldsymbol{u_2}\\) de \\({\\mathbb{R}}^p\\), tel que \\(I_{E_2}\\) soit minimale avec \\(E_2=\\left \\lbrace \\lambda \\boldsymbol{u_2}, \\lambda \\in {\\mathbb{R}}\\right\\rbrace,\\)\nDans \\(\\left (  E_1 \\oplus E_2 \\right)^\\perp\\), identifier le vecteur \\(\\boldsymbol{u_3}\\) de \\({\\mathbb{R}}^p\\), tel que ….\n\n…\nFinalement on aura la décomposition\n\\[I= I_{E_1} + I_{E_2} + \\ldots + I_{E_p}, \\quad \\mbox{avec } I_{E_1} \\leq I_{E_2} \\leq \\ldots \\leq I_{E_p}\\]"
  },
  {
    "objectID": "01_acp.html#se-donner-des-intuitions",
    "href": "01_acp.html#se-donner-des-intuitions",
    "title": "Analyse en Composantes Principales",
    "section": "Se donner des intuitions",
    "text": "Se donner des intuitions"
  },
  {
    "objectID": "01_acp.html#se-donner-des-intuitions-1",
    "href": "01_acp.html#se-donner-des-intuitions-1",
    "title": "Analyse en Composantes Principales",
    "section": "Se donner des intuitions",
    "text": "Se donner des intuitions"
  },
  {
    "objectID": "01_acp.html#identifier-boldsymbolu_1---formalisation",
    "href": "01_acp.html#identifier-boldsymbolu_1---formalisation",
    "title": "Analyse en Composantes Principales",
    "section": "Identifier \\(\\boldsymbol{u_1}\\) - Formalisation",
    "text": "Identifier \\(\\boldsymbol{u_1}\\) - Formalisation\n\n\n\nOn cherche \\(\\boldsymbol{u_1}\\) tel que \\(I_{u_1}\\) soit minimale mais \\(I_{u_1} + I_{u_1^\\perp}=I\\). Minimiser \\(I_{u_1}\\) revient à maximiser \\(I_{u_1^\\perp}\\), i.e l’inertie du nuage projeté.\n\nLe premier individu se projette en \\(\\class{alea}{x_{1}}^\\top \\boldsymbol{u_1}\\) sur \\(\\boldsymbol{u_1}\\)\nLe deuxième individu se projette en \\(\\class{alea}{x_{2}}^\\top \\boldsymbol{u_1}\\) sur \\(\\boldsymbol{u_1}\\)\n…\n\nOn rappelle que \\[{\\boldsymbol{X}}= \\begin{pmatrix} \\class{alea}{x_{1}}^\\top \\\\ \\vdots \\\\ \\class{alea}{x_{n}}^\\top \\end{pmatrix}.\\] La projection de l’individu \\(i\\) est obtenue en multipliant le vecteur ligne \\(\\class{alea}{x_{1}}^\\top\\) par \\(\\boldsymbol{u_1}\\). Le vecteur des coordonnées sur \\(\\boldsymbol{u_1}\\) pour chaque individu est\n\n\\[\\begin{pmatrix} \\class{alea}{x_{1}}^\\top \\boldsymbol{u_1} \\\\ \\vdots \\\\ \\class{alea}{x_{n}}^\\top \\boldsymbol{u_1} \\end{pmatrix} = X  \\boldsymbol{u_1}.\\]\n\nMaximiser \\(I_{u_1^\\perp}\\)\nsous la contrainte \\(\\lVert\\boldsymbol{u_1}\\rVert\\) \\[\\begin{align}\nI_{u_1^\\perp} & = \\frac{1}{n}\\lVert X  \\boldsymbol{u_1}\\rVert^2 \\\\\n        & = \\frac{1}{n} (X  \\boldsymbol{u_1})^\\top (X  \\boldsymbol{u_1})\\\\\n        & =   \\boldsymbol{u_1}^\\top \\left (\\frac{1}{n} X^\\top X \\right)  \\boldsymbol{u_1}\n\\end{align}\\]\n\nRemarqueCe que ça signifie\n\n\n\n\\(\\frac{1}{n} X^\\top X\\) est la matrice de covariance, on écrit souvent \\(\\frac{1}{n} X^\\top X\\) sous la forme \\(X^\\top W X\\) (\\(W\\) est une matrice diagonale, dont chaque terme diagonal vaut \\(1/n\\), \\(W_{ii}\\) est le poids attribué à l’observation \\(i\\)).\n\\(X^\\top W X\\) est symétrique et définie positive donc diagonalisable.\nIl existe une matrice \\(P\\) unitaire \\(P^\\top P = I_p,\\) et \\(D\\) une matrice diagonale telle que \\[X^\\top W X = P D P^\\top.\\]\nLes termes diagonaux de \\(D\\) sont les valeurs propres, toutes positives, de \\(X^\\top W X\\) rangées par odre décroissant, \\(\\lambda_1 &gt; \\lambda_1 \\ldots &gt;\\lambda_p\\) et \\(U\\) est la matrice des vecteurs propres associés.\n\n\n\n\n\\(\\boldsymbol{b}\\) est une base orthonormale, la base formée par les vecteurs propres de \\(X^\\top W X\\)."
  },
  {
    "objectID": "01_acp.html#identifier-les-directions-principales",
    "href": "01_acp.html#identifier-les-directions-principales",
    "title": "Analyse en Composantes Principales",
    "section": "Identifier les directions principales",
    "text": "Identifier les directions principales\nChercher \\(\\boldsymbol{u_1}\\) tel que \\(I_{u_1^\\perp}\\) soit maximale\nEn se plaçant dans la nouvelle base, posons \\(\\boldsymbol{v_1} = P^\\top \\boldsymbol{u_1},\\) \\(\\lVert\\boldsymbol{v_1}\\rVert=1\\):\nMaximiser \\(\\boldsymbol{v_1}^\\top D \\boldsymbol{v_1} = \\sum_{k=1}^p v_{1p}^2 \\lambda_p\\), sous la contrainte \\(\\sum_{k=1}^p  v_{1p}^2=1\\)\n\\[\\boldsymbol{v_1} = (1, 0, \\ldots, 0)^\\top, \\quad \\boldsymbol{u_1} = P \\boldsymbol{v_1} = \\begin{pmatrix} P_{11} \\\\ \\vdots \\\\P_{p1} \\end{pmatrix}.\\]\n\\(\\boldsymbol{u_1}\\) est le premier vecteur propre de \\(X^\\top W X\\). (la matrice de covariance).\nChercher \\(\\boldsymbol{u_2}\\)\nOn cherche \\(\\boldsymbol{u_2}\\perp \\boldsymbol{u_1}\\), tel que \\(\\boldsymbol{u_2}^\\top X^\\top W X   \\boldsymbol{u_2}\\) soit maximale.\nPosons \\(\\boldsymbol{v_2} = P^\\top \\boldsymbol{u_2},\\) \\(\\lVert\\boldsymbol{v_2}\\rVert=1\\): Maximiser \\(\\boldsymbol{v_2}^\\top D \\boldsymbol{v_2} = \\sum_{k=1}^p v_{2p}^2 \\lambda_p\\), sous la contrainte \\(\\sum_{k=1}^p  v_{1p}^2=1\\) et \\(v_{1p}=0\\) pour assurer l’orthogonalité avec \\(\\boldsymbol{v_1}\\)\n\\[\\boldsymbol{v_2} = (0, 1, \\ldots, 0)^\\top, \\quad \\boldsymbol{u_2} = P \\boldsymbol{v_2} = \\begin{pmatrix} P_{12} \\\\ \\vdots \\\\U_{p2} \\end{pmatrix}.\\]\n\\(\\boldsymbol{u_2}\\) est le deuxième vecteur propre de de \\(X^\\top W X\\)."
  },
  {
    "objectID": "01_acp.html#mesurer-linformation-préservée-par-projection",
    "href": "01_acp.html#mesurer-linformation-préservée-par-projection",
    "title": "Analyse en Composantes Principales",
    "section": "Mesurer l’information préservée par projection",
    "text": "Mesurer l’information préservée par projection\nSur un axe principal\n\nLorsque l’on résume le nuage à sa projection sur un axe factoriel \\(\\boldsymbol{u_k}\\), on ne garde que l’information associée à cet axe soit \\(I_{\\boldsymbol{u_k}^\\perp}=\\lambda_k\\).\nLa quantité d’information préservée par projection sur l’axe \\(k\\) est donc \\(\\lambda_k\\).\nLa part d’information portée par l’axe \\(k\\) est donnée par \\(\\displaystyle\\frac{\\lambda_k}{\\sum_{k=1}^p\\lambda_k}\\)\n\nSur un axe principal\n\nL’inertie du nuage projeté sur plan \\(k_1, k_2\\) est donnée par \\[\\lambda_{k_1} +\\lambda_{k_2}\\]\nLa part d’information portée par le plan \\(k_1, k_2\\) est donnée par \\[\\frac{\\lambda_{k_1} +\\lambda_{k_2}}{\\sum_{k=1}^p\\lambda_k}\\]"
  },
  {
    "objectID": "01_acp.html#attention-aux-unités---illustration-sur-les-données-de-manchots",
    "href": "01_acp.html#attention-aux-unités---illustration-sur-les-données-de-manchots",
    "title": "Analyse en Composantes Principales",
    "section": "Attention aux unités - Illustration sur les données de manchots",
    "text": "Attention aux unités - Illustration sur les données de manchots\n\n\nlibrary(FactoMineR)\n\npenguins.PCA &lt;- PCA(X = penguins, \n                    scale.unit = FALSE, ## should we scale the data ?\n                    ncp = 4, ## number of components : as many as initial variables\n                    graph = FALSE, ## no graph right now\n                    quali.sup = c(1, 2, 7,8)) ## to indicate the column number of qualitative variable\npenguins.PCA$eig\n\npenguins.PCA$svd$V ## what is named P in the lecture\n\n\n         eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 6.465859e+05           9.998932e+01                          99.98932\ncomp 2 5.058345e+01           7.822325e-03                          99.99715\ncomp 3 1.610647e+01           2.490736e-03                          99.99964\ncomp 4 2.353778e+00           3.639929e-04                         100.00000\n             [,1]        [,2]        [,3]          [,4]\n[1,]  0.004003162  0.31927773  0.94126475 -0.1098470736\n[2,] -0.001154327 -0.08684753  0.14449479  0.9856862728\n[3,]  0.015194547  0.94354238 -0.30518986  0.1278908060\n[4,]  0.999875876 -0.01571702  0.00103611 -0.0003657482\n\n\nLa dispersion du nuage projeté sur le premier axe représente \\(6.45 10^5\\) en terme d’inertie soit \\(99.98%\\) de l’inertie totale.\n\nTrop beau pour être vrai ?\nRéfléchissons aux données, ce qui est crucial dans toutes analyses de données.\n\n\npenguins %&gt;% \n  summarise(across(where(is.numeric), list(mean = mean, sd= sd)))  |&gt; \n  pivot_longer(cols = everything(),  names_to = c(\"Var\", \"Resume\"), \n      names_pattern = \"(.*)_(mean|sd)\") |&gt; \n  pivot_wider(names_from = Resume,values_from = value)\n\n\n# A tibble: 4 × 3\n  Var                 mean     sd\n  &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;\n1 bill_length_mm      44.0   5.47\n2 bill_depth_mm       17.2   1.97\n3 flipper_length_mm  201.   14.0 \n4 body_mass_g       4207.  805.  \n\n\n\n\nLes variables ont des ordres de grandeur variable.\nLa contribution à la distance entre individu de la variable Massest plus importante que celle de la variable bill_length_mm.\nEst-ce souhaitable ?"
  },
  {
    "objectID": "01_acp.html#attention-aux-unités---illustration-sur-les-données-de-manchots-normalisées",
    "href": "01_acp.html#attention-aux-unités---illustration-sur-les-données-de-manchots-normalisées",
    "title": "Analyse en Composantes Principales",
    "section": "Attention aux unités - Illustration sur les données de manchots normalisées",
    "text": "Attention aux unités - Illustration sur les données de manchots normalisées\n\n\npenguins.PCA &lt;- PCA(X = penguins, \n                    scale.unit = TRUE, ## should we scale the data,\n                    ncp = 4, ## number of components : as many as initial variables\n                    graph = FALSE, ## no graph right now\n                    quali.sup = c(1, 2, 7,8)) ## to indicate the column number of qualitative variable\npenguins.PCA$eig\n\npenguins.PCA$svd$V ## what is named P in the lecture\n\n\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1  2.7453557              68.633893                          68.63389\ncomp 2  0.7781172              19.452929                          88.08682\ncomp 3  0.3686425               9.216063                          97.30289\ncomp 4  0.1078846               2.697115                         100.00000\n           [,1]       [,2]       [,3]       [,4]\n[1,]  0.4537532 0.60019490 -0.6424951 -0.1451695\n[2,] -0.3990472 0.79616951  0.4258004  0.1599044\n[3,]  0.5768250 0.00578817  0.2360952  0.7819837\n[4,]  0.5496747 0.07646366  0.5917374 -0.5846861\n\n\nOn a centré réduit les variables pour les rendre comparables et leur donner la même importance.\nDans ce cas l’inertie totale est le nombre de variables (voir remarque Section 3.1.1)\nLorsque l’on veut s’abstraire des unités, on centre te on réduit les données pour réaliser une ACP normée."
  },
  {
    "objectID": "01_acp.html#choix-de-la-distance",
    "href": "01_acp.html#choix-de-la-distance",
    "title": "Analyse en Composantes Principales",
    "section": "Choix de la distance",
    "text": "Choix de la distance\nL’ACP normée (ACP sur les données centrées et réduites) peut-être envisagée comme une ACP avec une autre distance que la distance euclidienne.\nUne autre manière de présenter la même approche est de dire qu’on change la métrique utilisée\n\n\n\nDefinition (métrique)\n\n\nUne métrique \\(M\\) permet de définir une distance entre les observations (ainsi, M est une matrice de \\({\\mathbb{R}}^p\\times{\\mathbb{R}}^p\\) symétrique, définie et positive).\n\n\n\nCalcul de distance\nSoient \\(\\boldsymbol{x}_1 \\in {\\mathbb{R}}^p\\) et \\(\\boldsymbol{x}_é\\in{\\mathbb{R}}^p\\), la distance entre \\(\\boldsymbol{x}_1\\) et \\(\\boldsymbol{x}_2\\)pour la métrique \\(M\\) est \\[d_M(\\boldsymbol{x}_1, \\boldsymbol{x}_2)^2= \\lVert\\boldsymbol{x}_1 - \\boldsymbol{x}_2\\rVert_M^2 = (\\boldsymbol{x}_1 - \\boldsymbol{x}_2)^\\top M (\\boldsymbol{x}_1 - \\boldsymbol{x}_2).\\]\n\nExemple \\(I_p\\)Distance normalisant les variables\n\n\nSi \\(M= I_p\\),\n\\[d_M(\\boldsymbol{x}_1, \\boldsymbol{x}_2)^2= \\lVert\\boldsymbol{x}_1 - \\boldsymbol{x}_2\\rVert_M^2 = (\\boldsymbol{x}_1 - \\boldsymbol{x}_2)^\\top I_p (\\boldsymbol{x}_1 - \\boldsymbol{x}_2) =\\sum_{k=1}^p (x_{1k}-x_{2k})^2.\\]\n\n\nSi \\(M\\) est diagonale est \\(M_{ii}= 1/ s_i^2\\) où \\(s_i^2\\) est la variance de la variable \\(i\\),\n\\[d_M(\\boldsymbol{x}_1, \\boldsymbol{x}_2)^2=  (\\boldsymbol{x}_1 - \\boldsymbol{x}_2)^\\top M (\\boldsymbol{x}_1 - \\boldsymbol{x}_2) =\\sum_{k=1}^p \\frac{(x_{1k}-x_{2k})^2}{s_k^2}=\\sum_{k=1}^p \\left ( \\frac{x_{1k}}{s_k}-\\frac{x_{2k}}{s_k} \\right)^2.\\]\nDans une ACP normée on s’intéresse donc aux valeurs propres de la matrice \\(X^\\top M W X,\\) il s’agit de la matrice de corrélation."
  },
  {
    "objectID": "01_acp.html#représentation-des-individus---composantes-principales",
    "href": "01_acp.html#représentation-des-individus---composantes-principales",
    "title": "Analyse en Composantes Principales",
    "section": "Représentation des individus - Composantes principales",
    "text": "Représentation des individus - Composantes principales\n\n\n\nDefinition (Composantes principales)\n\n\nLes coordonnées des \\(n\\) observations sur les \\(p\\) axes factoriels sont groupées dans la matrice \\(C\\): \\(c_{ik}\\) est la coordonnée de l’observation \\(i\\) sur l’axe \\(\\Delta_{\\boldsymbol{u_k}}\\). La \\(k\\)-ème composante principale est la colonne \\(k\\) de la matrice \\(C\\), notée \\(C^k\\). \\[\nC = [\\class{orange}{C^1} | \\ldots | \\class{orange}{C^p}] \\text{ avec } \\class{orange}{C^k}=\\begin{pmatrix}\nc_{1k}\\\\\n\\vdots\\\\\nc_{nk}\n\\end{pmatrix}.\n\\]\n\n\n\n\nVectoriellementVisuellementRemarques\n\n\nOn a les expressions suivantes \\[\nC^k=Xu_k \\mbox{ et } C=XP,\n\\] où \\(P\\) désigne la matrice de changement base, i.e la matrice contenant les vecteurs propres.\n\n\n\n\n\n\nLes \\(C^k\\) sont des combinaisons linéaires des variables de départ.\nElles sont centrées, de variance \\(\\lambda_k=\\sum_{i=1}^n p_i c_{ik}^2\\) et non-corrélées 2 à 2.\nLes \\(C^k\\) sont vecteurs propres de \\(XX^\\top\\) de valeur propre \\(\\lambda_k\\)."
  },
  {
    "objectID": "01_acp.html#représentation-des-manchots",
    "href": "01_acp.html#représentation-des-manchots",
    "title": "Analyse en Composantes Principales",
    "section": "Représentation des manchots",
    "text": "Représentation des manchots\n\n\nX &lt;- penguins |&gt; \n  mutate(year = as.factor(year))|&gt;  ## year willnot be considered as numerical variable\n  select(where(is.numeric)) |&gt;      ## select all numeric columns\n  mutate_all(list(scale2)) |&gt;          ## and scale them\n  as.matrix()\n\nn &lt;- nrow(X) # number of individuals\nd &lt;- ncol(X)\n\npenguins_svd &lt;- svd( 1/n * t(X)%*% X ) # to get P and D from t(X)WX\n\n## eigenvalues\npenguins_eigenvalue &lt;- penguins_svd$d\n\nP &lt;- penguins_svd$v\ncp &lt;- X %*% P\nhead(cp[, 1:2])\ncat(\"\\n\")\nhead(penguins.PCA$ind$coord[,1:2])\n\n#plot(penguins.PCA, choix = \"ind\", axes = c(1,2),invisible=c('ind.sup'),label =c('ind') )\nlibrary(factoextra)\nfviz_pca_ind(penguins.PCA, label=\"none\", addEllipses=FALSE)\n\n\n\n\n\n\n\n\n\n         [,1]        [,2]\n[1,] 1.853593 -0.03206938\n[2,] 1.316254  0.44352677\n[3,] 1.376605  0.16123048\n[4,] 1.885288  0.01235124\n[5,] 1.919981 -0.81759813\n[6,] 1.773020  0.36622296\n\n      Dim.1       Dim.2\n1 -1.853593  0.03206938\n2 -1.316254 -0.44352677\n3 -1.376605 -0.16123048\n4 -1.885288 -0.01235124\n5 -1.919981  0.81759813\n6 -1.773020 -0.36622296"
  },
  {
    "objectID": "01_acp.html#qualité-de-la-représentation-dun-individu",
    "href": "01_acp.html#qualité-de-la-représentation-dun-individu",
    "title": "Analyse en Composantes Principales",
    "section": "Qualité de la représentation d’un individu",
    "text": "Qualité de la représentation d’un individu\n\nMême avec ces précautions, on déforme le nuage de points\nCertains sont plus déformés que d’autre, il faut les identifier\n\nUn individu est d’autant moins déformé qu’il est proche du plan sur lequel on le projette, ce qui est donné par l’angle entre le vecteur initial et le vteur projeté\n\n\n\n\n\n\n\n\n\n\n\n\n\\[\\begin{align}\n&lt;\\class{alea}{x_i}, \\boldsymbol{u_1}&gt; &= \\lVert\\class{alea}{x_i}\\rVert \\lVert\\boldsymbol{u_1}\\rVert cos(\\theta_i) \\\\\n& = \\class{alea}{x_i}^\\top \\boldsymbol{u_1}, \\quad \\left( \\text{ou } \\class{alea}{x_i}^\\top M \\boldsymbol{u_1}  \\text{avec une autre métrique} \\right) \\\\\n\\end{align}\\]\n\\[\\cos^2(\\theta_i) = \\frac{(\\class{alea}{x_i}^\\top \\boldsymbol{u_1})^2}{\\lVert\\class{alea}{x_i}\\rVert^2}\\]\n\nInterprétation: plus \\(\\cos^2(\\theta_i)\\) est proche de \\(1\\), mieux l’individu est représenté."
  },
  {
    "objectID": "01_acp.html#contribution-dun-individu-à-la-définition-de-laxe",
    "href": "01_acp.html#contribution-dun-individu-à-la-définition-de-laxe",
    "title": "Analyse en Composantes Principales",
    "section": "Contribution d’un individu à la définition de l’axe",
    "text": "Contribution d’un individu à la définition de l’axe\n\nLes individus sont plus ou moins important dans la définition des axes\n\n\nIntuitivementFormellement\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuels sont les points qui vont le plus contribuer à la détermination des axes ?\n\n\n\nLa contribution relative de l’observation \\(\\class{alea}{x_i}\\) à la construction de l’axe principal \\(k\\) est la part d’inertie de l’axe \\(k\\) expliquée par \\(\\class{alea}{x_i}\\) donnée par\n\\[Ctr(i, k) = \\frac{1}{n} \\frac{c_{ik}^2}{\\lambda_k}.\\] En effet \\(\\lambda_k = \\frac{1}{n} \\sum_{i=1}^n c_{ik}^2\\) (ie. la variance du nuage projeté).\nRemarque : si les individus ont des poids \\(w_i\\) alors \\[Ctr(i, k) =  \\frac{w_i c_{ik}^2}{\\lambda_k}.\\]"
  },
  {
    "objectID": "01_acp.html#qualité-de-la-représentation-dune-variable-sur-un-plan-factoriel",
    "href": "01_acp.html#qualité-de-la-représentation-dune-variable-sur-un-plan-factoriel",
    "title": "Analyse en Composantes Principales",
    "section": "Qualité de la représentation d’une variable sur un plan factoriel",
    "text": "Qualité de la représentation d’une variable sur un plan factoriel\n\nIntuitivementFormellement\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUne variable est bien représentée sur l’axe \\(k\\) si l’angle entre cette variable et la composante \\(C^k\\) est petit, son cosinus est proche de 1 ou -1.\n\nOr \\(&lt;X^j, C^k&gt; = \\lVert X^j\\rVert\\lVert C^k\\rVert cos(\\theta_{jk})\\)\n\\[\\begin{align}\n&lt;X^j, C^k&gt; & = &lt;(CP^\\top)^j, C^k&gt; \\\\\n& = \\underbrace{\\left((CP^\\top)^j\\right)^\\top}{= (P C^\\top)_j}   C^k \\\\\n\\end{align}\\]\nAinsi \\(&lt;X^j, C^k&gt;\\) est le \\(j^\\text{ème}\\) terme du vecteur \\(PC^\\top C^k\\), or \\(C^\\top C\\) est diagonale avec \\(C_k^k = n lambda_k\\), donc \\(C^\\top C^k=(0, \\dots, n\\lambda_k, 0, \\ldots)\\) et\n\\[\\cos(\\theta_{jk}) = \\frac{n \\lambda_k \\boldsymbol{u_k^j}}{\\sqrt{\\lVert X^j\\rVert^2 \\, \\lVert C_k\\rVert^2}}=  \\sqrt{\\lambda_k} \\boldsymbol{u_k^j},  \\quad \\cos^2(\\theta_{jk}) =  \\lambda_k{(\\boldsymbol{u_k^j})^2}\\]"
  },
  {
    "objectID": "01_acp.html#ajouter-des-informations-supplémentaires",
    "href": "01_acp.html#ajouter-des-informations-supplémentaires",
    "title": "Analyse en Composantes Principales",
    "section": "Ajouter des informations supplémentaires",
    "text": "Ajouter des informations supplémentaires\nIl est possible d’ajouter des informations supplémentaires\nDes individus supplémentaires qui ne seront pas utilisés pour construire les axes\nSi on veut ajouter un nouvel individu \\(x_{new}\\)\n\non calcule \\(\\boldsymbol{x}_{new} - \\boldsymbol{g}\\), le point centré (et potentiellement on divise par l’écart type des variables calculés sur le jeu de données initial)\nOn projette sur les axes principaux : \\((\\boldsymbol{x}_{new} - \\boldsymbol{g} )^\\top \\boldsymbol{u_k}\\)\n\nUne variable supplémentaire\nSi on souhaite ajouter une nouvelle variable \\(\\boldsymbol{x}^{new}= (x^{new}_1, \\ldots, x^{new}_n)^\\top \\in {\\mathbb{R}}^n\\)\n\nOn soustrait sa moyenne \\(\\tilde{\\boldsymbol{x}}^{new} = \\boldsymbol{x}^{new} - m^{new}\\), \\(m^{new}=\\frac{1}{n} \\sum_{i=1}^n x^{new}_i\\) (ou \\(m^{new}= \\sum_{i=1}^n w_i x^{new}_i\\) si toutes les observations n’ont pas le même poids)\nOn projette \\(\\tilde{\\boldsymbol{x}}^{new}\\) sur \\(\\boldsymbol{u_k},\\)\n\n\\[Cor(\\tilde{\\boldsymbol{x}}^{new}, u_k) = \\frac{(\\tilde{\\boldsymbol{x}}^{new})^\\top W \\boldsymbol{u_k} }{\\lVert\\tilde{\\boldsymbol{x}}^{new}\\rVert}\\]"
  },
  {
    "objectID": "01_acp.html#retournons-à-nos-manchots",
    "href": "01_acp.html#retournons-à-nos-manchots",
    "title": "Analyse en Composantes Principales",
    "section": "Retournons à nos manchots",
    "text": "Retournons à nos manchots\n\n\npenguins.PCA &lt;- PCA(X = penguins, \n                    scale.unit = TRUE, ## should we scale the data,\n                    ncp = 4, ## number of components : as many as initial variables\n                    quali.sup = c(1, 2, 7,8)) ## to indicate the column number of qualitative variable\n\n # library(Factoshiny)\n # PCAshiny(penguins)"
  },
  {
    "objectID": "01_acp.html#présentation-des-données",
    "href": "01_acp.html#présentation-des-données",
    "title": "Analyse en Composantes Principales",
    "section": "Présentation des données",
    "text": "Présentation des données"
  },
  {
    "objectID": "01_acp.html#lexemple-des-caractéristiques-du-doubs",
    "href": "01_acp.html#lexemple-des-caractéristiques-du-doubs",
    "title": "Analyse en Composantes Principales",
    "section": "L’exemple des caractéristiques du Doubs",
    "text": "L’exemple des caractéristiques du Doubs\nOn a mesuré les caractéristiques physico chimiques sur 30 sites différents le long de la rivière Doubs.\n\n\nLes 6 premières lignes (parmi 30) du jeu de données doubs.env\n\n\n# A tibble: 30 × 11\n    das   alt   pen   deb    pH   dur   pho   nit   amm   oxy   dbo\n  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1   0.3   934  48    0.84   7.9    45  0.01  0.2   0     12.2   2.7\n2   2.2   932   3    1      8      40  0.02  0.2   0.1   10.3   1.9\n3  10.2   914   3.7  1.8    8.3    52  0.05  0.22  0.05  10.5   3.5\n4  18.5   854   3.2  2.53   8      72  0.1   0.21  0     11     1.3\n5  21.5   849   2.3  2.64   8.1    84  0.38  0.52  0.2    8     6.2\n6  32.4   846   3.2  2.86   7.9    60  0.2   0.15  0     10.2   5.3\n# ℹ 24 more rows\n\n\n\n\ndas : distance à la source ( \\(km\\) ),\nalt : altitude ( \\(m\\) )\npen : la pente (dénivelé pour 1000m)\ndeb : le débit () \\(m^3.s^{-1}\\) )\npH : le pH de l’eau,\ndur : la concentration en calcium ( \\(mg.L^{-1}\\) ),\npho : concentration en phosphate ( \\(mg.L^{-1}\\) ),\nnit : concentration en nitrate ( \\(mg.L^{-1}\\) ),\namn : concentration en ammonium ( \\(mg.L^{-1}\\) ),\noxy : concentration d’oxygène dissous ( \\(mg.L^{-1}\\) ),\ndbo : Demande biologique en oxygène ( \\(mg.L^{-1}\\) ).\n\n\nComment visualiser au mieux ces données pour faire apparaître les liens entre variables et identifier des ressemblances entre individus ?"
  },
  {
    "objectID": "01_acp.html#analyse-par-acp",
    "href": "01_acp.html#analyse-par-acp",
    "title": "Analyse en Composantes Principales",
    "section": "Analyse par ACP",
    "text": "Analyse par ACP\n\nPoids des individus ?\nQuelle distance entre les variables ?\nLancer l’analyse\n\nquelles sont les composantes intéressantes (règle empririque du choix du nombre d’axes) ?\nquelles informations sont visibles sur le premier plan factoriel ?\nQue peut on dire des liens entre les variables ?\nA votre avis quels sites contribuent le plus à la formation de l’axe 1 ?\nQue peut on dire du pH ?"
  },
  {
    "objectID": "01_acp.html#ne-garder-que-linformation-pertinente",
    "href": "01_acp.html#ne-garder-que-linformation-pertinente",
    "title": "Analyse en Composantes Principales",
    "section": "Ne garder que l’information pertinente",
    "text": "Ne garder que l’information pertinente\nOn a utilisé l’ACP comme une technique de visualisation, mais on peut sen servir comme une technique de compression (avec perte). Il suffit de ne garder que les première composantes principales.\nL’exemple sur une image"
  },
  {
    "objectID": "01_acp.html#matrice-dinertie",
    "href": "01_acp.html#matrice-dinertie",
    "title": "Analyse en Composantes Principales",
    "section": "Matrice d’inertie",
    "text": "Matrice d’inertie\n\n\nRevisiter l’inertie\nL’inertie du nuage de points est définie comme \\[I = \\sum_{i=1}^n w_i \\lVert\\class{alea}{x_i} -\\boldsymbol{g}\\rVert^2_M\\] On a considéré des variables centrées donc \\(\\boldsymbol{g} = \\boldsymbol{0}\\).\n\nOr\n\n\\[\\begin{align}\nI = & \\sum_{i=1}^n w_i x_i^\\top M x_i = tr(\\sum_{i=1}^n w_i x_i^\\top M x_i ) \\\\\n   = & tr(\\sum_{i=1}^n M x_i w_i x_i^\\top ) \\quad \\text{(commutatitvité de la trace)} \\\\\n   = & tr(M \\sum_{i=1}^n  x_i w_i x_i^\\top )\\\\\n   = & tr(M X^\\top W X)\\\\\n   = & tr( X^\\top W X M)\\\\\n   = & tr( V M)\\\\\n   \n\\end{align}\\]\n\nExemple sur les cas présentés\n\nDans le cas de l’ACP, la matrice \\(V\\) est la matrice de covariance et \\(M = Id\\),\nDans le cas de l’ACP normée , la matrice \\(V\\) est la matrice de covariance et \\(M = Diag(s_k^{-2})\\),"
  },
  {
    "objectID": "01_acp.html#ce-que-vous-pensez-devoir-retenir",
    "href": "01_acp.html#ce-que-vous-pensez-devoir-retenir",
    "title": "Analyse en Composantes Principales",
    "section": "Ce que vous pensez devoir retenir",
    "text": "Ce que vous pensez devoir retenir\n\nl’ACP permet de mettre en valeur l’information principale contenu dans un jeu de données\n\nles relations entre variables\nles proximités entre individus\n\nCette méthode permet d’obtenir une projection sur queluqes axes indépendants et bien choisis, au sens ou ils résument le mieux l’information\nTechniquement l’ACP consiste à diagonaliser la matrice de covariance\nLes axes sont définis par les vecteurs propres de la matrice\n\\[ X^\\top W X\\]\nIls sont rangés par ordre d’importance décroissante, au sens où le premier est celui qui préserve le plus l’inertie du nuage projeté (i.e a la plus grande valeur propre)\nIl faut adapter la métrique au probleme\nl’information portée par un axe est mesurée par la valeur propre associé à l’axe\nil faut savoir interpréter le nuage des individus, éclairés par les liens entre axes principaux et anciennes variables"
  },
  {
    "objectID": "01_afd.html#quelques-exemples",
    "href": "01_afd.html#quelques-exemples",
    "title": "Analyse Factorielle Discrimante",
    "section": "Quelques exemples",
    "text": "Quelques exemples\nles manchots\nOn a mesuré les carcatéristqiues physiques de plusieurs manchots de trois espèces différentes.\nOn souhaite visualiser au mieux les différences entre les différentes espèces.\nLes vins de Loire\nOn a mesuré des caractéristiques sensorielles pour 10 vins blancs du Val de Loire,\nDeux types de vin sont étudiés des Sauvignon et de Vouvray (cépage Chenin Blanc) et on souhaite mettre en évidence des profils sensoriels différents."
  },
  {
    "objectID": "01_afd.html#formalisation",
    "href": "01_afd.html#formalisation",
    "title": "Analyse Factorielle Discrimante",
    "section": "Formalisation",
    "text": "Formalisation\nDonnées\nOn dispose de données quantitatives, stockées dans une matrice \\(\\boldsymbol{X}\\) comme en ACP.\nD’une variable qualitative \\(\\boldsymbol{Z}\\) de classe, il y a \\(K\\) classes au total (\\(K=3\\) dans le cas des manchots). Celle-ci est encodée dans un tableau disjonctif complet, c’est à dire que pour l’individu \\(i\\), le vecteur \\(Z_{ik}=1\\) si l’individu appartient à la classe \\(k\\) et \\(0\\) sinon. Si bien que\n\\(\\sum_{k=1}^K Z_{ik} =1\\) et \\(\\sum_{i=1}^n Z_{ik}=n_k\\) le nombre d’individus dans la classe \\(k\\).\n\\[\\boldsymbol{Z} =\\begin{pmatrix}\nZ_{11} & \\ldots &Z_{1K} \\\\\n\\vdots  &   &\\vdots\\\\\nZ_{n1} & \\ldots &Z_{nK} \\\\\n\\end{pmatrix}\\]\nMetrique et poids\nOn a aussi une matrice de poids \\(\\boldsymbol{W}\\) pour les individus et une métrique \\(\\boldsymbol{M}\\) sur les variables\nBut\nTrouver la projection qui permet de mettre en évidence les différences entre les groupes."
  },
  {
    "objectID": "01_afd.html#matrice-dinertie",
    "href": "01_afd.html#matrice-dinertie",
    "title": "Analyse Factorielle Discrimante",
    "section": "Matrice d’inertie",
    "text": "Matrice d’inertie\n\n\nRevisiter l’inertie\nL’inertie du nuage de points est définie comme \\[I = \\sum_{i=1}^n w_i \\lVert\\class{alea}{x_i} -\\boldsymbol{g}\\rVert^2_M\\] On a considéré des variables centrées donc \\(\\boldsymbol{g} = \\boldsymbol{0}\\).\n\nOr\n\n\\[\\begin{align}\nI = & \\sum_{i=1}^n w_i x_i^\\top M x_i = tr(\\sum_{i=1}^n w_i x_i^\\top M x_i ) \\\\\n   = & tr(\\sum_{i=1}^n M x_i w_i x_i^\\top ) \\quad \\text{(commutatitvité de la trace)} \\\\\n   = & tr(M \\sum_{i=1}^n  x_i w_i x_i^\\top )\\\\\n   = & tr(M X^\\top W X)\\\\\n   = & tr( X^\\top W X M)\\\\\n   = & tr( V M)\\\\\n   \n\\end{align}\\]\n\nAinsi l’inertie est la trace de la matrice \\(VM\\), avec \\(V=  X^\\top W X.\\)\n\n\nExemple sur les cas présentés\n\nDans le cas de l’ACP, la matrice \\(V\\) est la matrice de covariance et \\(M = Id\\),\nDans le cas de l’ACP normée , la matrice \\(V\\) est la matrice de covariance et \\(M = Diag(s_k^{-2})\\),\nDans le cas de l’AFM, la matrice \\(V\\) est la matrice de covariance et \\(M = Diag( s_k^{-2} \\lambda_{c_k}^{-1})\\).\n\n\nL’inertie du nuage est la trace de la matrice d’inertie.\nTrouver les axes principaux dans ces méthodes se résume à trouver les vecteurs propres de \\(VM\\)"
  },
  {
    "objectID": "01_afd.html#matrice-dinertie-dans-lafd",
    "href": "01_afd.html#matrice-dinertie-dans-lafd",
    "title": "Analyse Factorielle Discrimante",
    "section": "Matrice d’inertie dans l’AFD",
    "text": "Matrice d’inertie dans l’AFD\nOn a besoin de faire apparaître des barycentres de classe donc on réécrit la matrice d’inertie dans sa forme générale, et on indice par $T£ pour indiquer que c’est l’inertie totale du nuage.\n\\[V_T =  X^\\top W X - \\boldsymbol{g} \\boldsymbol{g}^\\top,\\]\navec \\(\\boldsymbol{g} = \\sum_{i=1}^n w_i  x_i\\), \\(\\boldsymbol{g}\\in{\\mathbb{R}}^d.\\)\n\n\nInertie Intra-classe\n\nDans la classe \\(k\\)\n\n\\[V_k =  X^\\top \\tilde{W_k} X - \\boldsymbol{g_k} \\boldsymbol{g_k}^\\top,\\]\navec \\(\\boldsymbol{g_k} = \\sum_{i=1}^n \\tilde{w}_{ik}  x_i\\), \\(\\tilde{w}_{ik} = \\frac{w_i z_{ik}}{\\sum_i w_i z_{ik}}.\\)\nIntuitivement, c’est la variabilité dans la classe, c’est à dire la dispersion autour du centre de gravité des individus de la classe \\(k\\)\n\nDans l’ensemble des classes \\(k\\), la matrice d’inertie intra-classes \\(V_W\\) (W pour Within)\n\n\\[V_W  = \\sum_{k=1}^K n_k V_k.\\]\n\nInertie Inter-classe\nLa matrice d’inertie inter-classes mesure la dispersion des centres de gravité des classes, affectés de leur poids, autour du centre de gravité du nuage.\n\\[V_B = \\sum_{k=1}^n n_k \\boldsymbol{g_k}\\boldsymbol{g_k}^\\top - \\boldsymbol{g}\\boldsymbol{g}^\\top.\\]"
  },
  {
    "objectID": "01_afd.html#décomposition-de-linertie",
    "href": "01_afd.html#décomposition-de-linertie",
    "title": "Analyse Factorielle Discrimante",
    "section": "Décomposition de l’inertie",
    "text": "Décomposition de l’inertie\nOn a la décomposition suivante de l’inertie en inertie intra-classes plus inertie inter-classes \\[\nV_T= V_W + V_B.\n\\]\n\n\nDécomposition de l’inertie expliquée par un axe\nL’inertie du nuage projeté sur l’axe \\(\\Delta_u\\) de vecteur unitaire \\(u\\), avec métrique \\(M\\), peut se décomposer comme \\[\nu^\\top M V_T M u = u^\\top M V_B M u + u^\\top M V_W M u,\n\\] où\n\n\\(u^\\top M V_T M u\\) est l’inertie totale portée par \\(\\Delta_u\\)\n\\(u^\\top M V_B M u\\) est l’inertie inter-classes portée par \\(\\Delta_u\\)\n\\(u^\\top M V_W M u\\) est l’inertie intra-classes portée par \\(\\Delta_u\\).\n\n\nFormalisation du problème\nOn cherche donc l’axe \\(\\Delta_u\\) tel que lors de la projection sur \\(\\Delta_u\\), les classes soient le plus séparées possible et que la variabilité au sein de chaque classe soit la plus petite possible\nSi \\(V_T\\) est inversible et puisque \\(M V_T M  = M V_B M  +  M V_W M\\), alors\n\\[I_d = (MV_TM)^{-1} M V_B M  + (MV_TM)^{-1} M V_W M\\] On cherche \\(u_1\\), \\(\\lVert u_1\\rVert=1\\) tel que\n\\[u_1^T  (MV_TM)^{-1} M V_B M  u_1= u_1^T M^{-1} V_T^{-1} V_B M u_1 \\]\n\nOn cherche donc les vecteurs propres de \\(M^{-1} V_T^{-1} V_B M\\)"
  },
  {
    "objectID": "01_afd.html#lafd-une-méthode-factorielle",
    "href": "01_afd.html#lafd-une-méthode-factorielle",
    "title": "Analyse Factorielle Discrimante",
    "section": "L’AFD = une méthode factorielle",
    "text": "L’AFD = une méthode factorielle\nSi \\(u_1\\) est vecteur propre de \\(M^{-1} V_T^{-1} V_B M\\), donc \\[M^{-1} V_T^{-1} V_B M u_1 = \\lambda_1 u_1  \\quad \\text{ i .e} \\quad V_T^{-1} V_B M u_1  = \\lambda_1  M u_1 \\]\nDans une ACP, on fait une décomposition de \\(V_T M\\)"
  },
  {
    "objectID": "01_afd.html#ce-que-vous-pensez-devoir-retenir",
    "href": "01_afd.html#ce-que-vous-pensez-devoir-retenir",
    "title": "Analyse Factorielle Discrimante",
    "section": "Ce que vous pensez devoir retenir",
    "text": "Ce que vous pensez devoir retenir\nA construire ensemble"
  },
  {
    "objectID": "01_inertie.html#linertie-par-rapport-à-un-point",
    "href": "01_inertie.html#linertie-par-rapport-à-un-point",
    "title": "Mesurer la quantité d’information",
    "section": "L’inertie par rapport à un point",
    "text": "L’inertie par rapport à un point\n\n\n\nDefinition 1\n\n\nL’inertie par rapport à un point \\(a \\in {\\mathbb{R}}^{p}\\) est définie par\n\\[I_{\\boldsymbol{a}} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{a}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -a^k)^2\\]\n\n\n\n\nIntuitivementRéponseThéorème de Huyghens\n\n\nL’inertie par rapport à un point quantifie l’information perdue lorsque le jeu de données est résumé par ce point.\nQuel est selon vous le point \\(\\boldsymbol{a}\\) qui minimise l’inertie ?\n\\[argmin_{\\boldsymbol{a}} I_{\\boldsymbol{a}} = ??\\]\n\n\nBINGO !!!\nIl s’agit du point \\(\\boldsymbol{g}=\\boldsymbol{x_{\\bullet}}=({x}_{\\bullet}^1, \\ldots, {x}_{\\bullet}^p )^\\top,\\) avec \\({x}_{\\bullet}^k=\\frac{1}{n} \\sum_{i=1}^n x_{i}^k\\), la valeur moyenne de la variable \\(k\\) sur l’ensemble des individus.\nPuisque nous avons supposé que nos variables étaient centrées, \\(G=O\\) l’origine sur repère.\n\n\n\\[\\forall \\boldsymbol{a}\\in\\mathbb{R}^p,\\; I_\\boldsymbol{a}=I_\\boldsymbol{g} + \\lVert\\boldsymbol{a}- \\boldsymbol{g}\\rVert^2.\\]"
  },
  {
    "objectID": "01_inertie.html#linertie-par-rapport-à-un-point-1",
    "href": "01_inertie.html#linertie-par-rapport-à-un-point-1",
    "title": "Mesurer la quantité d’information",
    "section": "L’inertie par rapport à un point",
    "text": "L’inertie par rapport à un point\n\n\n\nDefinition 2\n\n\nL’inertie du nuage de points représentés par \\({\\boldsymbol{X}}\\) est l’inertie par rapport à son baycentre \\[I = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - {g}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -\\bar{x}^k)^2\\]\n\n\n\nConséquence\nLe meilleur résumé du nuage de points à un unique point est le barycentre du nuage de points, c’est à dire la moyenne sur chacune des dimensions.\nLa quantité d’information perdue lors de ce résumé est \\(I\\)\nRemarque\n\\[ I = \\frac{1}{n}  \\sum_{i=1}^n     \\left( \\sum_{k=1}^p \\left( x_{i}^k - x_{\\bullet}^k  \\right)^2 \\right)  = \\sum_{k=1}^p  \\left( \\frac{1}{n}  \\sum_{i=1}^n  \\left( x_{i}^k - x_{\\bullet}^k  \\right)^2 \\right)  = \\sum_{k=1}^p  Var(\\boldsymbol{x}^{k})\\] Si les variables sont réduites, i.e de norme 1\n\\[I = p\\]"
  },
  {
    "objectID": "01_inertie.html#linertie-par-rapport-à-un-axe",
    "href": "01_inertie.html#linertie-par-rapport-à-un-axe",
    "title": "Mesurer la quantité d’information",
    "section": "L’inertie par rapport à un axe",
    "text": "L’inertie par rapport à un axe\n\n\n\nDefinition 2\n\n\nL’inertie par rapport à l’axe \\(\\Delta\\) est définie par\n\\[I_{\\boldsymbol{\\Delta}} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{p_i}^{\\Delta}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -p^{k,\\Delta}_i)^2, \\quad \\mbox{où }\\  \\boldsymbol{p_i}^{\\Delta} \\mbox{projeté orthogonal de } \\boldsymbol{x_i} \\mbox{ sur }\\Delta.\\]\n\n\n\n{Rajouter un exemple avec des projections sur les axes de départ}[.rouge]\n\nIntuitivementPour perdre le moins d’information possibleRappel projection orthogonale\n\n\n\n\nL’inertie par rapport à l’axe \\(\\Delta\\) quantifie l’information perdue lorsque l’on résume le nuage de points à son projeté sur \\(\\Delta\\).\n\n\n\n\n\n\n\n\n\n\n\n\n\nIdentifier \\(\\Delta\\) tel que \\(I_{\\Delta}\\) soit minimale\nCe qui revient à l’axe \\(\\Delta\\) qui assure que la projection sur \\(\\Delta\\) déforme le moins possible le nuage de points.\nDans le cadre de l’ACP, on veut construire une ensemble d’axes orthogonaux (une nouvelle base de \\({\\mathbb{R}}^p\\)), de façon à ce que\n\nla projection sur le premier axe, soit le meilleur résumé du nuage de points en une dimension,\nle deuxième axe est orthogonal au premier et représente “le deuxième meileur choix” …. dans un sens que l’on va définir\nle troisième …\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nProduit scalaire : Soient deux élements \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) de \\(\\mathbb{R}^p\\), le produit scalaire est noté \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt;\\) et \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt;=\\sum_{i=1}^p x_i y_i = \\boldsymbol{x}^\\top \\boldsymbol{y}.\\)\nOrthogonalité Soient deux élements \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) de \\(\\mathbb{R}^p\\), on dit que \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) sont orthogonaux (noté \\(\\boldsymbol{x}\\perp \\boldsymbol{y}\\)) si \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt; = \\boldsymbol{x}^\\top  \\boldsymbol{y}=0\\).\nProjection orthogonale On note \\(\\boldsymbol{a}_u\\) le projeté de \\(\\boldsymbol{a}\\) sur la droite \\(\\Delta\\) définit par son vecteur directeur unitaire \\(\\boldsymbol{u}\\) et passant par l’origine \\[\\boldsymbol{a}_u = &lt; \\boldsymbol{a}, \\boldsymbol{u} &gt; \\boldsymbol{u} = (\\boldsymbol{a}^\\top \\boldsymbol{u})\\,  \\boldsymbol{u}.\\] Le vecteur \\(\\boldsymbol{a_u}\\) est orthogonal à \\(\\boldsymbol{a}-\\boldsymbol{a_u}\\): \\[&lt; \\boldsymbol{a_u}, \\boldsymbol{a}-\\boldsymbol{a_u}&gt; = \\left ((\\boldsymbol{a}^\\top \\boldsymbol{u}) \\boldsymbol{u}\\right)^\\top \\left ( \\boldsymbol{a} -  (\\boldsymbol{a}^\\top \\boldsymbol{u})\\,  \\boldsymbol{u} \\right)=(\\boldsymbol{a}^\\top \\boldsymbol{u}) (\\boldsymbol{u}^\\top \\boldsymbol{a}) - (\\boldsymbol{a}^\\top \\boldsymbol{u})^2 \\boldsymbol{u}^\\top \\boldsymbol{u} =0  \\]"
  },
  {
    "objectID": "01_inertie.html#linertie-par-rapport-à-un-sous-espace-affine",
    "href": "01_inertie.html#linertie-par-rapport-à-un-sous-espace-affine",
    "title": "Mesurer la quantité d’information",
    "section": "L’inertie par rapport à un sous espace affine",
    "text": "L’inertie par rapport à un sous espace affine\n\nEspace orthogonal Soit \\(E\\) un sous-espace vectoriel de \\(\\mathbb{R}^p\\). On definit \\(E^\\perp=\\{\\boldsymbol{x}\\in \\mathbb{R}^p:\\; \\forall \\boldsymbol{y}\\in E,\\; \\boldsymbol{x}\\perp \\boldsymbol{y}\\}\\).\n\n\nExempleSolution\n\n\nDans \\({\\mathbb{R}}^2\\), on considère le sous espace vectoriel \\(E\\), tel que \\[ E =\\left \\lbrace  \\boldsymbol{x}=\\begin{pmatrix} x_1 &  x_2 \\end{pmatrix}^\\top \\in {\\mathbb{R}}^2 : x_1 = x_2  \\right \\rbrace \\] \\(E\\) est la droite d’équation \\(y=x\\).\nQui est \\(E^\\perp\\) ?\n\n\nSoit \\(\\boldsymbol{y}\\in E^\\perp,\\) alors\n\\[\\begin{align}\n0 & = \\boldsymbol{x}^\\top \\boldsymbol{y}\\\\\n  & = \\begin{pmatrix} x_1 &  x_2 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\  y_2 \\end{pmatrix}\\\\\n  & = x_1 y_1 + x_2 y_2 \\\\\n  & = x_1 (y_1 + y_2) \\quad (\\boldsymbol{x}\\in E \\Rightarrow x_1 =x_2) \\\\\n\\end{align}\\]\n\\[E^\\perp =  \\left \\lbrace  \\boldsymbol{y}=\\begin{pmatrix} y_1 &  y_2 \\end{pmatrix}^\\top \\in {\\mathbb{R}}^2 : y_1 + y_2 = 0 \\right \\rbrace  \\]\n\n\n\n\n\n\n\nDefinition 3\n\n\nL’inertie par rapport à un sous espace vectoriel \\(E\\) est définie par \\[I_{E} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{p_i}^{E}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -p^{k,E}_i)^2, \\quad \\mbox{où }\\  \\boldsymbol{p_i}^{E} = argmin_{\\boldsymbol{y}\\in E} d(\\boldsymbol{y}, \\boldsymbol{x}_{i}), \\mbox{i.e. projeté orthogonal de } \\boldsymbol{x_i} \\mbox{ sur }E.\\]\n\n\n\nC’est l’inertie perdue lorsque l’on résume le nuage de points à sa projection sur le sous espace \\(E\\)."
  },
  {
    "objectID": "01_inertie.html#décomposition-de-linertie",
    "href": "01_inertie.html#décomposition-de-linertie",
    "title": "Mesurer la quantité d’information",
    "section": "Décomposition de l’inertie",
    "text": "Décomposition de l’inertie\n\nSoit \\(E\\) un sous espace vectoriel de \\({\\mathbb{R}}^p\\), alors \\[I = I_E + I_{E^\\perp}.\\]\n\nPreuve\n\n\nUn dessin vaut mieux qu’un long discours et Pythagore est ton ami !\n\\[d(\\class{alea}{\\boldsymbol{x}_{i}}, O)^2 = d(\\boldsymbol{x}_{i}, \\class{bleu}{\\boldsymbol{x}_{i}^E})^2  +  d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{rouge}{\\boldsymbol{x}_{i}^{E^\\perp}})^2.\\]\n\\[\\begin{align}\nI & = \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, O)^2 \\\\\n   & = \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{bleu}{\\boldsymbol{x}_{i}^E})^2   +  \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{rouge}{\\boldsymbol{x}_{i}^{E^\\perp}})^2 \\\\\n   & = \\class{bleu}{I_E} + \\class{rouge}{I_{E^\\perp}}\n\\end{align}\\]"
  },
  {
    "objectID": "01_inertie.html#principe-de-la-décomposition-à-venir",
    "href": "01_inertie.html#principe-de-la-décomposition-à-venir",
    "title": "Mesurer la quantité d’information",
    "section": "Principe de la décomposition à venir",
    "text": "Principe de la décomposition à venir\n\nIdentifier le vecteur \\(\\boldsymbol{u_1}\\) de \\({\\mathbb{R}}^p\\), tel que \\(I_{E_1}\\) soit minimale avec \\(E_1=\\left \\lbrace \\lambda \\boldsymbol{u_1}, \\lambda \\in {\\mathbb{R}}\\right\\rbrace,\\)\nDans \\(E_1^\\perp\\), identifier le vecteur \\(\\boldsymbol{u_2}\\) de \\({\\mathbb{R}}^p\\), tel que \\(I_{E_2}\\) soit minimale avec \\(E_2=\\left \\lbrace \\lambda \\boldsymbol{u_2}, \\lambda \\in {\\mathbb{R}}\\right\\rbrace,\\)\nDans \\(\\left (  E_1 \\oplus E_2 \\right)^\\perp\\), identifier le vecteur \\(\\boldsymbol{u_3}\\) de \\({\\mathbb{R}}^p\\), tel que ….\n\n…\nFinalement on aura la décomposition\n\\[I= I_{E_1} + I_{E_2} + \\ldots + I_{E_p}, \\quad \\mbox{avec } I_{E_1} \\leq I_{E_2} \\leq \\ldots \\leq I_{E_p}\\]"
  },
  {
    "objectID": "ACP_images.html",
    "href": "ACP_images.html",
    "title": "ACP for Image Compression",
    "section": "",
    "text": "Loading required package: ggplot2\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ lubridate 1.9.4     ✔ tibble    3.3.0\n✔ purrr     1.1.0     ✔ tidyr     1.3.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nPour bien comprendre comment sont décomposées les images en bloc de 16 par 16, on peut créer une matrice avecdes cases numérotées et constater comment elle est transformée.\nUn bloc de 1- pixels est un individu à 16 variables.\ntest_image &lt;- array(1:1024, dim= c(32, 16, 1, 1))\ntest_image_blocks &lt;- extract_blocks_parallel(test_image[,,1,1], block_size = 4)\n\n[1] 29\n\ntest_image\n\n[,12] [,13]\n [1,]    1   33   65   97  129  161  193  225  257   289   321   353   385\n [2,]    2   34   66   98  130  162  194  226  258   290   322   354   386\n [3,]    3   35   67   99  131  163  195  227  259   291   323   355   387\n [4,]    4   36   68  100  132  164  196  228  260   292   324   356   388\n [5,]    5   37   69  101  133  165  197  229  261   293   325   357   389\n [6,]    6   38   70  102  134  166  198  230  262   294   326   358   390\n [7,]    7   39   71  103  135  167  199  231  263   295   327   359   391\n [8,]    8   40   72  104  136  168  200  232  264   296   328   360   392\n [9,]    9   41   73  105  137  169  201  233  265   297   329   361   393\n[10,]   10   42   74  106  138  170  202  234  266   298   330   362   394\n[11,]   11   43   75  107  139  171  203  235  267   299   331   363   395\n[12,]   12   44   76  108  140  172  204  236  268   300   332   364   396\n[13,]   13   45   77  109  141  173  205  237  269   301   333   365   397\n[14,]   14   46   78  110  142  174  206  238  270   302   334   366   398\n[15,]   15   47   79  111  143  175  207  239  271   303   335   367   399\n[16,]   16   48   80  112  144  176  208  240  272   304   336   368   400\n[17,]   17   49   81  113  145  177  209  241  273   305   337   369   401\n[18,]   18   50   82  114  146  178  210  242  274   306   338   370   402\n[19,]   19   51   83  115  147  179  211  243  275   307   339   371   403\n[20,]   20   52   84  116  148  180  212  244  276   308   340   372   404\n[21,]   21   53   85  117  149  181  213  245  277   309   341   373   405\n[22,]   22   54   86  118  150  182  214  246  278   310   342   374   406\n[23,]   23   55   87  119  151  183  215  247  279   311   343   375   407\n[24,]   24   56   88  120  152  184  216  248  280   312   344   376   408\n[25,]   25   57   89  121  153  185  217  249  281   313   345   377   409\n[26,]   26   58   90  122  154  186  218  250  282   314   346   378   410\n[27,]   27   59   91  123  155  187  219  251  283   315   347   379   411\n[28,]   28   60   92  124  156  188  220  252  284   316   348   380   412\n[29,]   29   61   93  125  157  189  221  253  285   317   349   381   413\n[30,]   30   62   94  126  158  190  222  254  286   318   350   382   414\n[31,]   31   63   95  127  159  191  223  255  287   319   351   383   415\n[32,]   32   64   96  128  160  192  224  256  288   320   352   384   416\n      [,14] [,15] [,16]\n [1,]   417   449   481\n [2,]   418   450   482\n [3,]   419   451   483\n [4,]   420   452   484\n [5,]   421   453   485\n [6,]   422   454   486\n [7,]   423   455   487\n [8,]   424   456   488\n [9,]   425   457   489\n[10,]   426   458   490\n[11,]   427   459   491\n[12,]   428   460   492\n[13,]   429   461   493\n[14,]   430   462   494\n[15,]   431   463   495\n[16,]   432   464   496\n[17,]   433   465   497\n[18,]   434   466   498\n[19,]   435   467   499\n[20,]   436   468   500\n[21,]   437   469   501\n[22,]   438   470   502\n[23,]   439   471   503\n[24,]   440   472   504\n[25,]   441   473   505\n[26,]   442   474   506\n[27,]   443   475   507\n[28,]   444   476   508\n[29,]   445   477   509\n[30,]   446   478   510\n[31,]   447   479   511\n[32,]   448   480   512\n\ntest_image_blocks\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]\n [1,]    1    2    3    4   33   34   35   36   65    66    67    68    97\n [2,]    5    6    7    8   37   38   39   40   69    70    71    72   101\n [3,]    9   10   11   12   41   42   43   44   73    74    75    76   105\n [4,]   13   14   15   16   45   46   47   48   77    78    79    80   109\n [5,]   17   18   19   20   49   50   51   52   81    82    83    84   113\n [6,]   21   22   23   24   53   54   55   56   85    86    87    88   117\n [7,]   25   26   27   28   57   58   59   60   89    90    91    92   121\n [8,]   29   30   31   32   61   62   63   64   93    94    95    96   125\n [9,]  129  130  131  132  161  162  163  164  193   194   195   196   225\n[10,]  133  134  135  136  165  166  167  168  197   198   199   200   229\n[11,]  137  138  139  140  169  170  171  172  201   202   203   204   233\n[12,]  141  142  143  144  173  174  175  176  205   206   207   208   237\n[13,]  145  146  147  148  177  178  179  180  209   210   211   212   241\n[14,]  149  150  151  152  181  182  183  184  213   214   215   216   245\n[15,]  153  154  155  156  185  186  187  188  217   218   219   220   249\n[16,]  157  158  159  160  189  190  191  192  221   222   223   224   253\n[17,]  257  258  259  260  289  290  291  292  321   322   323   324   353\n[18,]  261  262  263  264  293  294  295  296  325   326   327   328   357\n[19,]  265  266  267  268  297  298  299  300  329   330   331   332   361\n[20,]  269  270  271  272  301  302  303  304  333   334   335   336   365\n[21,]  273  274  275  276  305  306  307  308  337   338   339   340   369\n[22,]  277  278  279  280  309  310  311  312  341   342   343   344   373\n[23,]  281  282  283  284  313  314  315  316  345   346   347   348   377\n[24,]  285  286  287  288  317  318  319  320  349   350   351   352   381\n[25,]  385  386  387  388  417  418  419  420  449   450   451   452   481\n[26,]  389  390  391  392  421  422  423  424  453   454   455   456   485\n[27,]  393  394  395  396  425  426  427  428  457   458   459   460   489\n[28,]  397  398  399  400  429  430  431  432  461   462   463   464   493\n[29,]  401  402  403  404  433  434  435  436  465   466   467   468   497\n[30,]  405  406  407  408  437  438  439  440  469   470   471   472   501\n[31,]  409  410  411  412  441  442  443  444  473   474   475   476   505\n[32,]  413  414  415  416  445  446  447  448  477   478   479   480   509\n      [,14] [,15] [,16]\n [1,]    98    99   100\n [2,]   102   103   104\n [3,]   106   107   108\n [4,]   110   111   112\n [5,]   114   115   116\n [6,]   118   119   120\n [7,]   122   123   124\n [8,]   126   127   128\n [9,]   226   227   228\n[10,]   230   231   232\n[11,]   234   235   236\n[12,]   238   239   240\n[13,]   242   243   244\n[14,]   246   247   248\n[15,]   250   251   252\n[16,]   254   255   256\n[17,]   354   355   356\n[18,]   358   359   360\n[19,]   362   363   364\n[20,]   366   367   368\n[21,]   370   371   372\n[22,]   374   375   376\n[23,]   378   379   380\n[24,]   382   383   384\n[25,]   482   483   484\n[26,]   486   487   488\n[27,]   490   491   492\n[28,]   494   495   496\n[29,]   498   499   500\n[30,]   502   503   504\n[31,]   506   507   508\n[32,]   510   511   512"
  },
  {
    "objectID": "ACP_images.html#peut-on-compresser-les-beatles",
    "href": "ACP_images.html#peut-on-compresser-les-beatles",
    "title": "ACP for Image Compression",
    "section": "Peut on compresser les Beatles ?",
    "text": "Peut on compresser les Beatles ?\nOn va travailler sur la fameuse image de l’album Abbey Road des Beatles.\n\nPour la charger avec R, on utilise le package imager et la fonction load.image. puis la fonction grayscalepour bien s’assurer que l’image est codée en niveaux de gris.\n\nlibrary(imager)\nimage &lt;- load.image('img/abbey_road.jpg')\nimage &lt;- grayscale(image)\ndf_origine &lt;-image %&gt;% as.data.frame\np_origine &lt;- ggplot(df_origine,aes(x,y))+geom_raster(aes(fill=value)) +\n   scale_y_continuous(trans=scales::reverse_trans(), expand = c(0,0)) + ## pour mettre l'image dans le bon sens et supprimer les bors gris\n  scale_x_continuous(expand=c(0,0)) +\n  scale_fill_gradient(low=\"black\",high=\"white\") + ## pour le noir et blanc\n  theme(legend.position = \"none\")\n\np_origine\n\n\n\n\n\n\n\n\nL’objet obtenu est un array dont la première dimension est le nombre de pixels en ligne et la seconde dimension le nombre de pixel en colonnes. La troisème dimension est la profondeur et correspondrait au temps dan sun film par exemple et la dernière dimension est la couleur (on a donc 3 valeurs possibles sur cette dernière dimension dans le cas d’une image RGB et 1 dans le cas d’une image en niveau de gris).\nSi on se concentre sur les deux premières dimensions, on a donc une matrice dont la valeur est le niveau de gris du pixel correspondant.\n\ndim(image)\n\n[1] 1024  768    1    1\n\ngray_channel &lt;- image[,,1,1]\ngray_channel[1,1]\n\n[1] 0.1529412\n\n\nPour rentrer dans le formalisme de l’ACP, on a besoin qu’une ligne soit un individu et une colonne une variable. Ici, le choix nous revient de définir comme on le souhaite ce qu’est un individu et une varaible.\nOn va découper l’image en buffer carré (patch, micro image) de coté \\(bs.\\) Un individu sera un patch et une variable sera le niveau de gris dans un pixel particulier du patch.\nOn a donc \\(bs^2\\) variables et \\(N_{buf} = (height/bs) * (width/bs)\\) buffers/individus.\n\n# Set block size to 4x4\nblock_size &lt;- 4\n\n# Extract blocks for each color channel in parallel\nimage_blocks &lt;- extract_blocks_parallel(gray_channel, block_size)\ndim(image_blocks)\n\n\nRéduction de dimension par ACP\nOn va maintenant mettre en oeuvre une ACP, pour détermnier les composantes principales et on ne gardera quelques composantes pour réduire la dimension. On utilise FactoMineR.\n\nlibrary(FactoMineR)\nimages_pca &lt;- PCA(X = image_blocks, scale.unit = TRUE, ncp = ncol(image_blocks))\n\nLes valeurs propres nous donnent la quantité d’information contenu par chaque composante.\n\neigen_restreint &lt;- images_pca$svd$V\n\nOn constate que la première composante contient à elle toute seule 89.0652348\\(\\%\\) d’inertie. Ce qui signifie qu’en écrivant chaque buffet comme un nombre réel multiplé par le premier buffer on recontruit presque \\(90\\%\\) de l’information. Dans ca cas on a juste besoin de stocker\n\nla matrice \\(1\\times bs^2\\) qui permet de reconstruire les 16 variables initiales avec l’information contenu dans ce premier buffer,\nles coefficients que chaque buffer individu attribue à ce premier buffer, soit \\(N_{buf}\\)\n\nOn passe donc \\(N_{buf} * 16\\) réels à stocker à \\(N_{buf} + bs^2\\) si on ne garde qu’une seule composante ou \\(2 N_{buf} + bs^2\\) si on en garde 2.\nLes vecteurs propres sont donnés par\n\neigen_restreint &lt;- images_pca$svd$V\n\nOn sait q’un vecteur propre correspond à un patch de \\(bc\\times bs\\), on peut donc les visualiser sous cette forme\n\nlist_eigen &lt;- lapply(1:block_size^2, function(i){\n  X_restreint &lt;- matrix(images_pca$svd$V[,i], ncol = 4, nrow = 4)\n  image_eig &lt;- as.cimg(array(X_restreint, dim = c(4,4,1,1)))\n  p &lt;- image_eig %&gt;% as.data.frame() %&gt;% ggplot(aes(x,y))+geom_raster(aes(fill=value)) +\n   scale_y_continuous(trans=scales::reverse_trans(), expand = c(0,0)) + ## pour mettre l'image dans le bon sens et supprimer les bors gris\n  scale_x_continuous(expand=c(0,0)) +\n  scale_fill_gradient(low=\"black\",high=\"white\") + ## pour le noir et blanc\n  theme(legend.position = \"none\") +\ncoord_fixed()\n  return(p)\n}\n)\n\nggarrange(plotlist = list_eigen, ncol = 4)\n\n$`1`\n\n\n\n\n\n\n\n\n\n\n$`2`\n\n\n\n\n\n\n\n\n\n\n$`3`\n\n\n\n\n\n\n\n\n\n\n$`4`\n\n\n\n\n\n\n\n\n\n\nattr(,\"class\")\n[1] \"list\"      \"ggarrange\"\n\n\n\n\nReconstruction avec une seule composante principale\n\nnew_coord &lt;- images_pca$ind$coord\nreconstruction &lt;- new_coord[, 1, drop = FALSE]%*% t(images_pca$svd$V)[1,] \n\nn_row_block &lt;- dim(image)[1]/block_size\nn_col_block &lt;- dim(image)[2]/block_size\n\n\nX_reconstruction_list &lt;- lapply(1:n_col_block, function(j){\n  list_rows &lt;- lapply(1:n_row_block, function(i){\n    matrix( reconstruction[(j-1)*n_row_block + i,], ncol = block_size)\n  })\n  do.call(rbind, list_rows)\n}  \n)\n\nX_reconstruction &lt;- do.call(cbind, X_reconstruction_list)\n\n\ndf_1 &lt;-as.cimg(array(X_reconstruction, dim=dim(image))) %&gt;% as.data.frame\np_1 &lt;- ggplot(df_1,aes(x,y))+geom_raster(aes(fill=value)) +\n   scale_y_continuous(trans=scales::reverse_trans(), expand = c(0,0)) + ## pour mettre l'image dans le bon sens et supprimer les bors gris\n  scale_x_continuous(expand=c(0,0)) +\n  scale_fill_gradient(low=\"black\",high=\"white\") + ## pour le noir et blanc\n  theme(legend.position = \"none\")\n\n\nnew_coord &lt;- images_pca$ind$coord\nreconstruction_2 &lt;- new_coord[, 1:2]%*% t(images_pca$svd$V)[1:2,] \n\nX_reconstruction_list_2 &lt;- lapply(1:n_col_block, function(j){\n  list_rows &lt;- lapply(1:n_row_block, function(i){\n    matrix( reconstruction_2[(j-1)*n_row_block + i,], ncol = block_size)\n  })\n  do.call(rbind, list_rows)\n}  \n)\n\nX_reconstruction_2 &lt;- do.call(cbind, X_reconstruction_list_2)\n\n\ndf_2 &lt;-as.cimg(array(X_reconstruction_2, dim=dim(image))) %&gt;% as.data.frame\np_2 &lt;- ggplot(df_2,aes(x,y))+geom_raster(aes(fill=value)) +\n   scale_y_continuous(trans=scales::reverse_trans(), expand = c(0,0)) + ## pour mettre l'image dans le bon sens et supprimer les bors gris\n  scale_x_continuous(expand=c(0,0)) +\n  scale_fill_gradient(low=\"black\",high=\"white\") + ## pour le noir et blanc\n  theme(legend.position = \"none\")\n\n\n\n\n\n\nOriginal Beatles\n\n\n\n\n\n\n\n\n\nWith 2 principal components\n\n\n\n\n\n\n\n\n\nWith 1 principal component"
  },
  {
    "objectID": "TP2.html",
    "href": "TP2.html",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "",
    "text": "$$\n$$\nLes méthodes d’analyse factorielles sont utiles pour l’exploration de données, soit en tant que telle soit dans une phase préparatoire à un travail de modélisation. Il est utile de disposer à la fois d’outils interractifs pour l’exploration, mais également de garder une trace de l’exploration avec un document bilan.\nNous allons dans ce TP utiliser un fichier TP2.qmd pour garder une trace des analyses faites mais nous pourrons en parallèle utiliser le potentiel d’une exploration plus interactive soit avec Factoshiny soit avec explor selon ce que vous préférez.\nDans ce TP nous allons explorer un premier exemple en détail avec une démarche bien guidée tandis que le second exemple a pour objectif de vous laisser face aux données en autonomie, pour vérifier que vous voyez comment aborder un jeu de données avec les méthodes d’analyse factorielle."
  },
  {
    "objectID": "TP2.html#description-des-données",
    "href": "TP2.html#description-des-données",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Description des données",
    "text": "Description des données\nLe jeu de données utilisé dans ce premier cas pratique provient du site web de Global Footprint Network. Il contient les résultats d’empreinte écologique et de biocapacité pour 184 pays.\nLes données sont disponibles sur ce lien.\n\nQuelques définitions\nLe calcul de l’empreinte écologique et de la biocapacité nous aide à répondre à la question de recherche fondamentale : Quelle est la demande des êtres humains envers les surfaces biologiquement productives (empreinte écologique) par rapport à la quantité que la planète (ou la surface productive d’une région) peut régénérer sur ces surfaces (biocapacité) ?\n\nHectare global (gha) : C’est l’unité choisie pour exprimer toutes les quantités d’intérêt concernant la consommation/émission de carbone. Une unité de surface correspondant à la productivité moyenne d’un hectare de terres mondiales. Un hectare de terres agricoles vaudra plus d’hectares globaux qu’un hectare de désert.\nEmpreinte écologique (en gha par personne) : Le nombre de gha requis pour produire les besoins et absorber les déchets d’un pays.\nBiocapacité (en gha) : La capacité d’un pays à produire ce dont il a besoin et à absorber ses déchets (réserve écologique).\nJour de dépassement : Jour de l’année où la demande d’un pays dépasse sa biocapacité annuelle.\n\nDes détails supplémentaires sont disponibles ici"
  },
  {
    "objectID": "TP2.html#objectifs",
    "href": "TP2.html#objectifs",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Objectifs",
    "text": "Objectifs\nLes relations entre les différentes mesures de l’empreinte écologique et les caractéristiques des pays.\n\nChargement des Données\n\n\nAnalyse Exploratoire des Données\n\nPouvez vous indiquer le nombre de lignes et de colonnes\n\nL’unité utilisé pour comparer est le Global Hectare (gha): Unité de surface qui correspondrait à la production moyenne d’un hectare du monde. Un hectare de champ vaudra donc plus de global hectare qu’un hectare de desert.\nLe gha par personne correspondant à une production (ou cosommation) globale d’une unité, (ici un pays) divisé par le nombre d’habitants dans cette unité.\nLes Variables disponibles sont\n\nlife_expectancy : Espérance de vie moyenne (années).\nhdi : Indice de développement humain.\nper_capita_gdp : PIB par habitant (USD).\nregion : Région géographique.\nincome_group : Catégorie de revenu (HI : Haut, UM : Moyen supérieur, LM : Moyen inférieur, LI : Faible).\npop : Population (en millions).\ntotal_prod : Production totale (gha par personne) la production du pays par habitant.\ntotal_cons : Consommation totale (gha par personne) la consommation par habitant.\nbiocapacity : La production durable (gha par personne) par habitant, ce que peut fournir le pays ramené par habitant.\nnumber_of_countries_required : Nombre de pays nécessaires pour satisfaire la consommation (total_cons/biocapacity)\nnumber_of_earths_required : Nombre de terres dont on aurait besoin si tout le monde faisait comme dans le pays en question (nb gha par personnes du pays / 1.583 (nb de gha par habitant de la terre, ce chiffre est mis à jour chaque année))\novershoot_day : Jour de dépassement (numéro du jour dans l’année).\n\nPlus de détails peuvent être trouvés ici , mais on peut préciser de la manière suivante\n\n\nStatistiques descriptives :\nProposez des résumés numériques pour chaque variable, ainsi qu’une étude des corrélations.\nPour le moment, on va supprimer les données manquantes (on verra par la suite comment gérer ce problème de manière plus satisfaisante). Pour ceci on peut utiliser drop_nadu package tidyverse ou na.omitde R Base."
  },
  {
    "objectID": "TP2.html#construire-une-acp",
    "href": "TP2.html#construire-une-acp",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Construire une ACP",
    "text": "Construire une ACP\n\nQuel poids choisir pour les pays ?\n\n\n\nQuelle métrique choisir ?\n\n\n\nQuelles variables met-on en variables supplémentaires ?\n\n\n\nQuelle est l’inertie portée par l’axe 1 ?, l’axe 2, l’axe 3 ?\n\n\nCommentez la qualité de la représentation sur le plan (1-2), puis (1-3).  \nDe quelles variables nous parle l’axe 1 ? l’axe 2 ? Pour répondre à cette question on regardera le cercle des corrélations mais aussi les contributions des variable sà la création des axes.\n\n\n\n\n\n\nQue pensez vous du graphe des individus ? Quels sont les individus atypiques ? Quels sont le spays les mieux représentés ?\nComment l’ACP est-elle modifiée si on retire Singapour de l’analyse ?\n\nDe nombreuses variables nous parle de l’empreinte écologique, et les variables nous parlant du développemnt du pays sont moins nombreuses. On peuyt rééquilibrer l’importance des varaibles avec une méthodes vu en cours, la quelle ?\n\n\nOn souhaite identifier deux groupes de variables : les variables concernant l’empreinte carbone et les varaibles portant sur le développement du pays.\nFaites 2 ACP différentes sur chacun de ces deux groupes. Quelle est la première valeur propre dans les deux cas.\nRappelez en quoi la méthode mentionnée plus haut est une ACP particulière. A partir de la fonction PCA et en utilisant l’option col.w mettez en oeuvre cette méthode.\nOn peut le faire directement, avec la fonction ̀MFA de FactoMineR. Reprenez l’analyse précédente avec ce nouvel équilibre entre les différentes variables équilibrées. Quelles sont les informations que vous pouvez retenir ?"
  },
  {
    "objectID": "TP2.html#un-premier-aperçu-des-données",
    "href": "TP2.html#un-premier-aperçu-des-données",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Un premier aperçu des données",
    "text": "Un premier aperçu des données\n\nOuvrez le fichier QteVie.csv pour identifier le séparateur de champs, le séparateur décimale, la présence éventuelle d’une colonne d’identifiant, la présence éventuelle de noms de colonnes, l’encodage du fichier (pour gérer les accents). On souhaite conserver le nom des variables tel qu’il est dans le fichier de données (argument check.names ce qui nécessite de respecter l’encodage encoding.\nAvec des statistiques univariées, identifier la présence de pays atypiques.\nLes variables d’un même thème sont-elles corrélées?\nLes différents thèmes sont-ils corrélés?"
  },
  {
    "objectID": "TP2.html#choisir-une-démarche-danalyse",
    "href": "TP2.html#choisir-une-démarche-danalyse",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Choisir une démarche d’analyse",
    "text": "Choisir une démarche d’analyse\nVous disposez de différents outils pour aller au delà des analyses uni ou bivariées. Parmi ceux-ci, pouvez-vous faire un bilan rapide de différentes approches possibles et choisir celle (ou celles) qui vous semble la (les) plus pertinente(s) ?"
  },
  {
    "objectID": "TP2.html#mise-en-oeuvre",
    "href": "TP2.html#mise-en-oeuvre",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Mise en oeuvre",
    "text": "Mise en oeuvre\nRésumez dans le compte-rendu du TP les motifs qui vous ont fait choisir une méthode, les résultats principaux et les éléments qui vous permettent d’étayer ces résultats (éléments graphiques ou numériques).\nAttention on ne peut pas indiquer de variables quali supplémentraire dans MFA"
  },
  {
    "objectID": "TP4.html",
    "href": "TP4.html",
    "title": "Lab4 - Explorer un jeu de données complexes",
    "section": "",
    "text": "$$\n$$"
  },
  {
    "objectID": "TP4.html#objectifs-de-la-séance",
    "href": "TP4.html#objectifs-de-la-séance",
    "title": "Lab4 - Explorer un jeu de données complexes",
    "section": "Objectifs de la séance",
    "text": "Objectifs de la séance\nLe but de la séance est d’identifier les méthodes adéquates pour appréhender et visualiser un heu de données complexes. Vous pourrez puiser dans le panel des méthodes vues en cours pour extraire des information pertinentes du jeu de données sur la consommation énergétiques des EPCI ( Etablissements Publics de Coopération Intercommunale ) sur le territoire métropolitain en 2023.\nLes données sont disponibles sur ce lien Les variables disponibles dans ce jeu de données sont\nVoici une description concise des variables de la base conso2023_metro_dta :\n\nIdentification et informations géographiques\n\nId : Identifiant unique pour chaque observation.\nOPERATEUR : Nom ou code de l’opérateur énergétique responsable.\nCode.EPCI : Code officiel de l’Établissement Public de Coopération Intercommunale (EPCI).\nNom.EPCI : Nom de l’Établissement Public de Coopération Intercommunale.\nCode.Département : Code officiel du département.\nNom.Département : Nom du département.\nCode.Région : Code officiel de la région.\nNom.Région : Nom de la région.\n\n\n\nConsommation énergétique\n\nNb.sites : Nombre total de sites ou de compteurs pris en compte dans l’analyse.\nConso.totale..MWh. : Consommation totale d’énergie, exprimée en mégawattheures (MWh), incluant tous les usages résidentiels.\nConso.moyenne..MWh. : Consommation moyenne d’énergie par site ou unité (exprimée en MWh) (Conso.totale..MWh./ Nb.sites).\nPart.thermosensible…. : Proportion (%) de la consommation totale attribuée à des usages thermosensibles (chauffage, climatisation).\nConso.totale.à.usages.thermosensibles..MWh. : Consommation totale spécifique aux usages thermosensibles (en MWh).\nConso.totale.corrigée.de.l.aléa.climatique.à.usages.thermose : Consommation totale pour des usages thermosensibles corrigée des aléas climatiques (en MWh).\nConso.moyenne.à.usages.thermosensibles..MWh. : Consommation moyenne pour des usages thermosensibles (en MWh).\nConso.moyenne.corrigée.de.l.aléa.climatique.à.usages.thermos : Consommation moyenne pour des usages thermosensibles, corrigée des variations climatiques (en MWh), la consommation attendue si les températures avaient été les températeures moyennes attendues.\n\n\n\nCaractéristiques socio-démographiques et du logement\n\nNombre.d.habitants : Nombre total d’habitants dans la région ou le territoire.\nTaux.de.logements.collectifs : Proportion (%) de logements collectifs.\nTaux.de.résidences.principales : Proportion (%) de résidences principales parmi tous les logements.\nSuperficie.des.logements..30.m2 : Nombre de logements de moins de 30 m².\nSuperficie.des.logements.30.à.40.m2 : Nombre de logements entre 30 et 40 m².\nSuperficie.des.logements.40.à.60.m2 : Nombre de logements entre 40 et 60 m².\nSuperficie.des.logements.60.à.80.m2 : Nombre de logements entre 60 et 80 m².\nSuperficie.des.logements.80.à.100.m2 : Nombre de logements entre 80 et 100 m².\nSuperficie.des.logements..100.m2 : Nombre de logements de plus de 100 m².\n\n\n\nAnnée de construction des résidences principales\n\nRésidences.principales.avant.1919 : Nombre de résidences principales construites avant 1919.\nRésidences.principales.de.1919.à.1945 : Nombre de résidences principales construites entre 1919 et 1945.\nRésidences.principales.de.1946.à.1970 : Nombre de résidences principales construites entre 1946 et 1970.\nRésidences.principales.de.1971.à.1990 : Nombre de résidences principales construites entre 1971 et 1990.\nRésidences.principales.de.1991.à.2005 : Nombre de résidences principales construites entre 1991 et 2005.\nRésidences.principales.de.2006.à.2015 : Nombre de résidences principales construites entre 2006 et 2015.\nRésidences.principales.après.2016 : Nombre de résidences principales construites après 2016.\n\n\n\nModes de chauffage\n\nTaux.de.chauffage.électrique : Proportion (%) de logements utilisant le chauffage électrique.\n\nSur une maille géographique donnée (EPCI), l’énergie annuelle totale correspond au volume d’électricité consommée sur une année par l’ensemble des sites (compteurs) pour le secteur résidentiel; l’énergie annuelle moyenne correspond au volume d’électricité consommée sur une année par l’ensemble des sites divisée par le nombre de sites.\nLes données sont assemblées à partir du site data.gouv.fr et l’Observatoire des territoires.\nLes définitions des modes de calcul sont disponibles sur le site d’ENEDIS"
  },
  {
    "objectID": "TP4.html#quelques-remarques-préalables",
    "href": "TP4.html#quelques-remarques-préalables",
    "title": "Lab4 - Explorer un jeu de données complexes",
    "section": "Quelques remarques préalables",
    "text": "Quelques remarques préalables\n\nLes variables 20 à 25, donnent des effectifs par EPCI, ceci peut constituer une table de contingence, mais elles peuvent aussi être aggrégées à l’échelle du département pour construire des profils de département.\nla même remarque peut être faite pour les variables 26 à 32."
  },
  {
    "objectID": "TP4.html#quelques-pistes",
    "href": "TP4.html#quelques-pistes",
    "title": "Lab4 - Explorer un jeu de données complexes",
    "section": "Quelques pistes",
    "text": "Quelques pistes\nCes données permmettent d’extraire des informations en rapport avec différente question.\n\nPeut on faire des typologies de département en terme d’habitat ?\nCes données permettent-elles de faire des hypothèses sur le lien entre type d’habitat et consommation ? ou entre vétusté du parc immobilier et consommation ?\n\nPlusieurs pistes d’utilisation des méthodes factorielles sont envisageables, elles vont permettre de mettre en lumière différents aspects.\nDans le cas ou vous décideriez de faire une ACP, la question du poids des individus se posent. Selon que l’on pondère les données d’un EPCI par le nombre d’habitants ou non, la vision que l’on a de la consommation énergétique n’est pas la même. Discuter de l’intérêt de l’un ou de l’autre."
  },
  {
    "objectID": "proj_sur_SVD.html#la-décomposition-en-valeurs-sigulières",
    "href": "proj_sur_SVD.html#la-décomposition-en-valeurs-sigulières",
    "title": "Singular Value Decomposition et ACP",
    "section": "La décomposition en valeurs sigulières",
    "text": "La décomposition en valeurs sigulières\n\\[\\boldsymbol{X} = \\boldsymbol{U}\\boldsymbol{D}\\boldsymbol{V^\\intercal},\\]\noù * \\(\\boldsymbol{U}\\) est une matrice \\(n\\times n\\) orthogonale \\(\\boldsymbol{U} \\boldsymbol{U}^\\intercal = \\boldsymbol{I}_n,\\) * \\(\\boldsymbol{V}\\) est une matrice \\(d\\times d\\) orthogonale \\(\\boldsymbol{V} \\boldsymbol{V}^\\intercal = \\boldsymbol{I}_d,\\) * \\(\\boldsymbol{D}\\) est une matrice \\(n \\times d\\), diagonale au sens où seuls les termes \\(D_{ii}\\) sont non nuls.\n\n\n\n\n\n\n\n\n\nFigure 1: SVD et Changement de Base"
  },
  {
    "objectID": "references_maf.html",
    "href": "references_maf.html",
    "title": "References",
    "section": "",
    "text": "liste &lt;- \n  readLines('MAF.bib') |&gt; \n  as_tibble() |&gt; \n  filter(stringr::str_detect(value, pattern = '@|keywords')) |&gt; \n  rowid_to_column() %&gt;% \n  mutate(int_part = floor((rowid-1)/2), parity = rowid %% 2) %&gt;% \n  select(-rowid) %&gt;% \n  pivot_wider( values_from = value, names_from = parity, names_prefix = \"key\") |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = '@[:alnum:]+\\\\{')) |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = ',')) \n  \nMAF_liste &lt;- liste %&gt;% \n  filter(str_detect(key0, 'MAF')) %&gt;% \n  select(key1) %&gt;% \n  pull()\n\nNoCite(bib = myBib, MAF_liste)"
  },
  {
    "objectID": "references_maf.html#pour-approfondir-ou-compléter-le-cours",
    "href": "references_maf.html#pour-approfondir-ou-compléter-le-cours",
    "title": "References",
    "section": "Pour approfondir ou compléter le cours",
    "text": "Pour approfondir ou compléter le cours\nCornillon, P., A. Guyader, F. Husson, et al. (2013). Statistiques avec R. Rennes (Presses universitaires de).\nEscofier, B. and J. Pagès (1998). “Analyses factorielles simples et multiples”. In: Dunod, Paris 284, pp. 104-107.\nGégout-Petit, A., M. Maumy-Bertrand, G. Saporta, et al. (2022). Données manquantes. Editions Technip.\nHusson, F. (1999a). Chaîne Youtube. URL: https://www.youtube.com/user/HussonFrancois.\nHusson, F. (1999b). MOOC sur l’analyse de données. URL: https://husson.github.io/MOOC_AnaDo/index.html.\nHusson, F., S. Lê, and J. Pagès (2016). Presses universitaires de Rennes."
  }
]
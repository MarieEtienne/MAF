[
  {
    "objectID": "TP1.html",
    "href": "TP1.html",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "",
    "text": "$$\n$$"
  },
  {
    "objectID": "TP1.html#préparation-de-lenvironnement",
    "href": "TP1.html#préparation-de-lenvironnement",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Préparation de l’environnement",
    "text": "Préparation de l’environnement\n\nOuvrir un navigateur web et se connecter au serveur de calcul.\nCréer un Projet (File –&gt; New Project) ou bien en cliquant en haut à droite. Le travail par projet facilite l’accès aux données (notamment lorsque l’on passe d’un ordinateur à l’autre) et permet surtout de “zapper” d’un projet à un autre.\nChoisissez Créer un projet depuis un Nouveau Repertoire, nommez le MAF_TD1 (comme toujours en programmation on évite les caractères spéciaux, c’est-à-dire, les accents, les espaces entre autres)\nPour pouvoir garder le code et l’interprétation des résultats au même endroit nous allons utiliser un type de document Quarto qui est adapté pour mélanger code et texte. Quarto accepte du code R mais aussi Python et Julia. Créer un fichier TP1_Exo1.qmd. Vous pouvez utiliser le fichier d’exemple.\nPassez en mode source(en haut à gauche) au lieu de Visual ceci permet de mieux comprendre la structure d’un document quarto."
  },
  {
    "objectID": "TP1.html#structure-document-quarto",
    "href": "TP1.html#structure-document-quarto",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Structure Document Quarto",
    "text": "Structure Document Quarto\nUn document Quarto se divise en plusieurs sections clés qui facilitent l’organisation de l’analyse, l’intégration de code, et la présentation des résultats. Voici une présentation des principales composantes :\n\nEn-tête YAML\nC’est la section de métadonnées du document. Elle est située en haut du fichier et est encadrée par des lignes —. On y définit des informations essentielles telles que : title : le titre du document ; author : l’auteur ou les auteurs du document ; date : la date de création, qui peut être dynamique avec R, par exemple en utilisant date: “r Sys.Date()” ; format : le format de sortie (HTML, PDF, Word, revealjs pour les présentations, etc.).\nExemple d'en-tête YAML :\n\n---\ntitle: \"Analyse de Données avec R\"\nauthor: \"Votre Nom\"\ndate: \"`r Sys.Date()`\"\nformat: html\n---\n\n\n\nTexte en Markdown\nLa rédaction du texte dans Quarto utilise la syntaxe Markdown pour structurer le contenu de manière simple et lisible. Markdown permet de formater le texte (titres, listes, liens, etc.) sans avoir à écrire du code complexe. Par exemple :\nExemple :\n\n## Introduction\nCe document présente une analyse de données en utilisant **R**.\n- Point 1\n- Point 2\n\nLe markup langage markdown permet aussi d’insérer des formules mathématiques, comme du latex.\n\n\nBlocs de Code\nQuarto permet d’intégrer du code R (mais aussi Python, et Julia) grâce à des blocs de code, chunks. Les blocs de code sont délimités par trois accents graves (triple backtick), avec le langage spécifié entre accolades ({}). Les blocs peuvent exécuter du code directement dans le document et afficher les résultats en ligne.\nExemple de bloc de code en R :\nLes options de rendu du bloc de code peuvent être précisées. Par exemple ici * #| echo: true permet de montrer le code * #| eval: false permet de ne pas executer le code\nUne présentation plus complète des options, pour un rendu plus fin est disponible sur le site de Quarto.\nLe bloc peut être défini en tapant * manuellement les triples backticks, * ou en utilisant le menu Code –&gt; Insert Chunk, * ou avec le raccourci CTRL + ALT + i\n\n\nRendu et Exportation du Document\nUne fois le document terminé, on peut le rendre dans le format souhaité en utilisant la commande suivante dans le terminal quarto render mon_document.qmdou en cliquant sur Render dans RStudio.\nCette commande crée une version finalisée du document dans le format spécifié (HTML, PDF, etc.).\nAvec Quarto on peut tout autant faire des slides, des rapports en pdf, en word etc. Ceci permet de s’assurer que les résulats présentés sont ceux de l’analyse et c’est un premier pas important dans le sens d’assurer plus de reproductibilité en science. (d’autres outils sont utiles voir ici )\nC’est très utile en TP puisque vous pouvez commenter les analyses proposées, les résultats obtenus directement dans le fichier qui contient les codes permettant d’obetenir ces résultats.\nPlus largement, en suivant cette structure, vous pouvez organiser vos analyses de manière professionnelle et claire.\n\n\nCréation du document\nLors de la mise en place de l’analyse, on peut éxécuter chaque chunk avec le raccourci CTL + Enter, ou en cliquant sur la petite flèxche verte en haut à droite du chunk."
  },
  {
    "objectID": "TP1.html#comprendre-les-données",
    "href": "TP1.html#comprendre-les-données",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Comprendre les données",
    "text": "Comprendre les données\n\nImportation\nNous allons importer les données et les manipuler en utiliser les possibilités de la suite de package tidyverse. Les données sont disponibles sur ce lien\n\nlibrary(tidyverse) # Pour la manipulation de données\ndonnees_sols &lt;- read.table(\"https://marieetienne.github.io/datasets/donnees_sols.txt\",\n                           sep = \";\", # separateur de champs\n                           header = TRUE, # 1ere ligne donne le nom des colonnes\n                           encoding = \"UTF-8\")  # Encodage initial du fichier\n\nLe jeu de données donnees_sols regroupe donc les mesures chimiques surtous les types de sols. Les auteurs précisent le préfixe Exc signifie échangeable et le préfixe P signifie Available.\n\n\nUne première exploration\nProposer des résumés univariés de chaque variable présente dans le jeu de données.\n\nCombien y a t-il de variables quantitatives / qualiltatives?\nCombien d’échantillons sont mesurés par site ?\nSont-ils tous prélevés à la même profondeur ?\nQuel est le pH moyen tout site/Sol et Profondeur confondu ?\nChercher le sens de chaque variable.\nAv.P Phospore disponible\nC Carbone\nN Azote\nNO3 Nitrate\nNH4 Amonium\nExc.Ac Actinium Echangeable\nExc.Al Aluminium Echangeable\nExc.Ca Calcium Echangeable\nExc.Mg Magnésium 2changeable\nExc.K Potassium échangeable\nExc.Na Sodium échangeable\nExc.Cations Cations (ions chargés positivement) échangeables\nSatBase Taux de Saturation du sol\nArgile pourcentage d’argile dans le sol,\nLimon pourcentage de Limon dans le sol,\nSable pourcentage de sable dans le sol.\nQuelle la variance de la teneur en Eau ? Quelle est la variance de la teneur en Sodium (Na) ?\n\n\n\nReprésentation bivariée\nPour appréhender le jeu de données, il est utile de commencer par comprendre les relations deux à deux entre les variables. On peut commencer par la corrélation entre celles-ci\nEn utilisant le package GGallyet notamment la fonction ggpairs, proposer une représentation bivariée des différents couples de variables.\nLa visualisation est difficile, d’où l’intérêt d’une approche multivariée."
  },
  {
    "objectID": "TP1.html#approche-factorielle",
    "href": "TP1.html#approche-factorielle",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Approche factorielle",
    "text": "Approche factorielle\nLe but est de faire émerger des typologies de sol. Pour le moment nous mettons de coté les variables qualitatives.\n\nMise en place de l’approche factorielle\n\nComment décider le poids attribuer à chaque individu ?\n\n\n\nQuelle distance entre variables choisir ?\n\n\n\nQuelles varaibles choisissez vous de considérer comme supplémentaires (qualitative et ou quantitative)\n\n\n\nQuelle doit être l’inertie du nuage ?\n\n\nCes choix étant faits, on peut lancer une analyse en composante principale.\n\n\nACP “à la main”\nL’ACP consiste à construire une nouvelle base de \\({\\mathbb{R}}^p\\) pour représenter les individus.\n\nCombien vaut \\(p\\) ici ?\nCette base est formée des veteurs propres d’une matrice. De quelle matrice parle-t-on ?\n\n\n\nA l’aide de la fonction eigen représenter la suite décroissante des valeurs propres. A partir de combien de vecteurs de base considérez-vous que l’information apportée devient négligeable?\n\nPour réaliser l’ACP, on utilise deux packages FactomineR qui fait les calculs et factoextrapour des sorties plus agréables\n\nlibrary(FactoMineR)\nlibrary(factoextra)\n\nVous pouvez maintenant lancer l’ACP sur le jeu de données du sol.\n\nsols.pca &lt;- PCA(X = donnees_sols,\n    scale.unit = , ## ACP normée ou non ? \n    ncp = , ## nombre de composantes principales à garder, dans le doute on garde tout\n    ind.sup = , ## numero des lignes des individus supplémentaires\n    quanti.sup = , ## numero des colonnes des variables quanti sup\n    quali.sup = , ## numero des colonnes des variables quanti sup\n    row.w = , ## poids des individus\n    col.w = , ## poids des variables \n    graph = , ## TRUE or FALSe doit on sortir les graphes\n    axes = ,  ## pour quels axes \n    )\n\n\nsols.pca &lt;- PCA(X = donnees_sols[, -2],\n    scale.unit = TRUE, ## ACP normée ou non ? \n    ncp = 18, ## nombre de composantes principales à garder, dans le doute on garde tout\n    quali.sup = c(1,2), ## numero des colonnes des variables quali sup\n    graph = FALSE\n    )\n\n\nIndiquer comment est construit l’objet sols.pca et détailler ce qu’il contient.\nA l’aide de la commande sols.pca$eig, visualisez le pourcentage d’information expliqué par chaque composante principale (ou nouvelle colonne). Comparer avec ce qui a été trouvé “à la main”. Les vecteurs propres sont disponibles dans sols.pca$svd$V, comparer également les deux premiers axes principaux et les vecteurs propres trouvés à la main."
  },
  {
    "objectID": "TP1.html#mise-en-oeuvre-pratique-de-lacp-pour-analyse-des-données-de-sol",
    "href": "TP1.html#mise-en-oeuvre-pratique-de-lacp-pour-analyse-des-données-de-sol",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Mise en oeuvre pratique de l’ACP pour analyse des données de sol",
    "text": "Mise en oeuvre pratique de l’ACP pour analyse des données de sol\n\nReprésentez l’éboulis des valeurs propres à partir de la sortie sols.pca (ce qui a déjà été fait à la main précédemment).\n\n\nA partir de combien d’axes factoriels considérez vous que l’information apportée devient négligeable?\n\n\nVariables\nLe package factoextradonne des outils pour produire des sorties les plus lisibles possibles.\nPour représenter le cercle des corrélations dans un plan principal, on utilise la fonction fviz_pca_var. Sur chaque graphe, qu’est ce qui est représenté?\n\nPour plus de lisibilité, refaites le même graphique avec seulement les variables bien représentées (par exemple celles pour lesquelles le cos2 de l’angle entre la variable initiale et la variable projetée dans le plan représenté est supérieur à 0.8). Jouer sur les différentes repésentations pour bien comprendre quelle information est disponible sur chaque projection\n\nIl est important de noter qu’on peut grâce à resultat_acp, tracer ce graphique nous même et donc modifier son apparence à notre guise.\n\nAvec la fonction corrplot et l’objet sols.pca$var$cor, représentez les corrélations entre anciennes et nouvelles variables.\n\n\nQuel est l’intérêt du cercle de corrélation par rapport à ce dernier graphique?\n\n\n\nIndividus\nPour représenter la projection des individus dans un plan principal, on utilise la fonction fviz_pca_ind.\n\nDans la fonction fviz_pca_ind, en rajoutant col.ind = donnees_sols$Sol, coloriez les individus selon leur typologie de sol.\n\n\n\n\n\nReprésenter la projection des individus dans les premiers plans principaux. Quel plan vous semble bien distinguer les types de sol? Comment interprétez-vous alors les typologies de sols au vu des premières variables?\nFaites le même exercice avec les profondeurs et essayez d’interpréter quel(s) gradient(s) distingue(nt) bien les profondeurs?"
  },
  {
    "objectID": "TP1.html#comment-trouver-la-représentation-qui-discrimine-le-mieux-les-types-de-sol.",
    "href": "TP1.html#comment-trouver-la-représentation-qui-discrimine-le-mieux-les-types-de-sol.",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Comment trouver la représentation qui discrimine le mieux les types de sol.",
    "text": "Comment trouver la représentation qui discrimine le mieux les types de sol.\n\nQuelle méthode vous semble adaptée ?\nPouvez-vous proposer un métodologie pour la mettre en oeuvre"
  },
  {
    "objectID": "TP1.html#plan-de-létude",
    "href": "TP1.html#plan-de-létude",
    "title": "Labs1 - Analyse en composante Principale",
    "section": "Plan de l’étude",
    "text": "Plan de l’étude\n\nUne étude descriptive simple et bivariée pour identifier des individus atypiques, les variables les plus corrélées.\nMettre en place une ACP\n\nBien réfléchir aux variables actives et supplémentaires\nChoisir la métrique adaptée et les poids des individus.\nRéaliser l’ACP.\n\nInterprétation\n\nDiscuter la qualité de la représentation\nExpliquer ce qui est visible sur les différents plans factoriels\nCombien de plan factoriels vous semblent intéressants ?\nDonner un sens aux axes factoriels.\nIdentifier les disciplines qui se ressemblent (elles mettent en jeu les mêmes compétences physiques)\nQuelles sont les disciplines qui contribuent le plus au premier axe factoriel ?\nQuels sont les individus qui contribuent le plus à ce même premier axe ?\nComment le score est il lié aux différentes disciplines ?\nEst ce qu’un athlète qui est excellent au 100m, est aussi excellent au saut en longueur ?\n\nTechnique\n\nCalculer manuellenent (sans package) la corrélation entre les performances au 100m et le premier axe factoriel\nReconstruisez à la main les coordonnées des individus dans le premier plan factoriel\ncalculer à la main les contributions des différents individus"
  },
  {
    "objectID": "tp1_example.html",
    "href": "tp1_example.html",
    "title": "Eléments de correction pour le TD1",
    "section": "",
    "text": "Code\nknitr::opts_chunk$set(echo = TRUE, comment = NA, \n                      cache = TRUE, message = FALSE,\n                      warning = FALSE, eval = TRUE,\n                      fig.align = \"center\")"
  },
  {
    "objectID": "tp1_example.html#description-des-données",
    "href": "tp1_example.html#description-des-données",
    "title": "Eléments de correction pour le TD1",
    "section": "Description des données",
    "text": "Description des données\n\nChargement des packages\n\n\nCode\nlibrary(tidyverse)\nlibrary(FactoMineR)\n\n\nPour ajouter un chunk R CTL + Alt + i\n\n\nImportation des données\n\n\nCode\ndta &lt;- read.table(file = \"https://marieetienne.github.io/datasets/donnees_sols.txt\", sep = \";\", header = TRUE)\n\n\n\n\nDescription des données\n\n\nCode\n# str(dta)\ndta &lt;- dta %&gt;% mutate(Sol = as.factor(Sol),\n               Site = as.factor(Site),\n               Profondeur = factor(Profondeur), levels(c('Superficiel', 'Intermediaire', 'Profond'))) %&gt;% \n  mutate(Profondeur = relevel(Profondeur, ref= \"Superficiel\"))\n summary(dta)\n\n\n       Sol            Site             Profondeur        pH       \n Alluvial:180   292-11_A:  3   Superficiel  :179   Min.   :3.400  \n Dunaire :180   292-11_B:  3   Intermediaire:180   1st Qu.:4.400  \n Grès    :179   292-11_H:  3   Profond      :180   Median :4.670  \n                292-11_M:  3                       Mean   :4.632  \n                292-11_N:  3                       3rd Qu.:4.880  \n                292-11_O:  3                       Max.   :5.700  \n                (Other) :521                                      \n      Eau             Av.P              C                N          \n Min.   :0.170   Min.   : 0.380   Min.   :0.1400   Min.   :0.01000  \n 1st Qu.:1.540   1st Qu.: 1.940   1st Qu.:0.5200   1st Qu.:0.05000  \n Median :2.490   Median : 3.160   Median :0.8000   Median :0.07000  \n Mean   :2.698   Mean   : 4.132   Mean   :0.9706   Mean   :0.08056  \n 3rd Qu.:3.740   3rd Qu.: 5.235   3rd Qu.:1.2800   3rd Qu.:0.10000  \n Max.   :8.110   Max.   :51.290   Max.   :5.5900   Max.   :0.31000  \n                                                                    \n      NO3              NH4             Exc.Ac           Exc.Al     \n Min.   : 0.000   Min.   : 0.000   Min.   : 0.250   Min.   :0.030  \n 1st Qu.: 0.400   1st Qu.: 1.655   1st Qu.: 1.990   1st Qu.:1.370  \n Median : 1.510   Median : 3.190   Median : 3.420   Median :2.720  \n Mean   : 2.722   Mean   : 5.044   Mean   : 3.781   Mean   :3.151  \n 3rd Qu.: 2.965   3rd Qu.: 6.920   3rd Qu.: 5.205   3rd Qu.:4.475  \n Max.   :23.600   Max.   :40.430   Max.   :10.570   Max.   :9.720  \n                                                                   \n     Exc.Ca            Exc.Mg           Exc.K            Exc.Na       \n Min.   : 0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  \n 1st Qu.: 0.0400   1st Qu.:0.0700   1st Qu.:0.0500   1st Qu.:0.03000  \n Median : 0.0800   Median :0.2100   Median :0.1100   Median :0.05000  \n Mean   : 0.3029   Mean   :0.6194   Mean   :0.1386   Mean   :0.05237  \n 3rd Qu.: 0.1900   3rd Qu.:0.8200   3rd Qu.:0.1700   3rd Qu.:0.07000  \n Max.   :13.4900   Max.   :5.3300   Max.   :1.3000   Max.   :0.27000  \n                                                                      \n  Exc.Cations        SatBase          Argile          Limon      \n Min.   : 0.380   Min.   : 1.80   Min.   : 8.00   Min.   : 0.00  \n 1st Qu.: 2.405   1st Qu.: 7.95   1st Qu.:16.00   1st Qu.:10.00  \n Median : 4.030   Median :13.24   Median :21.00   Median :13.00  \n Mean   : 4.895   Mean   :18.51   Mean   :23.76   Mean   :16.13  \n 3rd Qu.: 6.765   3rd Qu.:24.67   3rd Qu.:32.00   3rd Qu.:21.50  \n Max.   :17.300   Max.   :97.54   Max.   :53.00   Max.   :47.00  \n                                                                 \n     Sable     \n Min.   :15.0  \n 1st Qu.:47.0  \n Median :67.0  \n Mean   :60.1  \n 3rd Qu.:74.0  \n Max.   :87.0  \n               \n\n\nCode\nnobs &lt;- nrow(dta)\np &lt;- ncol(dta)\nany(is.na(dta))\n\n\n[1] FALSE\n\n\nCode\nsummary(dta$Profondeur)\n\n\n  Superficiel Intermediaire       Profond \n          179           180           180 \n\n\nLe fichier de données a 539 lignes et 21colonnes.\nil n’y a pas de données manquantes\n\n\nCode\ndta %&gt;% \n  ggplot() + \n  aes(x= Profondeur, y = Argile) + \n  geom_boxplot() +\n  xlab('Classe de Profondeur')\n\n\n\n\n\n\n\n\n\nCode\nboxplot(dta$Argile~ dta$Profondeur)\n\n\n\n\n\n\n\n\n\nLa somme des variables Limon, Argile et Sable devrait sommer à 100, mais ce n’est pas le cas à cause des erreurs d’arrondi\n\n\nCode\ndta %&gt;% \n  mutate(Total = Limon + Argile + Sable)  %&gt;% \n  select(Total)\n\n\n    Total\n1     100\n2     100\n3      99\n4     100\n5     100\n6     100\n7     100\n8     100\n9     100\n10    100\n11    100\n12    101\n13    100\n14    100\n15    100\n16    100\n17    100\n18    100\n19    100\n20     99\n21    100\n22     99\n23    100\n24    100\n25    100\n26     99\n27    100\n28     99\n29    100\n30    101\n31    100\n32    100\n33    100\n34    100\n35    100\n36     99\n37    100\n38    100\n39    100\n40    100\n41    101\n42    100\n43    101\n44    100\n45    101\n46    100\n47    100\n48    100\n49    100\n50    100\n51    100\n52    100\n53    100\n54     99\n55    100\n56    101\n57    100\n58    101\n59    101\n60    100\n61    101\n62    101\n63    101\n64    101\n65    100\n66     99\n67    100\n68    100\n69    101\n70    100\n71    100\n72    100\n73    100\n74    100\n75    100\n76    100\n77    100\n78    100\n79    100\n80    100\n81    100\n82    100\n83    101\n84     99\n85    101\n86    100\n87    100\n88    100\n89    101\n90    100\n91    101\n92     99\n93    100\n94    100\n95    100\n96    100\n97    100\n98    100\n99    100\n100   100\n101   100\n102   100\n103    99\n104   100\n105    99\n106   100\n107    99\n108   100\n109    99\n110   100\n111    99\n112   100\n113   100\n114   100\n115   100\n116   100\n117   100\n118   100\n119    99\n120   100\n121   100\n122   100\n123   100\n124    99\n125    99\n126   100\n127   100\n128   100\n129    99\n130   101\n131    99\n132   100\n133   100\n134   100\n135   100\n136    99\n137   100\n138   100\n139   101\n140   100\n141   100\n142    99\n143   100\n144    99\n145   101\n146    99\n147   100\n148   100\n149   100\n150    99\n151   100\n152    99\n153   100\n154   100\n155   100\n156   100\n157   100\n158   100\n159    99\n160   100\n161    99\n162   100\n163   101\n164   100\n165   100\n166    99\n167   100\n168   101\n169   100\n170   101\n171   100\n172    99\n173   100\n174   101\n175   100\n176   101\n177   100\n178   100\n179   100\n180   100\n181   100\n182   100\n183   100\n184    99\n185   100\n186   100\n187   100\n188   100\n189   100\n190    99\n191   100\n192   101\n193   100\n194   101\n195    99\n196   100\n197    99\n198   100\n199   101\n200   100\n201   100\n202    99\n203   100\n204   100\n205    99\n206   100\n207   101\n208   100\n209   101\n210   100\n211   100\n212   100\n213    99\n214   100\n215    99\n216   100\n217   100\n218   100\n219   100\n220   100\n221   100\n222   100\n223   100\n224   100\n225   100\n226   100\n227   100\n228   100\n229   101\n230   100\n231   100\n232   100\n233   100\n234   100\n235   100\n236   100\n237   100\n238   100\n239   100\n240   100\n241   100\n242   100\n243   101\n244   100\n245   101\n246   100\n247   100\n248   100\n249   100\n250   100\n251   100\n252   100\n253   100\n254   100\n255   100\n256   100\n257   100\n258   100\n259   100\n260   100\n261    99\n262   100\n263    99\n264   100\n265   100\n266   100\n267    99\n268   100\n269    99\n270   100\n271   100\n272   100\n273   100\n274   100\n275   100\n276   100\n277    99\n278   100\n279   100\n280   100\n281   100\n282   100\n283   100\n284   100\n285   100\n286    99\n287   100\n288   100\n289   100\n290   100\n291    99\n292   100\n293    99\n294   101\n295   100\n296   101\n297   100\n298   100\n299   100\n300   101\n301   100\n302   101\n303   100\n304   100\n305   100\n306   100\n307   101\n308   100\n309   100\n310   100\n311   100\n312   100\n313   101\n314   100\n315   101\n316   100\n317   101\n318   100\n319   100\n320   100\n321   100\n322   100\n323   100\n324   100\n325   100\n326   100\n327   100\n328   100\n329   100\n330   100\n331   100\n332   100\n333    99\n334   100\n335    99\n336   100\n337   101\n338   100\n339   100\n340   100\n341   100\n342   100\n343   100\n344   100\n345   100\n346   100\n347   100\n348   100\n349   100\n350   100\n351   101\n352   100\n353   101\n354   100\n355   100\n356   100\n357   100\n358   100\n359   100\n360   100\n361   100\n362   100\n363   100\n364   101\n365   100\n366   100\n367   101\n368   100\n369   100\n370   100\n371   100\n372    99\n373   100\n374    99\n375   100\n376   100\n377   100\n378   101\n379   100\n380   101\n381   100\n382   100\n383   100\n384    99\n385    99\n386    99\n387   100\n388   100\n389   100\n390   100\n391   100\n392   100\n393   100\n394   100\n395   100\n396   100\n397   100\n398   100\n399   100\n400   100\n401   100\n402   100\n403   100\n404   100\n405   100\n406   100\n407   100\n408    99\n409   100\n410    99\n411   100\n412    99\n413   100\n414   100\n415   100\n416   100\n417   100\n418   101\n419   100\n420   100\n421   100\n422   100\n423   100\n424   100\n425   100\n426   100\n427   100\n428   100\n429   100\n430   100\n431   100\n432   100\n433   100\n434   100\n435   100\n436   100\n437   100\n438   100\n439   100\n440   100\n441   100\n442   100\n443   100\n444   100\n445   101\n446   100\n447   100\n448   100\n449   100\n450   101\n451   100\n452   101\n453    99\n454   100\n455    99\n456   100\n457   100\n458   100\n459   101\n460   100\n461   101\n462   100\n463   100\n464   100\n465   101\n466   100\n467   101\n468   100\n469   100\n470   100\n471   100\n472   100\n473   100\n474   101\n475   100\n476   101\n477   100\n478   101\n479   100\n480   100\n481   100\n482   100\n483   100\n484   100\n485   100\n486   100\n487   100\n488   100\n489    99\n490    99\n491    99\n492   100\n493   101\n494   100\n495    99\n496   100\n497    99\n498   100\n499   100\n500   100\n501   100\n502   100\n503   100\n504   100\n505   100\n506   100\n507   100\n508   101\n509   100\n510   100\n511   100\n512   100\n513    99\n514   101\n515    99\n516   100\n517   101\n518   100\n519   100\n520   100\n521   100\n522    99\n523   100\n524    99\n525   100\n526   100\n527   100\n528   100\n529   101\n530   100\n531   101\n532   100\n533   101\n534   100\n535   100\n536   100\n537    99\n538   100\n539    99\n\n\nOn peut s’interesser aux corrélations entre les variables\n\n\nReprésentation"
  },
  {
    "objectID": "tp1_example.html#identifier-une-typologie-de-sol",
    "href": "tp1_example.html#identifier-une-typologie-de-sol",
    "title": "Eléments de correction pour le TD1",
    "section": "Identifier une typologie de sol",
    "text": "Identifier une typologie de sol\nPour visualiser les données on peut commencer par une ACP\n\nsur les variables quantitatives uniquement\n\n\n\nCode\nX &lt;- dta %&gt;% \n  select(where(is.numeric)) %&gt;% as.matrix()\ndim(X)\n\n\n[1] 539  18\n\n\n\nPoids des individus\nOn va prendre les mêmes poids pour tous les individus soit \\(1/n\\).\nLes poids sont stockés dans la matrice \\(W\\)\n\n\nDistance à utiliser entre les individus\nOn commence par une distance euclidienne. La matrice de distance \\(M\\) est l’identité\nLe cours dit\n\nl’inertie vaut \\(tr(X^\\top W X M)\\)\nOn va chercher les valeurs et vecteurs propres de la matrice \\(X^\\top W X M\\)\n\nSi on fait une ACP non normée le sable et SatBase contribuent beaucoup plus à la formation des axes que les autres variables.\n\n\nCode\ndta_pca &lt;- PCA(X = dta, scale.unit = FALSE, quali.sup = c(1,2,3), ncp = 18)\n#library(Factoshiny)\n\n\nPour rééquilibrer le poids des variables dans la construction des projections, on propose une ACP normée.\nPour voir comment l’information d’une variable se disperse sur les différentes dimensions on peut regarder la contribution de cette variable à la construction des différents axes.\nPar exemple pour le PH\n\n\nCode\nround(dta_pca$var$contrib[1,],2)\n\n\n Dim.1  Dim.2  Dim.3  Dim.4  Dim.5  Dim.6  Dim.7  Dim.8  Dim.9 Dim.10 Dim.11 \n  0.00   0.00   0.02   0.00   0.21   0.25   0.91   0.11   1.13   2.78  26.47 \nDim.12 Dim.13 Dim.14 Dim.15 Dim.16 Dim.17 Dim.18 \n  0.31  57.55  10.24   0.02   0.00   0.00   0.00 \n\n\nOn peut mettre en place une ACP normée en précisant simple scale.unit = TRUE, ce qui est le comportement par défaut de la fonction `PC̀A ̀.\n\n\nCode\ndta_pca &lt;- PCA(X = dta, scale.unit = TRUE, quali.sup = c(1,2,3), ncp = 18)\n#library(Factoshiny)\n\n\nQualité globale des représentations\n\nsur le plan 1-2 : on représente 66.9241274\nsur le plan 1-3 : on représente 57.5578374\n\nAvec 3 axes on représente 77.1397764 de l’inertie.\nOn peut visualiser le cercle des corrélations\n\n\nCode\nplot.PCA(dta_pca,choix='var',\n         select='cos2  0.7',\n         unselect=0)\n\n\n\n\n\n\n\n\n\nA l’aide des contributions des différentes variables à la définition des axes, on peut comprendre l’information résumée par ces axes.\n\n\nCode\ndta_pca$var$contrib |&gt; as.data.frame() |&gt; arrange(-Dim.1) |&gt; select(Dim.1)\n\n\n                 Dim.1\nExc.Cations 10.7948976\nEau         10.2869537\nSable        8.9320337\nArgile       8.3692915\nExc.Mg       8.0680012\nN            7.6257192\nLimon        7.2482479\nExc.Ac       6.6410790\nExc.K        6.5019985\nExc.Al       6.3103633\nNO3          4.8972792\nExc.Na       4.0962613\nSatBase      3.6327958\nExc.Ca       2.8569555\nC            1.4042632\npH           1.2715181\nAv.P         0.6866580\nNH4          0.3756832\n\n\nCode\ndta_pca$var$contrib |&gt; as.data.frame() |&gt; arrange(-Dim.2)|&gt; select(Dim.2)\n\n\n                 Dim.2\nAv.P        18.3416002\nC           17.2698714\nExc.Al       9.8791351\nSatBase      9.3284152\nExc.Ac       7.1350777\nArgile       5.6487034\nExc.K        5.5144861\nSable        5.1690662\nN            4.9797246\npH           4.5458035\nExc.Ca       3.4929128\nLimon        3.3331633\nExc.Na       1.8388125\nExc.Cations  1.0983771\nNO3          0.8067869\nEau          0.5672494\nNH4          0.5379330\nExc.Mg       0.5128816\n\n\nCode\ndta_pca$var$contrib |&gt; as.data.frame() |&gt; arrange(-Dim.4) |&gt; select(Dim.4)\n\n\n                  Dim.4\nNH4         83.32422550\nAv.P         5.07745293\nExc.Ca       4.76531991\npH           3.47674191\nExc.K        1.04204242\nExc.Ac       0.54618975\nNO3          0.49368347\nLimon        0.22554066\nEau          0.22252392\nExc.Al       0.22067882\nC            0.20730224\nN            0.19798282\nSatBase      0.10528835\nExc.Mg       0.03464235\nSable        0.02775744\nExc.Cations  0.01430037\nArgile       0.01058951\nExc.Na       0.00773764\n\n\nLa description des axes * l’axe 1 parle de l’eau, des cations, du sable et de l’argile (et du limon) * l’axe 2 du phosphate et du carbone * petite remarque sur l’axe 4 qui est essentiellemnt NH4\n\n\nCode\ndta_pca$var$contrib |&gt; as.data.frame() |&gt; arrange(-Dim.1)\n\n\n                 Dim.1      Dim.2       Dim.3       Dim.4        Dim.5\nExc.Cations 10.7948976  1.0983771  0.03480337  0.01430037 4.188057e-01\nEau         10.2869537  0.5672494  1.31525251  0.22252392 1.241612e-03\nSable        8.9320337  5.1690662  1.34016866  0.02775744 1.475239e-01\nArgile       8.3692915  5.6487034  0.66996148  0.01058951 1.847004e-04\nExc.Mg       8.0680012  0.5128816  4.45586244  0.03464235 8.364634e+00\nN            7.6257192  4.9797246  0.01069421  0.19798282 9.445310e+00\nLimon        7.2482479  3.3331633  2.05875433  0.22554066 7.133881e-01\nExc.Ac       6.6410790  7.1350777  8.16655281  0.54618975 4.761044e-02\nExc.K        6.5019985  5.5144861  0.32713861  1.04204242 7.144207e+00\nExc.Al       6.3103633  9.8791351  4.68272487  0.22067882 1.511215e-01\nNO3          4.8972792  0.8067869  4.89089787  0.49368347 3.091713e+01\nExc.Na       4.0962613  1.8388125  8.24800274  0.00773764 2.455226e+01\nSatBase      3.6327958  9.3284152 11.55924831  0.10528835 6.504494e+00\nExc.Ca       2.8569555  3.4929128 20.07792776  4.76531991 4.503104e-01\nC            1.4042632 17.2698714  3.73651595  0.20730224 4.190173e+00\npH           1.2715181  4.5458035 21.62566216  3.47674191 6.850679e+00\nAv.P         0.6866580 18.3416002  1.63149855  5.07745293 5.566443e-02\nNH4          0.3756832  0.5379330  5.16833338 83.32422550 4.526169e-02\n                  Dim.6        Dim.7        Dim.8       Dim.9      Dim.10\nExc.Cations  2.48494588 2.638659e-02 1.717896e-02  3.46887901  0.81909567\nEau          1.51858452 1.697208e+00 2.648458e+00  0.54809897  0.05804883\nSable        0.33697321 5.287402e-04 4.659028e-02  4.05712341  1.02529020\nArgile       0.04353745 3.812684e-01 1.129776e-02  7.22184556  0.87015577\nExc.Mg       4.25793987 3.735044e+00 1.127911e+01  0.63724057 12.11220034\nN            0.65672497 5.566787e+00 6.368322e+00  0.89720121  4.15863023\nLimon        0.83311347 6.416099e-01 1.053778e-01 57.82600449 10.98536861\nExc.Ac       0.18507327 2.356086e-01 1.488297e-02  2.57408705  0.54611503\nExc.K        5.01659624 7.486751e+00 1.469425e+00  2.64378882  2.72585996\nExc.Al       0.02060726 1.597977e-01 5.753269e-04  2.56353316  0.21734094\nNO3         27.46088797 5.130396e+00 3.428301e-01  2.00631146 12.53278132\nExc.Na       7.15656695 2.682374e+01 1.837668e+01  1.37994935  5.84463872\nSatBase      0.89194522 1.251606e+00 9.536667e+00  0.29851968  2.85607098\nExc.Ca       7.45715705 1.482961e+01 6.664628e+00  9.27175715 20.94267392\nC           10.61725847 6.385827e+00 1.311118e+01  3.66149337  1.35319338\npH          11.22388389 2.112981e+01 2.328795e+01  0.03387108  0.27866698\nAv.P        16.00085911 4.473410e+00 8.920512e-01  0.70452160 22.42340546\nNH4          3.83734520 4.460218e-02 5.826795e+00  0.20577409  0.25046365\n                  Dim.11       Dim.12       Dim.13      Dim.14      Dim.15\nExc.Cations  0.475351285  6.790340716 4.689912e-04  4.19063317  0.38072817\nEau          1.030075448  2.669876322 8.381966e-01 66.57685395  9.89523952\nSable        0.001653793 10.720691455 1.904331e+00  0.22389600  2.23094321\nArgile       0.620111480 40.350300972 6.603893e+00  0.86902584  6.36143392\nExc.Mg       1.952950466 11.389774790 2.535660e+01  1.31465142  0.47047378\nN            0.011537034  7.881749297 6.640709e-01 13.14907175 37.96982697\nLimon        0.713985584  0.935792111 4.431672e-02  0.01823522  0.01585300\nExc.Ac       1.245609966  3.762674392 6.177288e+00  4.18254684  1.59099171\nExc.K       59.705766646  0.002482866 2.518258e-01  0.01370607  0.04066413\nExc.Al       0.653348920  1.472006310 6.624515e+00  6.61560972  0.14611545\nNO3          0.382084218  7.263458776 1.678187e-02  0.87045319  1.95128298\nExc.Na       0.203088210  0.104957676 9.538177e-01  0.29523508  0.09727814\nSatBase      4.210287564  3.441187546 4.495045e+01  0.29848568  1.13056013\nExc.Ca       0.437616155  0.745454395 1.234203e+00  0.70536231  0.10403308\nC            0.005393352  0.363276426 4.330111e-03  0.17196912 36.76815480\npH           1.318673838  1.987303729 1.761950e+00  0.42029513  0.70634400\nAv.P        26.896860661  0.068062495 2.554336e+00  0.06118856  0.04188870\nNH4          0.135605378  0.050609727 5.862521e-02  0.02278094  0.09818830\n                  Dim.16       Dim.17       Dim.18\nExc.Cations  9.561988769 2.326666e-03 5.942049e+01\nEau          0.126115816 8.562839e-06 1.501108e-05\nSable        0.081242444 6.375406e+01 1.220896e-04\nArgile       0.040458768 2.192791e+01 2.731744e-05\nExc.Mg       1.137262735 6.966794e-04 4.920035e+00\nN            0.415523180 1.120508e-03 3.939651e-06\nLimon        0.001099745 1.430012e+01 2.721474e-05\nExc.Ac      26.458425159 3.746262e-03 3.048644e+01\nExc.K        0.008574133 3.151276e-04 1.043719e-01\nExc.Al      60.275930843 6.586284e-03 9.523289e-06\nNO3          0.036851528 9.848034e-05 8.950844e-07\nExc.Na       0.013736881 1.187195e-04 7.115574e-03\nSatBase      0.003903661 6.784058e-05 9.750597e-06\nExc.Ca       0.902323662 4.275538e-04 5.061325e+00\nC            0.747672338 2.121981e-03 5.206150e-08\npH           0.080776017 6.806645e-05 1.052186e-07\nAv.P         0.090348837 1.920379e-04 1.558006e-06\nNH4          0.017765483 5.781532e-06 2.779483e-06\n\n\nCode\ndta_pca$var$contrib |&gt; as.data.frame() |&gt; arrange(-Dim.2) |&gt; select(Dim.2)\n\n\n                 Dim.2\nAv.P        18.3416002\nC           17.2698714\nExc.Al       9.8791351\nSatBase      9.3284152\nExc.Ac       7.1350777\nArgile       5.6487034\nExc.K        5.5144861\nSable        5.1690662\nN            4.9797246\npH           4.5458035\nExc.Ca       3.4929128\nLimon        3.3331633\nExc.Na       1.8388125\nExc.Cations  1.0983771\nNO3          0.8067869\nEau          0.5672494\nNH4          0.5379330\nExc.Mg       0.5128816"
  },
  {
    "objectID": "01_afm.html#quelques-exemples",
    "href": "01_afm.html#quelques-exemples",
    "title": "Analyse Factorielle Multiple",
    "section": "Quelques exemples",
    "text": "Quelques exemples\n\nOn (re)commence dans le DoubsNotes des élèvesAnalyse sensorielle\n\n\nOn a mesuré les caractéristiques physico chimiques sur 30 sites différents le long de la rivière Doubs.\n\n\nLes 4 premières lignes (parmi 30) du jeu de données doubs.env\n\n\n# A tibble: 30 × 11\n    das   alt   pen   deb    pH   dur   pho   nit   amm   oxy   dbo\n  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1   0.3   934  48    0.84   7.9    45  0.01  0.2   0     12.2   2.7\n2   2.2   932   3    1      8      40  0.02  0.2   0.1   10.3   1.9\n3  10.2   914   3.7  1.8    8.3    52  0.05  0.22  0.05  10.5   3.5\n4  18.5   854   3.2  2.53   8      72  0.1   0.21  0     11     1.3\n# ℹ 26 more rows\n\n\nOn mesure des caractéristiques physiques, des caractéristiques chimiques, des caractéristiques écologiques.\n\n\ndas : distance à la source ( \\(km\\) ),\nalt : altitude ( \\(m\\) )\npen : la pente (dénivelé pour 1000m)\ndeb : le débit () \\(m^3.s^{-1}\\) )\npH : le pH de l’eau,\ndur : la concentration en calcium ( \\(mg.L^{-1}\\) ),\npho : concentration en phosphate ( \\(mg.L^{-1}\\) ),\nnit : concentration en nitrate ( \\(mg.L^{-1}\\) ),\namn : concentration en ammonium ( \\(mg.L^{-1}\\) ),\noxy : concentration d’oxygène dissous ( \\(mg.L^{-1}\\) ),\ndbo : Demande biologique en oxygène ( \\(mg.L^{-1}\\) ).\n\n\nSi on travaille sur une ACP normée, puisqu’il ya 4 descripteurs pour les caractéristiques physiques, et seulement 2 pour les caractéristiques écologiques, les varaibles physiques auront par construction plus de poids que les variables écologiques.\n\n\nOn s’intéresse aux notes des 30 élèves d’une classe. Le tableau de note complet contient\n\n8 notes de mathématiques\n4 notes d’anglais\n3 notes d’histoire géographie\n3 notes de français\n1 note de dessin\n\nOn aimerait visualiser les notes à l’aide d’une méthode factorielle, notamment pour savoir si ce sont les mêmes élèves qui rencontrent des difficultés dans les différentes matières.\n\nOn normalise les données car les gammes de variation des notes dans les différentes matières sont assez différentes\nQue se passe-t-il si on fait une ACP normée ?\n\nLes mathématiques ont 8 fois plus de poids dans la détermination des axes que la note de dessin.\nEst ce vraiment ce qu’on veut ?\n(ça dépend qui “on” désigne)\n\n\nExemple tiré des cours de F. Husson\n10 vins blancs du Val de Loire : 5 Vouvray - 5 Sauvignon • descripteurs sensoriels : acidité, amertume, odeur agrume, etc.\n\n\n\nvins &lt;- read.table(\"https://husson.github.io/MOOC_AnaDo/AnaDo_JeuDonnees_VinsJury.csv\", \n      header=TRUE, sep=\";\",dec=\".\", row.names=1, check.names=FALSE, fileEncoding=\"latin1\")\nhead(vins, n= 4)\n\n                      cepage Int.av.agitation Int.ap.agitation Expression\nS Michaud          Sauvignon            7.750            8.000   7.142857\nS Renaudie         Sauvignon            7.125            7.625   7.000000\nS Trotignon        Sauvignon            7.125            7.375   7.142857\nS Buisse Domaine   Sauvignon            5.500            6.250   5.428571\n                    O.fruit O.passion O.agrume O.fruit.confit O.vanille\nS Michaud          4.250000  2.428571 5.714286      0.6666667 0.5000000\nS Renaudie         4.428571  3.142857 5.250000      0.6666667 0.5000000\nS Trotignon        5.142857  4.000000 5.250000      1.0000000 0.5000000\nS Buisse Domaine   4.250000  2.428571 3.571429      1.5000000 0.6666667\n                    O.boisee   O.champ O.vegetale O.florale O.alcool\nS Michaud          0.3333333 0.3333333   6.500000  6.571429 1.666667\nS Renaudie         0.3333333 0.3333333   6.125000  6.428571 3.400000\nS Trotignon        0.3333333 0.5000000   4.625000  5.142857 2.833333\nS Buisse Domaine   0.5000000 0.3333333   4.571429  5.750000 2.600000\n                   Typicite.olf.chenin Int.attaque   Sucree Acide Amere\nS Michaud                     2.333333    6.000000 3.500000 5.875 4.125\nS Renaudie                    1.125000    6.428571 3.285714 6.750 3.750\nS Trotignon                   0.625000    6.571429 3.000000 6.125 4.125\nS Buisse Domaine              2.571429    5.142857 3.875000 5.625 2.500\n                   Astringence Fraicheur Oxydation  Finesse\nS Michaud             1.428571     6.625 0.4285714 5.285714\nS Renaudie            2.333333     6.625 0.2857143 5.142857\nS Trotignon           2.375000     6.875 0.4285714 5.285714\nS Buisse Domaine      3.000000     6.250 0.4285714 4.571429\n                   Persistance.gustative Persistance.aromatique Int.couleur\nS Michaud                       7.142857               6.714286       5.000\nS Renaudie                      7.166667               6.571429       3.375\nS Trotignon                     6.142857               6.142857       3.000\nS Buisse Domaine                4.857143               5.142857       4.125\n                   Nuance.couleur Impression.surface O.Av.Intensite_E\nS Michaud                3.857143                2.5         5.361111\nS Renaudie               3.285714                2.6         5.138889\nS Trotignon              2.428571                2.8         5.277778\nS Buisse Domaine         4.285714                3.5         4.444444\n                   O.Ap.Intensite_E O.Alcool_E O.Vegetale_E O.Champignon_E\nS Michaud                  6.384507   4.121799     3.119488       2.722222\nS Renaudie                 5.966049   4.002137     2.916667       2.416667\nS Trotignon                5.972222   3.805556     3.000000       2.916667\nS Buisse Domaine           5.333333   4.333333     3.305556       2.361111\n                   O.Fruitpassion_E O.Typicite_E G.Intensite_E Sucree_E\nS Michaud                  4.916667     5.861111      5.444444 4.861111\nS Renaudie                 6.027778     5.638889      5.444444 4.666667\nS Trotignon                6.111111     5.055556      5.094377 5.055556\nS Buisse Domaine           5.083333     5.916667      4.722222 4.916667\n                    Acide_E  Amere_E Astringent_E G.Alcool_E Equilibre_E\nS Michaud          5.194444 4.027778     3.694444   5.250000    5.194444\nS Renaudie         5.277778 3.527778     3.527778   4.916667    4.750000\nS Trotignon        4.916667 3.583333     3.708656   4.805556    5.222222\nS Buisse Domaine   4.750000 3.750000     3.388889   4.972222    4.750000\n                   G.Typicite_E O.Av.Intensite_C O.Ap.Intensite_C O.Alcool_C\nS Michaud              5.416667         4.045455         5.200166   4.087040\nS Renaudie             5.500000         5.318182         6.000000   3.492589\nS Trotignon            5.361111         5.590909         6.090909   3.681818\nS Buisse Domaine       5.342321         4.136364         5.000000   4.227273\n                   O.Vegetale_C O.Champignon_C O.Fruitpassion_C O.Typicite_C\nS Michaud              4.636364       4.490000         5.090909     4.488404\nS Renaudie             4.454545       3.909091         6.454545     4.636364\nS Trotignon            4.590909       2.272727         6.954545     4.889068\nS Buisse Domaine       4.454545       3.636364         4.272727     4.727273\n                   G.Intensite_C Sucree_C  Acide_C  Amere_C Astringent_C\nS Michaud               4.500000 4.772727 4.409091 5.136364     4.272727\nS Renaudie              5.181818 5.363636 5.409091 4.318182     4.545455\nS Trotignon             5.045455 4.863636 5.090909 4.727273     5.727273\nS Buisse Domaine        4.318182 5.363636 4.909091 4.545455     4.636364\n                   G.Alcool_C Equilibre_C G.Typicite_C Juge1 Juge2 Juge3 Juge4\nS Michaud            5.090909    5.189683     5.000000     7   5.5   2.5     1\nS Renaudie           5.045455    5.090909     4.636364     6   5.5   2.5     2\nS Trotignon          4.603636    5.090909     4.772727     3   4.0   3.0     3\nS Buisse Domaine     4.909091    4.181818     4.272727     6   4.0   2.0     1\n                   Juge5 Juge6 Juge7 Juge8 Juge9 Juge10 Juge11 Juge12 Juge13\nS Michaud            5.0   3.5   4.5     1     1      1    2.5      5      1\nS Renaudie           3.5   1.0   3.5     2     8      1    2.5      5      1\nS Trotignon          4.5   2.0   4.0     2     6      4    2.0      8      1\nS Buisse Domaine     3.0   3.0   3.5     4     7      2    2.0      4      1\n                   Juge14 Juge15 Juge16 Juge17 Juge18 Juge19 Juge20 Juge21\nS Michaud               4    3.0      1    2.0    6.0    5.5    3.5      1\nS Renaudie              5    4.0      1    1.5    4.0    4.5    2.5      2\nS Trotignon             5    4.5      6    3.0    7.5    5.5    3.5      2\nS Buisse Domaine        6    3.0      3    4.0    3.0    2.5    2.5      6\n                   Juge22 Juge23 Juge24 Juge25 Juge26 Juge27 Juge28 Juge29\nS Michaud             2.5      5    4.5      4    3.0    1.5    2.0    1.5\nS Renaudie            3.5      2    1.0      4    3.0    2.5    2.5    1.5\nS Trotignon           2.5      4    3.0      5    4.5    3.5    2.5    1.5\nS Buisse Domaine      1.5      1    3.0      4    3.5    3.0    2.0    2.0\n                   Juge30 Juge31 Juge32 Juge33 Juge34 Juge35 Juge36 Juge37\nS Michaud             3.5    2.0    4.5    6.5    2.5      3    3.5      2\nS Renaudie            5.0    2.0    2.0    6.0    2.5      8    1.5      2\nS Trotignon           5.0    2.5    5.5    6.0    4.0      6    4.0      5\nS Buisse Domaine      4.5    3.0    5.0    7.0    4.5      3    4.0      4\n                   Juge38 Juge39 Juge40 Juge41 Juge42 Juge43 Juge44 Juge45\nS Michaud             7.0    2.5    3.5    5.5      4      6    3.5      1\nS Renaudie            5.5    2.5    2.0    4.0      3      3    5.0      2\nS Trotignon           4.5    4.0    8.5    5.0      3      7    4.0      1\nS Buisse Domaine      3.5    3.0    5.5    5.5      3      8    2.5      4\n                   Juge46 Juge47 Juge48 Juge49 Juge50 Juge51 Juge52 Juge53\nS Michaud               4    4.5    3.5    5.0      6    3.5    4.5    2.5\nS Renaudie              4    2.0    3.0    4.5      6    2.5    3.5    1.0\nS Trotignon             4    3.5    3.5    5.5      5    3.0    4.0    3.0\nS Buisse Domaine        1    5.0    3.0    8.0      5    2.0    3.0    3.0\n                   Juge54 Juge55 Juge56 Juge57 Juge58 Juge59 Juge60\nS Michaud             6.5    1.0      6    2.0      8    4.5      5\nS Renaudie            6.5    1.0      2    4.0      1    2.0      1\nS Trotignon           7.5    1.5      3    1.0      1    1.0      2\nS Buisse Domaine      4.0    2.5      3    1.5      6    5.0      3\n\n\n\n10 vins blancs du Val de Loire : 5 Vouvray - 5 Sauvignon\n\ndescripteurs sensoriels : acidité, amertume, odeur agrume, etc.\ndescription sensorielle de 3 jurys : oenologue, consommateurs, étudiant\nnotes hédoniques de 60 consommateurs : [appréciation globale]{. vert}\n\nAu total 118 variables, dont 60 sont des notes hédoniques\n\nOn souhaite étudier les relations entre les différentes varaibles mais aussi entre les groupes de variables\nIl est important d’équilibrer le poids de chaque ensemble de variables"
  },
  {
    "objectID": "01_afm.html#formalisation-du-problème",
    "href": "01_afm.html#formalisation-du-problème",
    "title": "Analyse Factorielle Multiple",
    "section": "Formalisation du problème",
    "text": "Formalisation du problème\n\n\n\\[\\begin{align}\nX & = \\begin{pmatrix}\n\\class{bleu}{X^{1}_1} & \\class{bleu}{X^{2}_1}  &  \\class{bleu}{X^{3}_1} & \\class{orange}{X^{4}_1}& \\class{orange}{X^{5}_1} & \\class{vert}{X^{6}_1}& \\class{vert}{X^{7}_1} \\\\\n\\class{bleu}{\\vdots} & \\class{bleu}{\\vdots}  &  \\class{bleu}{\\vdots} & \\class{orange}{\\vdots}& \\class{orange}{\\vdots} & \\class{vert}{\\vdots}& \\class{vert}{\\vdots} \\\\\n\\class{bleu}{X^{1}_n} & \\class{bleu}{X^{2}_n}  &  \\class{bleu}{X^{3}_n} & \\class{orange}{X^{4}_n}& \\class{orange}{X^{5}_n} & \\class{vert}{X^{6}_n}& \\class{vert}{X^{7}_n} \\\\\n\\end{pmatrix}\\\\\n& = \\begin{pmatrix}\n\\class{bleu}{\\boldsymbol{X^{1}}} &  \\class{orange}{\\boldsymbol{X^{2}}}  & \\class{vert}{\\boldsymbol{X^{3}}} \\\\\n\\end{pmatrix}\n\\end{align}\\]\nOn souhaite mettre en évidence\n\nLes relations entre les groupes de variables\nEquilibrer les contribution de chaque groupe de variables\n\n\nPremière idée\n\nRééquilibrer les variables entre groupes en attribuant à chaque variable \\(k\\) du groupe \\(i\\) un poids \\(1/n_k\\), où \\(n_k\\) est le nombre de variables dans le groupe \\(k\\)."
  },
  {
    "objectID": "01_afm.html#illustration",
    "href": "01_afm.html#illustration",
    "title": "Analyse Factorielle Multiple",
    "section": "Illustration",
    "text": "Illustration\n\nLe DoubsPremière idée\n\n\n\n\n\n\n\n\n\nACP normée\n\n\n\n\n\n\n\n\n\nACP sur les données réduites en prenant un poids \\(1/n_k\\) pour les variables du groupe \\(k\\)\n\n\n\n\n\nPoids des groupes de variables (variance préservée )\n\n\n  Methode Physique Chimique Ecologique\n1     ACP      9.4      9.3        7.3\n2     ACP      4.8      5.6        2.1\n3     ACP      1.9      4.6         NA\n4     n_k      4.7      4.1        5.2\n5     n_k      2.4      2.5        1.5\n6     n_k      0.9      2.1         NA\n\n\nContribution des variables aux différents axes\n\n\n      Dim.1_acp  Dim.2_acp  Dim.1_nk   Dim.2_nk\ndas 12.18484089  8.1162594  8.964225 13.0124095\nalt 11.24282498 10.7604372  7.666427 16.4183870\npen  3.43552777  6.8155752  2.520991  6.5171959\ndeb  9.47810542 12.4294474  6.400995 17.5657350\npH   0.04182411  6.0997890  0.102880  2.8386816\ndur  8.37968810  9.7425152  4.794697  9.1768600\npho 11.55522175 10.2926487  8.904811  3.1296232\nnit 13.64945308  0.2871669  8.934501  0.4216564\namm 10.45910917 13.8240211  8.289503  4.8797800\noxy  9.80107556  7.0888953 21.782875  8.4296737\ndbo  9.77232918 14.5432445 21.638094 17.6099978\n\n\n\n\n\n\nRééquilibrer les variables entre groupes en attribuant à chaque variable \\(k\\) du groupe \\(i\\) un poids \\(1/n_k\\), où \\(n_k\\) est le nombre de variables dans le groupe \\(k\\).\n\nProblème\n\nles deux variables écologiques sont presque parfaitement corrélées, l’information qu’elles portent se résume très bien avec un seul axe. Ainsi cet axe porte presque la même information que l’ensemble des variables, elles ont donc beaucoup de poids dans la création des axes finaux.\nLes variables chimiques (pH, dureté, phosphate, nitrite et ammoniaque) sont moins corélées, l’information qu’elles portent se diffusent sur plusieurs axes et donc le poids de ces variables est réparti sur plusieurs axes.\n\nLa première idée n’est pas toujours la bonne !\nOn souhaiterait que l’axe résume aussi bien les différents types de variable, et donc que chaque groupe de variable ait un poids 1 pour le premier axe."
  },
  {
    "objectID": "01_afm.html#lafm-en-pratique",
    "href": "01_afm.html#lafm-en-pratique",
    "title": "Analyse Factorielle Multiple",
    "section": "L’AFM en pratique",
    "text": "L’AFM en pratique\nPour chaque groupe de variable \\(k\\),\n\nOn calcule la 1ère valeur propre \\(\\lambda_{k1}\\) du groupe de variable \\(k\\), (chaque variable ayant été normée)\nOn réalise l’ACP globale sur le tableau pondéré :\n\n\\[\\begin{align}\nX & = \\begin{pmatrix}\n\\class{bleu}{\\frac{X^{1}_1}{\\sqrt{\\lambda_{11}}}} & \\class{bleu}{\\frac{X^{2}_1}{\\sqrt{\\lambda_{11}}}}  &  \\class{bleu}{\\frac{X^{3}_1}{\\sqrt{\\lambda_{11}}}} & \\class{orange}{\\frac{X^{4}_1}{\\sqrt{\\lambda_{21}}}} & \\class{orange}{\\frac{X^{5}_1}{\\sqrt{\\lambda_{21}}}} & \\class{vert}{\\frac{X^{6}_1}{\\sqrt{\\lambda_{31}}}}& \\class{vert}{\\frac{X^{7}_1}{\\sqrt{\\lambda_{31}}}} \\\\\n\\class{bleu}{\\vdots} & \\class{bleu}{\\vdots}  &  \\class{bleu}{\\vdots} & \\class{orange}{\\vdots}& \\class{orange}{\\vdots} & \\class{vert}{\\vdots}& \\class{vert}{\\vdots} \\\\\n\\class{bleu}{\\frac{X^{1}_n}{\\sqrt{\\lambda_{11}}}} & \\class{bleu}{\\sqrt{\\frac{X^{2}_n}{\\lambda_{11}}}}  &  \\class{bleu}{\\frac{X^{3}_n}{\\lambda_{11}}} & \\class{orange}{\\frac{X^{4}_n}{\\lambda_{21}}} & \\class{orange}{\\frac{X^{5}_n}{\\sqrt{\\lambda_{21}}}} & \\class{vert}{\\sqrt{\\frac{X^{6}_n}{\\lambda_{31}}}}& \\class{vert}{\\frac{X^{7}_n}{\\lambda_{31}}} \\\\\n\\end{pmatrix}\\\\\n& = \\begin{pmatrix}\n\\class{bleu}{\\frac{\\boldsymbol{X^{1}}}{\\sqrt{\\lambda_{11}}}} &  \\class{orange}{\\frac{\\boldsymbol{X^{2}}}{\\sqrt{\\lambda_{21}}}}  & \\class{vert}{\\frac{\\boldsymbol{X^{3}}}{\\sqrt{\\lambda_{31}}}} \\\\\n\\end{pmatrix}\\\\\n\\end{align}\\]\nOn a ainsi la pondération\n\n\n  Methode Physique Chimique Ecologique\n1     ACP      9.4      9.3        7.3\n2     ACP      4.8      5.6        2.1\n3     ACP      1.9      4.6         NA\n4     n_k      4.7      4.1        5.2\n5     n_k      2.4      2.5        1.5\n6     n_k      0.9      2.1         NA\n7     AFM      1.0      1.0        1.0\n8     AFM      0.5      0.6        0.3\n9     AFM      0.2      0.5         NA"
  },
  {
    "objectID": "01_afm.html#lafm-une-acp-particulière",
    "href": "01_afm.html#lafm-une-acp-particulière",
    "title": "Analyse Factorielle Multiple",
    "section": "L’AFM : une ACP Particulière",
    "text": "L’AFM : une ACP Particulière\nFinalement dans une AFM, on étudie\n\nle nuage de points \\(\\boldsymbol{X}\\),\nLes points sont potentiellement pondérés avec la matrice de poids \\(W \\in {\\mathbb{R}}^{n\\times n}\\),\non utilise la mérique \\[M = Diag\\left (\\frac{1}{s_1^2 \\lambda_{c_1}},\\ldots ,\\frac{1}{s_p^2 \\lambda_{c_p}} \\right)\\]\n\noù Diag désigne la matrice diagonale, le terme \\(i\\) est donné par \\(\\frac{1}{s_i^2 \\lambda_{c_i},}\\) \\(s_i\\) est l’écart type de la variable \\(i\\) et \\(\\lambda_{c_i}\\) est la première valeur propre de la classe à laquelle appartient la variable \\(i\\).\nOn a notre tryptique \\[(X, W, M)\\]"
  },
  {
    "objectID": "01_afm.html#en-pratique",
    "href": "01_afm.html#en-pratique",
    "title": "Analyse Factorielle Multiple",
    "section": "En pratique",
    "text": "En pratique\n\n\ndoubs_mfa &lt;- MFA(doubs.env, \n    group = c(4, 5, 2), # un vecteur qui spécifie le nombre de variable dans chaque groupe. Les variables doivent être organisées comme il faut\n    type = rep(\"s\", 3), # pour indiquer que ce sont de svariables quanti que l'on souhaite normaliser et ce pour chaque groupe\n    ncp=11, # on garde tous les axes\n    name.group=c(\"Physique\",\"Chimique\",\"Ecologique\"), graph = TRUE)\n#summary(doubs_mfa)\n# library(Factoshiny)\n# MFAshiny(doubs_mfa)"
  },
  {
    "objectID": "01_afm.html#ce-que-vous-pensez-devoir-retenir",
    "href": "01_afm.html#ce-que-vous-pensez-devoir-retenir",
    "title": "Analyse Factorielle Multiple",
    "section": "Ce que vous pensez devoir retenir",
    "text": "Ce que vous pensez devoir retenir\nOn choisit de faire une AFM si on veut mettre l’accent sur les liens entre les groupes de variables\n\nPour ce faire, on veut que chaque groupe contribue de la même manière à construire des premmiers axes principaux\nPour normaliser l’importance de chaque groupe, on calcule la première valeur propre de chaque groupe et on normalise les données par la racine de cette vp, ou de manière équivalente on prend une métrique $M£ dans maquelle le terme \\(M_{ii}\\) contient la première valeur propre du groupe de variables auquel appartient \\(i\\).\n\nLa méthode est proche de l’ACP, c’est une ACP avec une métrique particulière.\nOn va inetrpéter les relations entre les groupes de variables."
  },
  {
    "objectID": "TP2.html",
    "href": "TP2.html",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "",
    "text": "$$\n$$\nLes méthodes d’analyse factorielles sont utiles pour l’exploration de données, soit en tant que telle soit dans une phase préparatoire à un travail de modélisation. Il est utile de disposer à la fois d’outils interractifs pour l’exploration, mais également de garder une trace de l’exploration avec un document bilan.\nNous allons dans ce TP utiliser un fichier TP2.qmd pour garder une trace des analyses faites mais nous pourrons en parallèle utiliser le potentiel d’une exploration plus interactive soit avec Factoshiny soit avec explor selon ce que vous préférez.\nDans ce TP nous allons explorer un premier exemple en détail avec une démarche bien guidée tandis que le second exemple a pour objectif de vous laisser face aux données en autonomie, pour vérifier que vous voyez comment aborder un jeu de données avec les méthodes d’analyse factorielle."
  },
  {
    "objectID": "TP2.html#description-des-données",
    "href": "TP2.html#description-des-données",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Description des données",
    "text": "Description des données\nLe jeu de données utilisé dans ce premier cas pratique provient du site web de Global Footprint Network. Il contient les résultats d’empreinte écologique et de biocapacité pour 184 pays.\nLes données sont [disponibles sur ce lien}(https://marieetienne.github.io/datasets/overshootday_overview.csv).\n\nQuelques définitions\nLe calcul de l’empreinte écologique et de la biocapacité nous aide à répondre à la question de recherche fondamentale : Quelle est la demande des êtres humains envers les surfaces biologiquement productives (empreinte écologique) par rapport à la quantité que la planète (ou la surface productive d’une région) peut régénérer sur ces surfaces (biocapacité) ?\n\nHectare global (gha) : C’est l’unité choisie pour exprimer toutes les quantités d’intérêt concernant la consommation/émission de carbone. Une unité de surface correspondant à la productivité moyenne d’un hectare de terres mondiales. Un hectare de terres agricoles vaudra plus d’hectares globaux qu’un hectare de désert.\nEmpreinte écologique (en gha par personne) : Le nombre de gha requis pour produire les besoins et absorber les déchets d’un pays.\nBiocapacité (en gha) : La capacité d’un pays à produire ce dont il a besoin et à absorber ses déchets (réserve écologique).\nJour de dépassement : Jour de l’année où la demande d’un pays dépasse sa biocapacité annuelle.\n\nDes détails supplémentaires sont disponibles ici"
  },
  {
    "objectID": "TP2.html#objectifs",
    "href": "TP2.html#objectifs",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Objectifs",
    "text": "Objectifs\nLes relations entre les différentes mesures de l’empreinte écologique et les caractéristiques des pays.\n\nChargement des Données\n\n\nAnalyse Exploratoire des Données\n\nPouvez vous indiquer le nombre de lignes et de colonnes\n\nL’unité utilisé pour comparer est le Global Hectare (gha): Unité de surface qui correspondrait à la production moyenne d’un hectare du monde. Un hectare de champ vaudra donc plus de global hectare qu’un hectare de desert.\nLe gha par personne correspondant à une production (ou cosommation) globale d’une unité, (ici un pays) divisé par le nombre d’habitants dans cette unité.\nLes Variables disponibles sont\n\nlife_expectancy : Espérance de vie moyenne (années).\nhdi : Indice de développement humain.\nper_capita_gdp : PIB par habitant (USD).\nregion : Région géographique.\nincome_group : Catégorie de revenu (HI : Haut, UM : Moyen supérieur, LM : Moyen inférieur, LI : Faible).\npop : Population (en millions).\ntotal_prod : Production totale (gha par personne) la production du pays par habitant.\ntotal_cons : Consommation totale (gha par personne) la consommation par habitant.\nbiocapacity : La production durable (gha par personne) par habitant, ce que peut fournir le pays ramené par habitant.\nnumber_of_countries_required : Nombre de pays nécessaires pour satisfaire la consommation (total_cons/biocapacity)\nnumber_of_earths_required : Nombre de terres dont on aurait besoin si tout le monde faisait comme dans le pays en question (nb gha par personnes du pays / 1.583 (nb de gha par habitant de la terre, ce chiffre est mis à jour chaque année))\novershoot_day : Jour de dépassement (numéro du jour dans l’année).\n\nPlus de détails peuvent être trouvés ici , mais on peut préciser de la manière suivante\n\n\nStatistiques descriptives :\nProposez des résumés numériques pour chaque variable, ainsi qu’une étude des corrélations.\nPour le moment, on va supprimer les données manquantes (on verra par la suite comment gérer ce problème de manière plus satisfaisante). Pour ceci on peut utiliser drop_nadu package tidyverse ou na.omitde R Base."
  },
  {
    "objectID": "TP2.html#construire-une-acp",
    "href": "TP2.html#construire-une-acp",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Construire une ACP",
    "text": "Construire une ACP\n\nQuel poids choisir pour les pays ?\n\n\n\nQuelle Métrique choisir ?\n\n\n\nQuelles variables met-on en variables supplémentaires\n\n\n\nQuelle est l’inertie portée par l’axe 1 ?, l’axe 2, l’axe 3 ?\n\n\nCommentez la qualité de la représentation sur le plan (1-2), puis (1-3).  \nDe quelles variables nous parle l’axe 1 ? l’axe 2 ? pour répondre à cette question on regarde le cercle des corrélations mais aussi les contributions des variable sà la création des axes.\n\n\n\n\n\n\nQue pensez vous du graphe des individus ? Quels sont les individus atypiques ? Quels sont le spays les mieux représentés ?\nComment l’ACP est-elle modifiée si on retire Singapour de l’analyse ?\n\nDe nombreuses variables nous parle de l’empreinte écologique, et les variables nous parlant du développemnt du pays sont moins nombreuses. On peuyt rééquilibrer l’importance des varaibles avec une méthodes vu en cours, la quelle ?\n\n\nOn souhaite identifier deux groupes de variables : les variables concernant l’empreinte carbone et les varaibles portant sur le développement du pays.\nFaites 2 ACP différentes sur chacun de ces deux groupess. Quelle est la première valeur propre dans les deux cas.\nRappelez en quoi la méthode mentionné plus haut est une ACP particulière. A partir de la fonction PCA et en utilisant l’option col.w mettez en oeuvre cette méthode.\nOn peut le faire directement, avec la fonction M̀FA ` de FactoMineR. Reprenez l’analyse précédente avec ce nouvel équilibreentre les différentes variables équilibrés. Quelles sont les informations que vous pouvez retenir ?"
  },
  {
    "objectID": "TP2.html#un-premier-aperçu-des-données",
    "href": "TP2.html#un-premier-aperçu-des-données",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Un premier aperçu des données",
    "text": "Un premier aperçu des données\n\nOuvrez le fichier QteVie.csv pour identifier le séparateur de champs, le séparateur décimale, la présence éventuelle d’une colonne d’identifiant, la présence éventuelle de noms de colonnes, l’encodage du fichier (pour gérer les accents). On souhaite conserver le nom des variables tel qu’il est dans le fichier de données (argument check.names ce qui nécessite de respecter l’encodage encoding.\nAvec des statistiques univariées, identifier la présence de pays atypiques.\nLes variables d’un même thème sont-elles corrélées?\nLes différents thèmes sont-ils corrélés?"
  },
  {
    "objectID": "TP2.html#choisir-une-démarche-danalyse",
    "href": "TP2.html#choisir-une-démarche-danalyse",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Choisir une démarche d’analyse",
    "text": "Choisir une démarche d’analyse\nVous disposez de différents outils pour aller au delà des analyses uni ou bivariées. Parmi ceux-ci, pouvez-vous faire un bilan rapide de différentes approches possibles et choisir celle (ou celles) qui vous semble la (les) plus pertinente(s) ?"
  },
  {
    "objectID": "TP2.html#mise-en-oeuvre",
    "href": "TP2.html#mise-en-oeuvre",
    "title": "Labs2 - Analyse en composante Principale et au-delà",
    "section": "Mise en oeuvre",
    "text": "Mise en oeuvre\nRésumez dans le compte-rendu du TP les motifs qui vous ont fait choisir une méthode, les résultats principaux et les éléments qui vous permettent d’étayer ces résultats (éléments graphiques ou numériques)."
  },
  {
    "objectID": "references_linear.html",
    "href": "references_linear.html",
    "title": "References",
    "section": "",
    "text": "liste &lt;- \n  readLines('MAF.bib') |&gt; \n  as_tibble() |&gt; \n  filter(stringr::str_detect(value, pattern = '@|keywords')) |&gt; \n  rowid_to_column() %&gt;% \n  mutate(int_part = floor((rowid-1)/2), parity = rowid %% 2) %&gt;% \n  select(-rowid) %&gt;% \n  pivot_wider( values_from = value, names_from = parity, names_prefix = \"key\") |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = '@[:alnum:]+\\\\{')) |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = ',')) \n  \nmaf_liste &lt;- liste %&gt;% \n  filter(str_detect(key0, 'MAF')) %&gt;% \n  select(key1) %&gt;% \n  pull()\n\nlinear_liste &lt;- liste %&gt;% \n  filter(!str_detect(key0, 'MAF')) %&gt;% \n  select(key1) %&gt;% \n  pull()\n  \nNoCite(bib = myBib, linear_liste)"
  },
  {
    "objectID": "references_linear.html#pour-mieux-comprendre-lalgèbre-linéaire-utilisé",
    "href": "references_linear.html#pour-mieux-comprendre-lalgèbre-linéaire-utilisé",
    "title": "References",
    "section": "Pour mieux comprendre l’algèbre linéaire utilisé",
    "text": "Pour mieux comprendre l’algèbre linéaire utilisé\nBrunton, S. (2020). Singular Value Decomposition. URL: https://www.youtube.com/watch?v=gXbThCXjZFM.\nCohen, M. X. (2022). Practical linear algebra for data science. O’Reilly Media, Inc.\nHarville, D. A. (1998). Matrix algebra from a statistician’s perspective.\nYoshida, R. (2021). Linear algebra and its applications with R. Chapman and Hall/CRC. URL: https://shainarace.github.io/LinearAlgebra/."
  },
  {
    "objectID": "proj_sur_SVD.html#la-décomposition-en-valeurs-sigulières",
    "href": "proj_sur_SVD.html#la-décomposition-en-valeurs-sigulières",
    "title": "Singular Value Decomposition et ACP",
    "section": "La décomposition en valeurs sigulières",
    "text": "La décomposition en valeurs sigulières\n\\[\\boldsymbol{X} = \\boldsymbol{U}\\boldsymbol{D}\\boldsymbol{V^\\intercal},\\]\noù * \\(\\boldsymbol{U}\\) est une matrice \\(n\\times n\\) orthogonale \\(\\boldsymbol{U} \\boldsymbol{U}^\\intercal = \\boldsymbol{I}_n,\\) * \\(\\boldsymbol{V}\\) est une matrice \\(d\\times d\\) orthogonale \\(\\boldsymbol{V} \\boldsymbol{V}^\\intercal = \\boldsymbol{I}_d,\\) * \\(\\boldsymbol{D}\\) est une matrice \\(n \\times d\\), diagonale au sens où seuls les termes \\(D_{ii}\\) sont non nuls.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: SVD et Changement de Base"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Méthodes d’Analyse factorielle",
    "section": "",
    "text": "Description du cours\nCe cours présente des techniques statistiques pour décire et viusualiser des données multivariés. Il présentera à la fois les fondements mathématiques (géométriques) mais fera surtout la part belle à la mise en oeuvre pratioque de ces outils. A l’issue de ce cours, vous disposerez d’un ensemble de méthodes pour analyser des ensembles de données complexes et créer des représentations visuelles qui révèlent des motifs, des tendances et des relations entre plusieurs variables. Le cours couvre les sujets suivants :\n\n\nContenu\n\nAnalyse en Composantes Principales (ACP) : Un outil puissant de réduction dimensionnelle qui simplifie les grands ensembles de données tout en préservant autant que possible la variation. Les étudiants apprendront à visualiser des données à haute dimension à l’aide de l’ACP, rendant ainsi plus faciles à interpréter les relations complexes. Une extension, l’Analyse Factorielle Multiple (AFM) permet de prendre en compte des variables quantitatives organisées par groupe (on veut distinguer les variables physiques, des variables chimiques par exemple).\nAnalyse Factorielle Discriminante (AFD) : Cette méthode aide à classifier les observations dans des groupes prédéfinis. Le cours se concentrera sur la manière de différencier visuellement les groupes en utilisant plusieurs variables prédictives et d’interpréter les résultats.\nAnalyse Factorielle des Correspondances (AFC) : Il s’agit ici d’étudier la relation entre deux variables catégorielles et de visualiser les individus.\nAnalyse des Correspondances Multiples (ACM) : Cette méthode généralise l’AFC au cas à plus de deux variables qualitatives.\n\nLe cours mettra un accent particulier sur la visualisation des ensembles de données multivariés complexes. Ces outils visuels sont précieux pour communiquer les résultats des analyses multivariées de manière intuitive et accessible.\nÀ la fin du cours, les étudiants seront compétents dans l’application des méthodes multivariées à une variété d’ensembles de données et auront les compétences nécessaires pour créer des visualisations qui transmettent efficacement les intuitions que l’on peut avoir à partir des données et des éléments clés de la modélisation qui peut suivre.\n\n\nOrganisation du cours\n\n12h de cours\n12h de De TD/TP\n\nChaque cours contiendra un exemple détaillé et la mise en oeuvre pratique de la méthode étudiée ainsi que la présentation des concepts mathématiques (essentiellement géométriques) sur lesquels elle repose.\n\n\nPrérequis\nUne connaissance de base des statistiques, de l’algèbre linéaire et une maîtrise des logiciels statistiques (R essentiellement) sont recommandées"
  },
  {
    "objectID": "01_afd.html#quelques-exemples",
    "href": "01_afd.html#quelques-exemples",
    "title": "Analyse Factorielle Discrimante",
    "section": "Quelques exemples",
    "text": "Quelques exemples\nles manchots\nOn a mesuré les carcatéristqiues physiques de plusieurs manchots de trois espèces différentes.\nOn souhaite visualiser au mieux les différences entre les différentes espèces.\nLes vins de Loire\nOn a mesuré des caractéristiques sensorielles pour 10 vins blancs du Val de Loire,\nDeux types de vin sont étudiés des Sauvignon et de Vouvray (cépage Chenin Blanc) et on souhaite mettre en évidence des profils sensoriels différents."
  },
  {
    "objectID": "01_afd.html#formalisation",
    "href": "01_afd.html#formalisation",
    "title": "Analyse Factorielle Discrimante",
    "section": "Formalisation",
    "text": "Formalisation\nDonnées\nOn dispose de données quantitatives, stockées dans une matrice \\(\\boldsymbol{X}\\) comme en ACP.\nD’une variable qualitative \\(\\boldsymbol{Z}\\) de classe, il y a \\(K\\) classes au total (\\(K=3\\) dans le cas des manchots). Celle-ci est encodée dans un tableau disjonctif complet, c’est à dire que pour l’individu \\(i\\), le vecteur \\(Z_{ik}=1\\) si l’individu appartient à la classe \\(k\\) et \\(0\\) sinon. Si bien que\n\\(\\sum_{k=1}^K Z_{ik} =1\\) et \\(\\sum_{i=1}^n Z_{ik}=n_k\\) le nombre d’individus dans la classe \\(k\\).\n\\[\\boldsymbol{Z} =\\begin{pmatrix}\nZ_{11} & \\ldots &Z_{1K} \\\\\n\\vdots  &   &\\vdots\\\\\nZ_{n1} & \\ldots &Z_{nK} \\\\\n\\end{pmatrix}\\]\nMetrique et poids\nOn a aussi une matrice de poids \\(\\boldsymbol{W}\\) pour les individus et une métrique \\(\\boldsymbol{M}\\) sur les variables\nBut\nTrouver la projection qui permet de mettre en évidence les différences entre les groupes."
  },
  {
    "objectID": "01_afd.html#matrice-dinertie",
    "href": "01_afd.html#matrice-dinertie",
    "title": "Analyse Factorielle Discrimante",
    "section": "Matrice d’inertie",
    "text": "Matrice d’inertie\n\n\nRevisiter l’inertie\nL’inertie du nuage de points est définie comme \\[I = \\sum_{i=1}^n w_i \\lVert\\class{alea}{x_i} -\\boldsymbol{g}\\rVert^2_M\\] On a considéré des variables centrées donc \\(\\boldsymbol{g} = \\boldsymbol{0}\\).\n\nOr\n\n\\[\\begin{align}\nI = & \\sum_{i=1}^n w_i x_i^\\top M x_i = tr(\\sum_{i=1}^n w_i x_i^\\top M x_i ) \\\\\n   = & tr(\\sum_{i=1}^n M x_i w_i x_i^\\top ) \\quad \\text{(commutatitvité de la trace)} \\\\\n   = & tr(M \\sum_{i=1}^n  x_i w_i x_i^\\top )\\\\\n   = & tr(M X^\\top W X)\\\\\n   = & tr( X^\\top W X M)\\\\\n   = & tr( V M)\\\\\n   \n\\end{align}\\]\n\nAinsi l’inertie est la trace de la matrice \\(VM\\), avec \\(V=  X^\\top W X.\\)\n\n\nExemple sur les cas présentés\n\nDans le cas de l’ACP, la matrice \\(V\\) est la matrice de covariance et \\(M = Id\\),\nDans le cas de l’ACP normée , la matrice \\(V\\) est la matrice de covariance et \\(M = Diag(s_k^{-2})\\),\nDans le cas de l’AFM, la matrice \\(V\\) est la matrice de covariance et \\(M = Diag( s_k^{-2} \\lambda_{c_k}^{-1})\\).\n\n\nL’inertie du nuage est la trace de la matrice d’inertie.\nTrouver les axes principaux dans ces méthodes se résume à trouver les vecteurs propres de \\(VM\\)"
  },
  {
    "objectID": "01_afd.html#matrice-dinertie-dans-lafd",
    "href": "01_afd.html#matrice-dinertie-dans-lafd",
    "title": "Analyse Factorielle Discrimante",
    "section": "Matrice d’inertie dans l’AFD",
    "text": "Matrice d’inertie dans l’AFD\nOn a besoin de faire apparaître des barycentres de classe donc on réécrit la matrice d’inertie dans sa forme générale, et on indice par $T£ pour indiquer que c’est l’inertie totale du nuage.\n\\[V_T =  X^\\top W X - \\boldsymbol{g} \\boldsymbol{g}^\\top,\\]\navec \\(\\boldsymbol{g} = \\sum_{i=1}^n w_i  x_i\\), \\(\\boldsymbol{g}\\in{\\mathbb{R}}^d.\\)\n\n\nInertie Intra-classe\n\nDans la classe \\(k\\)\n\n\\[V_k =  X^\\top \\tilde{W_k} X - \\boldsymbol{g_k} \\boldsymbol{g_k}^\\top,\\]\navec \\(\\boldsymbol{g_k} = \\sum_{i=1}^n \\tilde{w}_{ik}  x_i\\), \\(\\tilde{w}_{ik} = \\frac{w_i z_{ik}}{\\sum_i w_i z_{ik}}.\\)\nIntuitivement, c’est la variabilité dans la classe, c’est à dire la dispersion autour du centre de gravité des individus de la classe \\(k\\)\n\nDans l’ensemble des classes \\(k\\), la matrice d’inertie intra-classes \\(V_W\\) (W pour Within)\n\n\\[V_W  = \\sum_{k=1}^K n_k V_k.\\]\n\nInertie Inter-classe\nLa matrice d’inertie inter-classes mesure la dispersion des centres de gravité des classes, affectés de leur poids, autour du centre de gravité du nuage.\n\\[V_B = \\sum_{k=1}^n n_k \\boldsymbol{g_k}\\boldsymbol{g_k}^\\top - \\boldsymbol{g}\\boldsymbol{g}^\\top.\\]"
  },
  {
    "objectID": "01_afd.html#décomposition-de-linertie",
    "href": "01_afd.html#décomposition-de-linertie",
    "title": "Analyse Factorielle Discrimante",
    "section": "Décomposition de l’inertie",
    "text": "Décomposition de l’inertie\nOn a la décomposition suivante de l’inertie en inertie intra-classes plus inertie inter-classes \\[\nV_T= V_W + V_B.\n\\]\n\n\nDécomposition de l’inertie expliquée par un axe\nL’inertie du nuage projeté sur l’axe \\(\\Delta_u\\) de vecteur unitaire \\(u\\), avec métrique \\(M\\), peut se décomposer comme \\[\nu^\\top M V_T M u = u^\\top M V_B M u + u^\\top M V_W M u,\n\\] où\n\n\\(u^\\top M V_T M u\\) est l’inertie totale portée par \\(\\Delta_u\\)\n\\(u^\\top M V_B M u\\) est l’inertie inter-classes portée par \\(\\Delta_u\\)\n\\(u^\\top M V_W M u\\) est l’inertie intra-classes portée par \\(\\Delta_u\\).\n\n\nFormalisation du problème\nOn cherche donc l’axe \\(\\Delta_u\\) tel que lors de la projection sur \\(\\Delta_u\\), les classes soient le plus séparées possible et que la variabilité au sein de chaque classe soit la plus petite possible\nSi \\(V_T\\) est inversible et puisque \\(M V_T M  = M V_B M  +  M V_W M\\), alors\n\\[I_d = (MV_TM)^{-1} M V_B M  + (MV_TM)^{-1} M V_W M\\] On cherche \\(u_1\\), \\(\\lVert u_1\\rVert=1\\) tel que\n\\[u_1^T  (MV_TM)^{-1} M V_B M  u_1= u_1^T M^{-1} V_T^{-1} V_B M u_1 \\]\n\nOn cherche donc les vecteurs propres de \\(M^{-1} V_T^{-1} V_B M\\)"
  },
  {
    "objectID": "01_afd.html#lafd-une-méthode-factorielle",
    "href": "01_afd.html#lafd-une-méthode-factorielle",
    "title": "Analyse Factorielle Discrimante",
    "section": "L’AFD = une méthode factorielle",
    "text": "L’AFD = une méthode factorielle\nSi \\(u_1\\) est vecteur propre de \\(M^{-1} V_T^{-1} V_B M\\), donc \\[M^{-1} V_T^{-1} V_B M u_1 = \\lambda_1 u_1  \\quad \\text{ i .e} \\quad V_T^{-1} V_B M u_1  = \\lambda_1  M u_1 \\]\nDans une ACP, on fait une décomposition de \\(V_T M\\)"
  },
  {
    "objectID": "01_afd.html#ce-que-vous-pensez-devoir-retenir",
    "href": "01_afd.html#ce-que-vous-pensez-devoir-retenir",
    "title": "Analyse Factorielle Discrimante",
    "section": "Ce que vous pensez devoir retenir",
    "text": "Ce que vous pensez devoir retenir\nA construire ensemble"
  },
  {
    "objectID": "references_maf.html",
    "href": "references_maf.html",
    "title": "References",
    "section": "",
    "text": "liste &lt;- \n  readLines('MAF.bib') |&gt; \n  as_tibble() |&gt; \n  filter(stringr::str_detect(value, pattern = '@|keywords')) |&gt; \n  rowid_to_column() %&gt;% \n  mutate(int_part = floor((rowid-1)/2), parity = rowid %% 2) %&gt;% \n  select(-rowid) %&gt;% \n  pivot_wider( values_from = value, names_from = parity, names_prefix = \"key\") |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = '@[:alnum:]+\\\\{')) |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = ',')) \n  \nmaf_liste &lt;- liste %&gt;% \n  filter(str_detect(key0, 'MAF')) %&gt;% \n  select(key1) %&gt;% \n  pull()\n\nlinear_liste &lt;- liste %&gt;% \n  filter(!str_detect(key0, 'MAF')) %&gt;% \n  select(key1) %&gt;% \n  pull()\n  \nNoCite(bib = myBib, maf_liste)"
  },
  {
    "objectID": "references_maf.html#pour-approfondir-ou-compléter-le-cours",
    "href": "references_maf.html#pour-approfondir-ou-compléter-le-cours",
    "title": "References",
    "section": "Pour approfondir ou compléter le cours",
    "text": "Pour approfondir ou compléter le cours\nCornillon, P., A. Guyader, F. Husson, et al. (2013). Statistiques avec R. Rennes (Presses universitaires de).\nEscofier, B. and J. Pagès (1998). “Analyses factorielles simples et multiples”. In: Dunod, Paris 284, pp. 104-107.\nGégout-Petit, A., M. Maumy-Bertrand, G. Saporta, et al. (2022). Données manquantes. Editions Technip.\nHusson, F. (1999a). Chaîne Youtube. URL: https://www.youtube.com/user/HussonFrancois.\nHusson, F. (1999b). MOOC sur l’analyse de données. URL: https://husson.github.io/MOOC_AnaDo/index.html.\nHusson, F., S. Lê, and J. Pagès (2016). Presses universitaires de Rennes."
  },
  {
    "objectID": "01_intro.html#où-lon-commence-par-parler-de-manchots",
    "href": "01_intro.html#où-lon-commence-par-parler-de-manchots",
    "title": "Introduction",
    "section": "Où l’on commence par parler de manchots",
    "text": "Où l’on commence par parler de manchots\n\nData presentationData descriptionLes questions que l’on se pose\n\n\nFrom the palmerpenguins package, data courtesy of Dr. Kristen Gorman and the Palmer Station, Antarctica LTER.\n\nlibrary(palmerpenguins)\ndata(penguins)\nhead(penguins, n= 10)\n\n# A tibble: 10 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\npenguins &lt;- penguins %&gt;% na.omit() %&gt;% mutate(year=as.factor(year))\n\n\n\nArtwork by @allison_horst\n\n\n\nPoint de vue science des données\n\nComment représenter ces données en perdant le moins d’information ? Visualisation\nToutes les variables sont-elles utiles ? Compression\n\nPoint de vue biologique\n\nQuelles sont les différences morpholgiques entre espèces, entre sexe et entre les îles ?\nExiste-t-il des relations morphométriques ?"
  },
  {
    "objectID": "01_intro.html#représenter-cest-déjà-comprendre",
    "href": "01_intro.html#représenter-cest-déjà-comprendre",
    "title": "Introduction",
    "section": "Représenter c’est déjà comprendre",
    "text": "Représenter c’est déjà comprendre\n\nReprésenter les liens entre variables 2 à 2DANGER\n\n\n\n\npenguins %&gt;%\n  select(species, body_mass_g, ends_with(\"_mm\")) %&gt;% \n  GGally::ggpairs(aes(color = species),\n          columns = c(\"flipper_length_mm\", \"body_mass_g\", \n                      \"bill_length_mm\", \"bill_depth_mm\")) +\n  scale_colour_manual(values = c(\"darkorange\",\"purple\",\"cyan4\")) +\n  scale_fill_manual(values = c(\"darkorange\",\"purple\",\"cyan4\"))\n\n\n\n\n\n\n\n\n\nProjection sur un espace à deux dimensions\n\n\nLe mensonge de la projection"
  },
  {
    "objectID": "01_intro.html#objectifs-de-ce-cours",
    "href": "01_intro.html#objectifs-de-ce-cours",
    "title": "Introduction",
    "section": "Objectifs de ce cours",
    "text": "Objectifs de ce cours\nDécouvrir des méthodes permettant de\n\nTrouver une (ou plusieurs) représentations en 2 dimensions la plus fidèle possible,\nFaire apparaître les liens entre les différentes variables,\nIdentifier les individus qui se ressemblent.\n\nLes ingrédients\n\nun peu de géométrie et d’algèbre linéaire,\nmesurer la quantité d’information présente dans un jeu de données,\nun bon esprit pratique pour bien poser le problème au départ\ndes données bien rangées dans un tableau \\(\\Xbf\\) où\n\nune ligne \\(i\\) correspond à un individu\nune colonne \\(j\\) à une variable \\(X_{ij}\\) la valeur de la variable \\(j\\) mesurée sur l’individu \\(i\\)."
  },
  {
    "objectID": "01_intro.html#un-aperçu-du-type-de-données",
    "href": "01_intro.html#un-aperçu-du-type-de-données",
    "title": "Introduction",
    "section": "Un aperçu du type de données",
    "text": "Un aperçu du type de données\n\nACPAFDACM\n\n\nComprendre les relations entre des variables toutes quantitatives.\nExample\nQuels sont lens entre les différentes variables morphométriques ?\n\n\nX_pca &lt;- penguins %&gt;%select(where(is.numeric)) \nhead(X_pca)\n\n\n# A tibble: 6 × 4\n  bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1           39.1          18.7               181        3750\n2           39.5          17.4               186        3800\n3           40.3          18                 195        3250\n4           36.7          19.3               193        3450\n5           39.3          20.6               190        3650\n6           38.9          17.8               181        3625\n\n\n\\[\\Xbf \\in \\R^{n\\times d}; \\quad \\Xbf = \\begin{pmatrix}\nx_{1,1} &  \\ldots & x_{1,p} \\\\\n\\vdots & &\\vdots \\\\\nx_{n,1} &  \\ldots & x_{n,p} \\\\\n\\end{pmatrix}.\n\\]\n\n\nComprendre les combinaisons de variables quantitatives qui expliquent les groupes, ou comment visualiser au mieux les différences entre les groupes.\nExample Comment visualiser au mieux les différences morpohologiques entre les espèces ?\n\n\nX_afd &lt;- penguins %&gt;% select(-island, -sex, -year) \nhead(X_afd)\n\n\n# A tibble: 6 × 5\n  species bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1 Adelie            39.1          18.7               181        3750\n2 Adelie            39.5          17.4               186        3800\n3 Adelie            40.3          18                 195        3250\n4 Adelie            36.7          19.3               193        3450\n5 Adelie            39.3          20.6               190        3650\n6 Adelie            38.9          17.8               181        3625\n\n\n\\[ \\Xbf = \\begin{pmatrix}\n\\class{rouge}{y_1} & x_{1,1} &  \\ldots & x_{1,p} \\\\\n\\vdots & &\\vdots \\\\\n\\class{rouge}{y_n} & x_{n,1} &  \\ldots & x_{n,p} \\\\\n\\end{pmatrix}, \\quad x_{ij}\\in\\R,\\  g_i \\in \\mathcal{G} =\\left \\lbrace g_1, \\ldots, g_G\\right \\rbrace.\n\\]\n\n\nOn souhaite étudier les liens entre deux variables qualitatives.\nExample\nComment la répartition entre espèce diffère entre les îles.\n\n\nX_acm &lt;- penguins %&gt;%select(species, island) \nhead(X_acm)\n\n\n# A tibble: 6 × 2\n  species island   \n  &lt;fct&gt;   &lt;fct&gt;    \n1 Adelie  Torgersen\n2 Adelie  Torgersen\n3 Adelie  Torgersen\n4 Adelie  Torgersen\n5 Adelie  Torgersen\n6 Adelie  Torgersen\n\n\n\\[\\Xbf = \\begin{pmatrix}\n\\class{bleu}{a_1} & \\class{orange}{b_1} \\\\\n\\class{bleu}{\\vdots} &\\class{orange}{\\vdots} \\\\\n\\class{bleue}{a_n} & \\class{orange}{b_n} \\\\\n\\end{pmatrix}, \\quad a_{i}\\in \\mathcal{A}, \\ \\#\\mathcal{A}= p,\\quad   b_{i}\\in \\mathcal{B}, \\ \\#\\mathcal{B}= q.  \n\\]"
  },
  {
    "objectID": "01_intro.html#organisation-du-cours",
    "href": "01_intro.html#organisation-du-cours",
    "title": "Introduction",
    "section": "Organisation du cours",
    "text": "Organisation du cours\n\nCes méthodes ont beaucoup de points communs\nComprendre finement l’ACP permet de bien comprendre toutes les extensions suivantes\nLa mise en oeuvre requiert un peu de pratique car il faut faire des choix avisés.\n\nPlan du cours\n\nAnalyse en composante principale\n\nUn exemple d’ACP\n\nComprendre les mécanismes derrière l’ACP (notion d’inertie, distance entre individus, changement de repères, la correlation comme un cosinus)\n\nAnalyse Factorielle multiple AFM : une extension de l’ACP\nAnalyse Factorielle Discriminante : AFD\nAnalyse Factorielle des Correspondances : AFC"
  },
  {
    "objectID": "ACP_images.html",
    "href": "ACP_images.html",
    "title": "ACP for Image Compression",
    "section": "",
    "text": "Loading required package: ggplot2\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ lubridate 1.9.3     ✔ tibble    3.2.1\n✔ purrr     1.0.2     ✔ tidyr     1.3.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nPour bien comprendre comment sont décomposées les images en bloc de 16 par 16, on peut créer une matrice avecdes cases numérotées et constater comment elle est transformée.\nUn bloc de 1- pixels est un individu à 16 variables.\ntest_image &lt;- array(1:1024, dim= c(32, 16, 1, 1))\ntest_image_blocks &lt;- extract_blocks_parallel(test_image[,,1,1], block_size = 4)\n\n[1] 29\n\ntest_image\n\n[,12] [,13]\n [1,]    1   33   65   97  129  161  193  225  257   289   321   353   385\n [2,]    2   34   66   98  130  162  194  226  258   290   322   354   386\n [3,]    3   35   67   99  131  163  195  227  259   291   323   355   387\n [4,]    4   36   68  100  132  164  196  228  260   292   324   356   388\n [5,]    5   37   69  101  133  165  197  229  261   293   325   357   389\n [6,]    6   38   70  102  134  166  198  230  262   294   326   358   390\n [7,]    7   39   71  103  135  167  199  231  263   295   327   359   391\n [8,]    8   40   72  104  136  168  200  232  264   296   328   360   392\n [9,]    9   41   73  105  137  169  201  233  265   297   329   361   393\n[10,]   10   42   74  106  138  170  202  234  266   298   330   362   394\n[11,]   11   43   75  107  139  171  203  235  267   299   331   363   395\n[12,]   12   44   76  108  140  172  204  236  268   300   332   364   396\n[13,]   13   45   77  109  141  173  205  237  269   301   333   365   397\n[14,]   14   46   78  110  142  174  206  238  270   302   334   366   398\n[15,]   15   47   79  111  143  175  207  239  271   303   335   367   399\n[16,]   16   48   80  112  144  176  208  240  272   304   336   368   400\n[17,]   17   49   81  113  145  177  209  241  273   305   337   369   401\n[18,]   18   50   82  114  146  178  210  242  274   306   338   370   402\n[19,]   19   51   83  115  147  179  211  243  275   307   339   371   403\n[20,]   20   52   84  116  148  180  212  244  276   308   340   372   404\n[21,]   21   53   85  117  149  181  213  245  277   309   341   373   405\n[22,]   22   54   86  118  150  182  214  246  278   310   342   374   406\n[23,]   23   55   87  119  151  183  215  247  279   311   343   375   407\n[24,]   24   56   88  120  152  184  216  248  280   312   344   376   408\n[25,]   25   57   89  121  153  185  217  249  281   313   345   377   409\n[26,]   26   58   90  122  154  186  218  250  282   314   346   378   410\n[27,]   27   59   91  123  155  187  219  251  283   315   347   379   411\n[28,]   28   60   92  124  156  188  220  252  284   316   348   380   412\n[29,]   29   61   93  125  157  189  221  253  285   317   349   381   413\n[30,]   30   62   94  126  158  190  222  254  286   318   350   382   414\n[31,]   31   63   95  127  159  191  223  255  287   319   351   383   415\n[32,]   32   64   96  128  160  192  224  256  288   320   352   384   416\n      [,14] [,15] [,16]\n [1,]   417   449   481\n [2,]   418   450   482\n [3,]   419   451   483\n [4,]   420   452   484\n [5,]   421   453   485\n [6,]   422   454   486\n [7,]   423   455   487\n [8,]   424   456   488\n [9,]   425   457   489\n[10,]   426   458   490\n[11,]   427   459   491\n[12,]   428   460   492\n[13,]   429   461   493\n[14,]   430   462   494\n[15,]   431   463   495\n[16,]   432   464   496\n[17,]   433   465   497\n[18,]   434   466   498\n[19,]   435   467   499\n[20,]   436   468   500\n[21,]   437   469   501\n[22,]   438   470   502\n[23,]   439   471   503\n[24,]   440   472   504\n[25,]   441   473   505\n[26,]   442   474   506\n[27,]   443   475   507\n[28,]   444   476   508\n[29,]   445   477   509\n[30,]   446   478   510\n[31,]   447   479   511\n[32,]   448   480   512\n\ntest_image_blocks\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]\n [1,]    1    2    3    4   33   34   35   36   65    66    67    68    97\n [2,]    5    6    7    8   37   38   39   40   69    70    71    72   101\n [3,]    9   10   11   12   41   42   43   44   73    74    75    76   105\n [4,]   13   14   15   16   45   46   47   48   77    78    79    80   109\n [5,]   17   18   19   20   49   50   51   52   81    82    83    84   113\n [6,]   21   22   23   24   53   54   55   56   85    86    87    88   117\n [7,]   25   26   27   28   57   58   59   60   89    90    91    92   121\n [8,]   29   30   31   32   61   62   63   64   93    94    95    96   125\n [9,]  129  130  131  132  161  162  163  164  193   194   195   196   225\n[10,]  133  134  135  136  165  166  167  168  197   198   199   200   229\n[11,]  137  138  139  140  169  170  171  172  201   202   203   204   233\n[12,]  141  142  143  144  173  174  175  176  205   206   207   208   237\n[13,]  145  146  147  148  177  178  179  180  209   210   211   212   241\n[14,]  149  150  151  152  181  182  183  184  213   214   215   216   245\n[15,]  153  154  155  156  185  186  187  188  217   218   219   220   249\n[16,]  157  158  159  160  189  190  191  192  221   222   223   224   253\n[17,]  257  258  259  260  289  290  291  292  321   322   323   324   353\n[18,]  261  262  263  264  293  294  295  296  325   326   327   328   357\n[19,]  265  266  267  268  297  298  299  300  329   330   331   332   361\n[20,]  269  270  271  272  301  302  303  304  333   334   335   336   365\n[21,]  273  274  275  276  305  306  307  308  337   338   339   340   369\n[22,]  277  278  279  280  309  310  311  312  341   342   343   344   373\n[23,]  281  282  283  284  313  314  315  316  345   346   347   348   377\n[24,]  285  286  287  288  317  318  319  320  349   350   351   352   381\n[25,]  385  386  387  388  417  418  419  420  449   450   451   452   481\n[26,]  389  390  391  392  421  422  423  424  453   454   455   456   485\n[27,]  393  394  395  396  425  426  427  428  457   458   459   460   489\n[28,]  397  398  399  400  429  430  431  432  461   462   463   464   493\n[29,]  401  402  403  404  433  434  435  436  465   466   467   468   497\n[30,]  405  406  407  408  437  438  439  440  469   470   471   472   501\n[31,]  409  410  411  412  441  442  443  444  473   474   475   476   505\n[32,]  413  414  415  416  445  446  447  448  477   478   479   480   509\n      [,14] [,15] [,16]\n [1,]    98    99   100\n [2,]   102   103   104\n [3,]   106   107   108\n [4,]   110   111   112\n [5,]   114   115   116\n [6,]   118   119   120\n [7,]   122   123   124\n [8,]   126   127   128\n [9,]   226   227   228\n[10,]   230   231   232\n[11,]   234   235   236\n[12,]   238   239   240\n[13,]   242   243   244\n[14,]   246   247   248\n[15,]   250   251   252\n[16,]   254   255   256\n[17,]   354   355   356\n[18,]   358   359   360\n[19,]   362   363   364\n[20,]   366   367   368\n[21,]   370   371   372\n[22,]   374   375   376\n[23,]   378   379   380\n[24,]   382   383   384\n[25,]   482   483   484\n[26,]   486   487   488\n[27,]   490   491   492\n[28,]   494   495   496\n[29,]   498   499   500\n[30,]   502   503   504\n[31,]   506   507   508\n[32,]   510   511   512"
  },
  {
    "objectID": "ACP_images.html#peut-on-compresser-les-beatles",
    "href": "ACP_images.html#peut-on-compresser-les-beatles",
    "title": "ACP for Image Compression",
    "section": "Peut on compresser les Beatles ?",
    "text": "Peut on compresser les Beatles ?\nOn va travailler sur la fameuse image de l’album Abbey Road des Beatles.\n\nPour la charger avec R, on utilise le package imager et la fonction load.image. puis la fonction grayscalepour bien s’assurer que l’image est codée en niveaux de gris.\n\nlibrary(imager)\nimage &lt;- load.image('img/abbey_road.jpg')\nimage &lt;- grayscale(image)\ndf_origine &lt;-image %&gt;% as.data.frame\np_origine &lt;- ggplot(df_origine,aes(x,y))+geom_raster(aes(fill=value)) +\n   scale_y_continuous(trans=scales::reverse_trans(), expand = c(0,0)) + ## pour mettre l'image dans le bon sens et supprimer les bors gris\n  scale_x_continuous(expand=c(0,0)) +\n  scale_fill_gradient(low=\"black\",high=\"white\") + ## pour le noir et blanc\n  theme(legend.position = \"none\")\n\np_origine\n\n\n\n\n\n\n\n\nL’objet obtenu est un array dont la première dimension est le nombre de pixels en ligne et la seconde dimension le nombre de pixel en colonnes. La troisème dimension est la profondeur et correspondrait au temps dan sun film par exemple et la dernière dimension est la couleur (on a donc 3 valeurs possibles sur cette dernière dimension dans le cas d’une image RGB et 1 dans le cas d’une image en niveau de gris).\nSi on se concentre sur les deux premières dimensions, on a donc une matrice dont la valeur est le niveau de gris du pixel correspondant.\n\ndim(image)\n\n[1] 1024  768    1    1\n\ngray_channel &lt;- image[,,1,1]\ngray_channel[1,1]\n\n[1] 0.1529412\n\n\nPour rentrer dans le formalisme de l’ACP, on a besoin qu’une ligne soit un individu et une colonne une variable. Ici, le choix nous revient de définir comme on le souhaite ce qu’est un individu et une varaible.\nOn va découper l’image en buffer carré (patch, micro image) de coté \\(bs.\\) Un individu sera un patch et une variable sera le niveau de gris dans un pixel particulier du patch.\nOn a donc \\(bs^2\\) variables et \\(N_{buf} = (height/bs) * (width/bs)\\) buffers/individus.\n\n# Set block size to 4x4\nblock_size &lt;- 4\n\n# Extract blocks for each color channel in parallel\nimage_blocks &lt;- extract_blocks_parallel(gray_channel, block_size)\ndim(image_blocks)\n\n\nRéduction de dimension par ACP\nOn va maintenant mettre en oeuvre une ACP, pour détermnier les composantes principales et on ne gardera quelques composantes pour réduire la dimension. On utilise FactoMineR.\n\nlibrary(FactoMineR)\nimages_pca &lt;- PCA(X = image_blocks, scale.unit = TRUE, ncp = ncol(image_blocks))\n\nLes valeurs propres nous donnent la quantité d’information contenu par chaque composante.\n\neigen_restreint &lt;- images_pca$svd$V\n\nOn constate que la première composante contient à elle toute seule 89.0652348\\(\\%\\) d’inertie. Ce qui signifie qu’en écrivant chaque buffet comme un nombre réel multiplé par le premier buffer on recontruit presque \\(90\\%\\) de l’information. Dans ca cas on a juste besoin de stocker\n\nla matrice \\(1\\times bs^2\\) qui permet de reconstruire les 16 variables initiales avec l’information contenu dans ce premier buffer,\nles coefficients que chaque buffer individu attribue à ce premier buffer, soit \\(N_{buf}\\)\n\nOn passe donc \\(N_{buf} * 16\\) réels à stocker à \\(N_{buf} + bs^2\\) si on ne garde qu’une seule composante ou \\(2 N_{buf} + bs^2\\) si on en garde 2.\nLes vecteurs propres sont donnés par\n\neigen_restreint &lt;- images_pca$svd$V\n\nOn sait q’un vecteur propre correspond à un patch de \\(bc\\times bs\\), on peut donc les visualiser sous cette forme\n\nlist_eigen &lt;- lapply(1:block_size^2, function(i){\n  X_restreint &lt;- matrix(images_pca$svd$V[,i], ncol = 4, nrow = 4)\n  image_eig &lt;- as.cimg(array(X_restreint, dim = c(4,4,1,1)))\n  p &lt;- image_eig %&gt;% as.data.frame() %&gt;% ggplot(aes(x,y))+geom_raster(aes(fill=value)) +\n   scale_y_continuous(trans=scales::reverse_trans(), expand = c(0,0)) + ## pour mettre l'image dans le bon sens et supprimer les bors gris\n  scale_x_continuous(expand=c(0,0)) +\n  scale_fill_gradient(low=\"black\",high=\"white\") + ## pour le noir et blanc\n  theme(legend.position = \"none\") +\ncoord_fixed()\n  return(p)\n}\n)\n\nggarrange(plotlist = list_eigen, ncol = 4)\n\n$`1`\n\n\n\n\n\n\n\n\n\n\n$`2`\n\n\n\n\n\n\n\n\n\n\n$`3`\n\n\n\n\n\n\n\n\n\n\n$`4`\n\n\n\n\n\n\n\n\n\n\nattr(,\"class\")\n[1] \"list\"      \"ggarrange\"\n\n\n\n\nReconstruction avec une seule composante principale\n\nnew_coord &lt;- images_pca$ind$coord\nreconstruction &lt;- new_coord[, 1, drop = FALSE]%*% t(images_pca$svd$V)[1,] \n\nn_row_block &lt;- dim(image)[1]/block_size\nn_col_block &lt;- dim(image)[2]/block_size\n\n\nX_reconstruction_list &lt;- lapply(1:n_col_block, function(j){\n  list_rows &lt;- lapply(1:n_row_block, function(i){\n    matrix( reconstruction[(j-1)*n_row_block + i,], ncol = block_size)\n  })\n  do.call(rbind, list_rows)\n}  \n)\n\nX_reconstruction &lt;- do.call(cbind, X_reconstruction_list)\n\n\ndf_1 &lt;-as.cimg(array(X_reconstruction, dim=dim(image))) %&gt;% as.data.frame\np_1 &lt;- ggplot(df_1,aes(x,y))+geom_raster(aes(fill=value)) +\n   scale_y_continuous(trans=scales::reverse_trans(), expand = c(0,0)) + ## pour mettre l'image dans le bon sens et supprimer les bors gris\n  scale_x_continuous(expand=c(0,0)) +\n  scale_fill_gradient(low=\"black\",high=\"white\") + ## pour le noir et blanc\n  theme(legend.position = \"none\")\n\n\nnew_coord &lt;- images_pca$ind$coord\nreconstruction_2 &lt;- new_coord[, 1:2]%*% t(images_pca$svd$V)[1:2,] \n\nX_reconstruction_list_2 &lt;- lapply(1:n_col_block, function(j){\n  list_rows &lt;- lapply(1:n_row_block, function(i){\n    matrix( reconstruction_2[(j-1)*n_row_block + i,], ncol = block_size)\n  })\n  do.call(rbind, list_rows)\n}  \n)\n\nX_reconstruction_2 &lt;- do.call(cbind, X_reconstruction_list_2)\n\n\ndf_2 &lt;-as.cimg(array(X_reconstruction_2, dim=dim(image))) %&gt;% as.data.frame\np_2 &lt;- ggplot(df_2,aes(x,y))+geom_raster(aes(fill=value)) +\n   scale_y_continuous(trans=scales::reverse_trans(), expand = c(0,0)) + ## pour mettre l'image dans le bon sens et supprimer les bors gris\n  scale_x_continuous(expand=c(0,0)) +\n  scale_fill_gradient(low=\"black\",high=\"white\") + ## pour le noir et blanc\n  theme(legend.position = \"none\")\n\n\n\n\n\n\nOriginal Beatles\n\n\n\n\n\n\n\n\n\nWith 2 principal components\n\n\n\n\n\n\n\n\n\nWith 1 principal component"
  },
  {
    "objectID": "01_acp.html#rappel-des-données-sur-les-manchots",
    "href": "01_acp.html#rappel-des-données-sur-les-manchots",
    "title": "Analyse en Composantes Principales",
    "section": "Rappel des données sur les manchots",
    "text": "Rappel des données sur les manchots\nDonnées disponibles dans le package palmerpenguins mises à disposition par le Dr. Kristen Gorman et the Palmer Station, Antarctica LTER.\nOn a mesuré les caractéristiques morphologiques de divers manchots :\n\n\nLes 6 premières lignes (parmi 333 )\n\n\n# A tibble: 333 × 4\n  bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n1           39.1          18.7               181        3750\n2           39.5          17.4               186        3800\n3           40.3          18                 195        3250\n4           36.7          19.3               193        3450\n5           39.3          20.6               190        3650\n6           38.9          17.8               181        3625\n# ℹ 327 more rows\n\n\n\n\nbill_length_mm : la longueur du bec,\nbill_depth_mm : l’épaisseur du bec,\nflipper_length_mm : la longueur de la nageoire,\nbody_mass_g : le poids du corps.\n\n\nComment visualiser au mieux ces données pour faire apparaître les liens entre variables et identifier des resemblances entre individus ?"
  },
  {
    "objectID": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau",
    "href": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau",
    "title": "Analyse en Composantes Principales",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nIdée 1 : on représente les liens des variables 2 à 2"
  },
  {
    "objectID": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-1",
    "href": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-1",
    "title": "Analyse en Composantes Principales",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nIdée 1 : dangereuse"
  },
  {
    "objectID": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-2",
    "href": "01_acp.html#voir-cest-comprendre-comment-représenter-linformation-contenue-dans-ce-tableau-2",
    "title": "Analyse en Composantes Principales",
    "section": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?",
    "text": "Voir c’est comprendre : comment représenter l’information contenue dans ce tableau ?\nObjectifs\n\nReprésenter sans perdre trop d’information,\nQuantifier la perte d’information,\nComprendre quelles sont les informations redondantes (variables liées),\nIdéalement des individus éloignés dans le nuage initial, restent éloignés dans la représentation\n\nDans toute la suite, sans perte de généralité, on va considérer que les variables sont centrées."
  },
  {
    "objectID": "01_acp.html#si-on-savait-faire-une-analyse-en-composantes-principales",
    "href": "01_acp.html#si-on-savait-faire-une-analyse-en-composantes-principales",
    "title": "Analyse en Composantes Principales",
    "section": "Si on savait faire une Analyse en Composantes Principales",
    "text": "Si on savait faire une Analyse en Composantes Principales\n\nDans R on feraitReprésentation des individusReprésentation des variablesVisualisation par ACP\n\n\n\n\nlibrary(FactoMineR)\ndta &lt;- penguins %&gt;% select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g) \npenguins.PCA &lt;- PCA(X = dta, ncp = 4, graph = FALSE)\n\n\n\n\n\nL’ACP permet de trouver la projection en 2 dimensions qui préserve au mieux l’information contenue dans le nuage de points (avec peu de déformation).\n\n\nplot(penguins.PCA, choix = \"ind\")\n\n\n\n\n\n\n\n\n\nReste à comprendre\n\nComment quantifier l’information contenue dans un nuage de points\nComment est construite cette meilleure projection\nQuels sont les individus bien représentés ?\n\n\n\nL’ACP définit de nouvelles variables, les composantes principales qui sont une combinaison linéaire des anciennes variables. On peut représenter les variables dans le premier plan de l’ACP.\n\n\nplot(penguins.PCA, choix = \"var\")\n\n\n\n\n\n\n\n\n\nReste à comprendre\n\nComment interpréter cette représentation ?\nQuelles sont les variables bien représentées ?\nQue peut-on déduire de ce graphique sur le lien entre les variables.\nComment lier graphique des individus et graphique des variables"
  },
  {
    "objectID": "01_acp.html#mise-en-forme-des-données",
    "href": "01_acp.html#mise-en-forme-des-données",
    "title": "Analyse en Composantes Principales",
    "section": "Mise en forme des données",
    "text": "Mise en forme des données\nL’ACP s’applique à des données quantitatives sous forme de tableau. Ce tableau est composé de n individus (lignes) et de p variables (colonnes).\nDans la suite on va noter \\({\\boldsymbol{X}}\\) la matrice des données, \\({\\boldsymbol{X}}\\in {\\mathbb{R}}^{n\\times p}\\).\n\\(x_{\\class{alea}{i}\\class{orange}{j}}\\) est la valeur de la variable \\(\\class{orange}{j}\\) mesurée pour l’individu \\(\\class{alea}{i}.\\)\n\\[{\\boldsymbol{X}}= \\overset{\\color{orange}{\\begin{matrix}var_1& \\ldots \\ &  \\ \\ldots \\ &\\  \\ldots\\  & \\  var_p \\end{matrix}}}{\\begin{pmatrix}\nx_{\\class{alea}{1}}^{\\class{orange}{1}} &  \\ldots &  \\ldots &\\ldots &  x_{\\class{alea}{1}}^{\\class{orange}{p}}\\\\\n\\vdots & & &  &\\vdots \\\\\n& &  x_{\\class{alea}{i}}^{\\class{orange}{j}} & & \\\\\n\\vdots & & & & \\vdots \\\\\nx_{\\class{alea}{n}}^{\\class{orange}{1}} & & & & \\ldots x_{\\class{alea}{n}}^{\\class{orange}{p}}\\\\\n\\end{pmatrix}}\\]"
  },
  {
    "objectID": "01_acp.html#deux-points-de-vue-complémentaires",
    "href": "01_acp.html#deux-points-de-vue-complémentaires",
    "title": "Analyse en Composantes Principales",
    "section": "Deux points de vue complémentaires",
    "text": "Deux points de vue complémentaires\n\n\nLe nuage des individus \\(C^n\\)\nOn peut considérer qu’un individu \\(i\\) est un vecteur \\(\\class{alea}{\\boldsymbol{x}_{i}}\\) dans un espace de dimension \\(p\\). Par convention tous les vecteurs sont des vecteurs colonnes, donc on peut écrire\n\\[{\\boldsymbol{X}}=\\begin{pmatrix}\n\\class{alea}{\\boldsymbol{x}_{1}}^\\top\\\\\n\\vdots \\\\\n\\class{alea}{\\boldsymbol{x}_{n}}^\\top\\\\\n\\end{pmatrix},\\]\nL’ensemble des \\(n\\) vecteurs forme le nuage des individus (ce qu’on représente classiquement).\n\n\n\n\n\n\n\n\n\n\nLe nuage des variables \\(C^p\\)\nOn peut considérer qu’une variable \\(j\\) est un vecteur \\(\\class{orange}{\\boldsymbol{x}^{j}}\\) dans un espace de dimension \\(n\\) et on peut écrire\n\\[{\\boldsymbol{X}}=\\begin{pmatrix}\n\\class{orange}{\\boldsymbol{x}^{1}} & \\ldots & \\class{orange}{\\boldsymbol{x}^{p}}\n\\end{pmatrix},\\]\nL’ensemble des \\(p\\) vecteurs forme le nuage des variables.\n\n\n\n\n\n\n\n\n\n\n\nBien sûr les deux nuages sont intimement liés"
  },
  {
    "objectID": "01_acp.html#linertie-par-rapport-à-un-point",
    "href": "01_acp.html#linertie-par-rapport-à-un-point",
    "title": "Analyse en Composantes Principales",
    "section": "L’inertie par rapport à un point",
    "text": "L’inertie par rapport à un point\n\n\n\nDefinition 1\n\n\nL’inertie (terme hérité de la physique) par rapport à un point \\(a \\in {\\mathbb{R}}^{p}\\) est définie par\n\\[I_{\\boldsymbol{a}} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{a}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -a^k)^2\\]\n\n\n\n\nIntuitivementRéponseThéorème de Huyghens\n\n\nL’inertie par rapport à un point quantifie l’information perdue lorsque le jeu de données est résumé par ce point.\nQuel est selon vous le point \\(\\boldsymbol{a}\\) qui minimise l’inertie ?\n\\[argmin_{\\boldsymbol{a}} I_{\\boldsymbol{a}} = ??\\]\n\n\nBINGO !!!\nIl s’agit du point \\(\\boldsymbol{g}=\\boldsymbol{x_{\\bullet}}=({x}_{\\bullet}^1, \\ldots, {x}_{\\bullet}^p )^\\top,\\) avec \\({x}_{\\bullet}^k=\\frac{1}{n} \\sum_{i=1}^n x_{i}^k\\), la valeur moyenne de la variable \\(k\\) sur l’ensemble des individus.\nPuisque nous avons supposé que nos variables étaient centrées, \\(G=O\\) l’origine sur repère.\n\n\n\\[\\forall \\boldsymbol{a}\\in\\mathbb{R}^p,\\; I_\\boldsymbol{a}=I_\\boldsymbol{g} + \\lVert\\boldsymbol{a}- \\boldsymbol{g}\\rVert^2.\\]\nConséquence\nLe meilleur résumé du nuage de points se résumant à un point est le barycentre du nuage de points, c’est à dire la moyenne sur chacune des dimensions.\n\n\n\n\nRemarque\n\\[I_{\\boldsymbol{g}} = I = \\frac{1}{n}  \\sum_{i=1}^n     \\left( \\sum_{k=1}^p \\left( x_{i}^k - x_{\\bullet}^k  \\right)^2 \\right)  = \\sum_{k=1}^p  \\left( \\frac{1}{n}  \\sum_{i=1}^n  \\left( x_{i}^k - x_{\\bullet}^k  \\right)^2 \\right)  = \\sum_{k=1}^p  Var(\\boldsymbol{x}^{k})\\] Si les variables sont réduites\n\\[I = p\\]"
  },
  {
    "objectID": "01_acp.html#linertie-par-rapport-à-un-axe",
    "href": "01_acp.html#linertie-par-rapport-à-un-axe",
    "title": "Analyse en Composantes Principales",
    "section": "L’inertie par rapport à un axe",
    "text": "L’inertie par rapport à un axe\n\n\n\nDefinition 2\n\n\nL’inertie par rapport à l’axe \\(\\Delta\\) est définie par \\[I_{\\boldsymbol{\\Delta}} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{p_i}^{\\Delta}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -p^{k,\\Delta}_i)^2, \\quad \\mbox{où }\\  \\boldsymbol{p_i}^{\\Delta} \\mbox{projeté orthogonal de } \\boldsymbol{x_i} \\mbox{ sur }\\Delta.\\]\n\n\n\n\nIntuitivementQue veut-on faire ?Rappel projection orthogonale\n\n\n\n\nL’inertie par rapport à l’axe \\(\\Delta\\) quantifie l’information perdue lorsque l’on résume le nuage de points à son projeté sur \\(\\Delta\\).\n\n\n\n\n\n\n\n\n\n\n\n\n\nIdentifier \\(\\Delta\\) tel que \\(I_{\\Delta}\\) soit minimale\nCe qui revient à l’axe \\(\\Delta\\) qui assure que la projection sur \\(\\Delta\\) déforme le moins possible le nuage de points.\nDans le cadre de l’ACP, on veut construire une ensemble d’axes orthogonaux (une nouvelle base de \\({\\mathbb{R}}^p\\)), de façon à ce que\n\nla projection sur le premier axe, soit le meilleur résumé du nuage de points en une dimension,\nle deuxième axe est orthogonal au premier et représente “le deuxième meileur choix” …. dans un sens que l’on va définir\nle troisième …\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nProduit scalaire : Soient deux élements \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) de \\(\\mathbb{R}^p\\), le produit scalaire est noté \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt;\\) et \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt;=\\sum_{i=1}^p x_i y_i = \\boldsymbol{x}^\\top \\boldsymbol{y}.\\)\nOrthogonalité Soient deux élements \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) de \\(\\mathbb{R}^p\\), on dit que \\(\\boldsymbol{x}\\) et \\(\\boldsymbol{y}\\) sont orthogonaux (noté \\(\\boldsymbol{x}\\perp \\boldsymbol{y}\\)) si \\(&lt;\\boldsymbol{x},\\boldsymbol{y}&gt; = \\boldsymbol{x}^\\top  \\boldsymbol{y}=0\\).\nProjection orthogonale On note \\(\\boldsymbol{a}_u\\) le projeté de \\(\\boldsymbol{a}\\) sur la droite \\(\\Delta\\) définit par son vecteur directeur unitaire \\(\\boldsymbol{u}\\) et passant par l’origine \\[\\boldsymbol{a}_u = &lt; \\boldsymbol{a}, \\boldsymbol{u} &gt; \\boldsymbol{u} = (\\boldsymbol{a}^\\top \\boldsymbol{u})\\,  \\boldsymbol{u}.\\] Le vecteur \\(\\boldsymbol{a_u}\\) est orthogonal à \\(\\boldsymbol{a}-\\boldsymbol{a_u}\\): \\[&lt; \\boldsymbol{a_u}, \\boldsymbol{a}-\\boldsymbol{a_u}&gt; = \\left ((\\boldsymbol{a}^\\top \\boldsymbol{u}) \\boldsymbol{u}\\right)^\\top \\left ( \\boldsymbol{a} -  (\\boldsymbol{a}^\\top \\boldsymbol{u})\\,  \\boldsymbol{u} \\right)=(\\boldsymbol{a}^\\top \\boldsymbol{u}) (\\boldsymbol{u}^\\top \\boldsymbol{a}) - (\\boldsymbol{a}^\\top \\boldsymbol{u})^2 \\boldsymbol{u}^\\top \\boldsymbol{u} =0  \\]"
  },
  {
    "objectID": "01_acp.html#linertie-par-rapport-à-un-sous-espace-affine",
    "href": "01_acp.html#linertie-par-rapport-à-un-sous-espace-affine",
    "title": "Analyse en Composantes Principales",
    "section": "L’inertie par rapport à un sous espace affine",
    "text": "L’inertie par rapport à un sous espace affine\n\nEspace orthogonal Soit \\(E\\) un sous-espace vectoriel de \\(\\mathbb{R}^p\\). On definit \\(E^\\perp=\\{\\boldsymbol{x}\\in \\mathbb{R}^p:\\; \\forall \\boldsymbol{y}\\in E,\\; \\boldsymbol{x}\\perp \\boldsymbol{y}\\}\\).\n\n\nExempleSolution\n\n\nDans \\({\\mathbb{R}}^2\\), on considère le sous espace vectoriel \\(E\\), tel que \\[ E =\\left \\lbrace  \\boldsymbol{x}=\\begin{pmatrix} x_1 &  x_2 \\end{pmatrix}^\\top \\in {\\mathbb{R}}^2 : x_1 = x_2  \\right \\rbrace \\] \\(E\\) est la droite d’équation \\(y=x\\).\nQui est \\(E^\\perp\\) ?\n\n\nSoit \\(\\boldsymbol{y}\\in E^\\perp,\\) alors\n\\[\\begin{align}\n0 & = \\boldsymbol{x}^\\top \\boldsymbol{y}\\\\\n  & = \\begin{pmatrix} x_1 &  x_2 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\  y_2 \\end{pmatrix}\\\\\n  & = x_1 y_1 + x_2 y_2 \\\\\n  & = x_1 (y_1 + y_2) \\quad (\\boldsymbol{x}\\in E \\Rightarrow x_1 =x_2) \\\\\n\\end{align}\\]\n\\[E^\\perp =  \\left \\lbrace  \\boldsymbol{y}=\\begin{pmatrix} y_1 &  y_2 \\end{pmatrix}^\\top \\in {\\mathbb{R}}^2 : y_1 + y_2 = 0 \\right \\rbrace  \\]\n\n\n\n\n\n\n\nDefinition 3\n\n\nL’inertie par rapport à un sous espace vectoriel \\(E\\) est définie par \\[I_{E} = \\frac{1}{n} \\sum_{i=1}^n \\lVert\\boldsymbol{x}_{i} - \\boldsymbol{p_i}^{E}\\rVert^2 = \\frac{1}{n} \\sum_{i=1}^n\\sum_{k=1}^p  (x_i^k -p^{k,E}_i)^2, \\quad \\mbox{où }\\  \\boldsymbol{p_i}^{E} = argmin_{\\boldsymbol{y}\\in E} d(\\boldsymbol{y}, \\boldsymbol{x}_{i}), \\mbox{i.e. projeté orthogonal de } \\boldsymbol{x_i} \\mbox{ sur }E.\\]\n\n\n\nC’est l’inertie perdue lorsque l’on résume le nuage de points à sa projection sur le sous espace \\(E\\)."
  },
  {
    "objectID": "01_acp.html#décomposition-de-linertie",
    "href": "01_acp.html#décomposition-de-linertie",
    "title": "Analyse en Composantes Principales",
    "section": "Décomposition de l’inertie",
    "text": "Décomposition de l’inertie\n\nSoit \\(E\\) un sous espace vectoriel de \\({\\mathbb{R}}^p\\), alors \\[I = I_E + I_{E^\\perp}.\\]\n\nPreuve\n\n\nUn dessin vaut mieux qu’un long discours et Pythagore est ton ami !\n\\[d(\\class{alea}{\\boldsymbol{x}_{i}}, O)^2 = d(\\boldsymbol{x}_{i}, \\class{bleu}{\\boldsymbol{x}_{i}^E})^2  +  d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{rouge}{\\boldsymbol{x}_{i}^{E^\\perp}})^2.\\]\n\\[\\begin{align}\nI & = \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, O)^2 \\\\\n   & = \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{bleu}{\\boldsymbol{x}_{i}^E})^2   +  \\frac{1}{n} \\sum_{i=1}^n d(\\class{alea}{\\boldsymbol{x}_{i}}, \\class{rouge}{\\boldsymbol{x}_{i}^{E^\\perp}})^2 \\\\\n   & = \\class{bleu}{I_E} + \\class{rouge}{I_{E^\\perp}}\n\\end{align}\\]"
  },
  {
    "objectID": "01_acp.html#principe-de-la-décomposition-à-venir",
    "href": "01_acp.html#principe-de-la-décomposition-à-venir",
    "title": "Analyse en Composantes Principales",
    "section": "Principe de la décomposition à venir",
    "text": "Principe de la décomposition à venir\n\nIdentifier le vecteur \\(\\boldsymbol{u_1}\\) de \\({\\mathbb{R}}^p\\), tel que \\(I_{E_1}\\) soit minimale avec \\(E_1=\\left \\lbrace \\lambda \\boldsymbol{u_1}, \\lambda \\in {\\mathbb{R}}\\right\\rbrace,\\)\nDans \\(E_1^\\perp\\), identifier le vecteur \\(\\boldsymbol{u_2}\\) de \\({\\mathbb{R}}^p\\), tel que \\(I_{E_2}\\) soit minimale avec \\(E_2=\\left \\lbrace \\lambda \\boldsymbol{u_2}, \\lambda \\in {\\mathbb{R}}\\right\\rbrace,\\)\nDans \\(\\left (  E_1 \\oplus E_2 \\right)^\\perp\\), identifier le vecteur \\(\\boldsymbol{u_3}\\) de \\({\\mathbb{R}}^p\\), tel que ….\n\n…\nFinalement on aura la décomposition\n\\[I= I_{E_1} + I_{E_2} + \\ldots + I_{E_p}, \\quad \\mbox{avec } I_{E_1} \\leq I_{E_2} \\leq \\ldots \\leq I_{E_p}\\]"
  },
  {
    "objectID": "01_acp.html#se-donner-des-intuitions",
    "href": "01_acp.html#se-donner-des-intuitions",
    "title": "Analyse en Composantes Principales",
    "section": "Se donner des intuitions",
    "text": "Se donner des intuitions"
  },
  {
    "objectID": "01_acp.html#se-donner-des-intuitions-1",
    "href": "01_acp.html#se-donner-des-intuitions-1",
    "title": "Analyse en Composantes Principales",
    "section": "Se donner des intuitions",
    "text": "Se donner des intuitions"
  },
  {
    "objectID": "01_acp.html#identifier-boldsymbolu_1---formalisation",
    "href": "01_acp.html#identifier-boldsymbolu_1---formalisation",
    "title": "Analyse en Composantes Principales",
    "section": "Identifier \\(\\boldsymbol{u_1}\\) - Formalisation",
    "text": "Identifier \\(\\boldsymbol{u_1}\\) - Formalisation\n\n\n\nOn cherche \\(\\boldsymbol{u_1}\\) tel que \\(I_{u_1}\\) soit minimale mais \\(I_{u_1} + I_{u_1^\\perp}=I\\). Minimiser \\(I_{u_1}\\) revient à maximiser \\(I_{u_1^\\perp}\\), i.e l’inertie du nuage projeté.\n\nLe premier individu se projette en \\(\\class{alea}{x_{1}}^\\top \\boldsymbol{u_1}\\) sur \\(\\boldsymbol{u_1}\\)\nLe deuxième individu se projette en \\(\\class{alea}{x_{2}}^\\top \\boldsymbol{u_1}\\) sur \\(\\boldsymbol{u_1}\\)\n…\n\nOn rappelle que \\[{\\boldsymbol{X}}= \\begin{pmatrix} \\class{alea}{x_{1}}^\\top \\\\ \\vdots \\\\ \\class{alea}{x_{n}}^\\top \\end{pmatrix}.\\] La projection de l’individu \\(i\\) est obtenue en multipliant le vecteur ligne \\(\\class{alea}{x_{1}}^\\top\\) par \\(\\boldsymbol{u_1}\\). Le vecteur des coordonnées sur \\(\\boldsymbol{u_1}\\) pour chaque individu est\n\n\\[\\begin{pmatrix} \\class{alea}{x_{1}}^\\top \\boldsymbol{u_1} \\\\ \\vdots \\\\ \\class{alea}{x_{n}}^\\top \\boldsymbol{u_1} \\end{pmatrix} = X  \\boldsymbol{u_1}.\\]\n\nMaximiser \\(I_{u_1^\\perp}\\)\nsous la contrainte \\(\\lVert\\boldsymbol{u_1}\\rVert\\) \\[\\begin{align}\nI_{u_1^\\perp} & = \\frac{1}{n}\\lVert X  \\boldsymbol{u_1}\\rVert^2 \\\\\n        & = \\frac{1}{n} (X  \\boldsymbol{u_1})^\\top (X  \\boldsymbol{u_1})\\\\\n        & =   \\boldsymbol{u_1}^\\top \\left (\\frac{1}{n} X^\\top X \\right)  \\boldsymbol{u_1}\n\\end{align}\\]\n\nRemarqueCe que ça signifie\n\n\n\n\\(\\frac{1}{n} X^\\top X\\) est la matrice de covariance, on écrit souvent \\(\\frac{1}{n} X^\\top X\\) sous la forme \\(X^\\top W X\\) (\\(W\\) est une matrice diagonale, dont chaque terme diagonal vaut \\(1/n\\), \\(W_{ii}\\) est le poids attribué à l’observation \\(i\\)).\n\\(X^\\top W X\\) est symétrique et définie positive donc diagonalisable.\nIl existe une matrice \\(P\\) unitaire \\(P^\\top P = I_p,\\) et \\(D\\) une matrice diagonale telle que \\[X^\\top W X = P D P^\\top.\\]\nLes termes diagonaux de \\(D\\) sont les valeurs propres, toutes positives, de \\(X^\\top W X\\) rangées par odre décroissant, \\(\\lambda_1 &gt; \\lambda_1 \\ldots &gt;\\lambda_p\\) et \\(U\\) est la matrice des vecteurs propres associés.\n\n\n\n\n\\(\\boldsymbol{b}\\) est une base orthonormale, la base formée par les vecteurs propres de \\(X^\\top W X\\)."
  },
  {
    "objectID": "01_acp.html#identifier-les-directions-principales",
    "href": "01_acp.html#identifier-les-directions-principales",
    "title": "Analyse en Composantes Principales",
    "section": "Identifier les directions principales",
    "text": "Identifier les directions principales\nChercher \\(\\boldsymbol{u_1}\\) tel que \\(I_{u_1^\\perp}\\) soit maximale\nEn se plaçant dans la nouvelle base, posons \\(\\boldsymbol{v_1} = P^\\top \\boldsymbol{u_1},\\) \\(\\lVert\\boldsymbol{v_1}\\rVert=1\\):\nMaximiser \\(\\boldsymbol{v_1}^\\top D \\boldsymbol{v_1} = \\sum_{k=1}^p v_{1p}^2 \\lambda_p\\), sous la contrainte \\(\\sum_{k=1}^p  v_{1p}^2=1\\)\n\\[\\boldsymbol{v_1} = (1, 0, \\ldots, 0)^\\top, \\quad \\boldsymbol{u_1} = P \\boldsymbol{v_1} = \\begin{pmatrix} P_{11} \\\\ \\vdots \\\\P_{p1} \\end{pmatrix}.\\]\n\\(\\boldsymbol{u_1}\\) est le premier vecteur propre de \\(X^\\top W X\\). (la matrice de covariance).\nChercher \\(\\boldsymbol{u_2}\\)\nOn cherche \\(\\boldsymbol{u_2}\\perp \\boldsymbol{u_1}\\), tel que \\(\\boldsymbol{u_2}^\\top X^\\top W X   \\boldsymbol{u_2}\\) soit maximale.\nPosons \\(\\boldsymbol{v_2} = P^\\top \\boldsymbol{u_2},\\) \\(\\lVert\\boldsymbol{v_2}\\rVert=1\\): Maximiser \\(\\boldsymbol{v_2}^\\top D \\boldsymbol{v_2} = \\sum_{k=1}^p v_{2p}^2 \\lambda_p\\), sous la contrainte \\(\\sum_{k=1}^p  v_{1p}^2=1\\) et \\(v_{1p}=0\\) pour assurer l’orthogonalité avec \\(\\boldsymbol{v_1}\\)\n\\[\\boldsymbol{v_2} = (0, 1, \\ldots, 0)^\\top, \\quad \\boldsymbol{u_2} = P \\boldsymbol{v_2} = \\begin{pmatrix} P_{12} \\\\ \\vdots \\\\U_{p2} \\end{pmatrix}.\\]\n\\(\\boldsymbol{u_2}\\) est le deuxième vecteur propre de de \\(X^\\top W X\\)."
  },
  {
    "objectID": "01_acp.html#mesurer-linformation-préservée-par-projection",
    "href": "01_acp.html#mesurer-linformation-préservée-par-projection",
    "title": "Analyse en Composantes Principales",
    "section": "Mesurer l’information préservée par projection",
    "text": "Mesurer l’information préservée par projection\nSur un axe principal\n\nLorsque l’on résume le nuage à sa projection sur un axe factoriel \\(\\boldsymbol{u_k}\\), on ne garde que l’information associée à cet axe soit \\(I_{\\boldsymbol{u_k}^\\perp}=\\lambda_k\\).\nLa quantité d’information préservée par projection sur l’axe \\(k\\) est donc \\(\\lambda_k\\).\nLa part d’information portée par l’axe \\(k\\) est donnée par \\(\\displaystyle\\frac{\\lambda_k}{\\sum_{k=1}^p\\lambda_k}\\)\n\nSur un axe principal\n\nL’inertie du nuage projeté sur plan \\(k_1, k_2\\) est donnée par \\[\\lambda_{k_1} +\\lambda_{k_2}\\]\nLa part d’information portée par le plan \\(k_1, k_2\\) est donnée par \\[\\frac{\\lambda_k}{\\sum_{k=1}^p\\lambda_{k_1} +\\lambda_{k_2}}\\]"
  },
  {
    "objectID": "01_acp.html#attention-aux-unités---illustration-sur-les-données-de-manchots",
    "href": "01_acp.html#attention-aux-unités---illustration-sur-les-données-de-manchots",
    "title": "Analyse en Composantes Principales",
    "section": "Attention aux unités - Illustration sur les données de manchots",
    "text": "Attention aux unités - Illustration sur les données de manchots\n\n\nlibrary(FactoMineR)\n\npenguins.PCA &lt;- PCA(X = penguins, \n                    scale.unit = FALSE, ## should we scale the data ?\n                    ncp = 4, ## number of components : as many as initial variables\n                    graph = FALSE, ## no graph right now\n                    quali.sup = c(1, 2, 7,8)) ## to indicate the column number of qualitative variable\npenguins.PCA$eig\n\npenguins.PCA$svd$V ## what is named P in the lecture\n\n\n         eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 6.465859e+05           9.998932e+01                          99.98932\ncomp 2 5.058345e+01           7.822325e-03                          99.99715\ncomp 3 1.610647e+01           2.490736e-03                          99.99964\ncomp 4 2.353778e+00           3.639929e-04                         100.00000\n             [,1]        [,2]        [,3]          [,4]\n[1,]  0.004003162  0.31927773  0.94126475 -0.1098470736\n[2,] -0.001154327 -0.08684753  0.14449479  0.9856862728\n[3,]  0.015194547  0.94354238 -0.30518986  0.1278908060\n[4,]  0.999875876 -0.01571702  0.00103611 -0.0003657482\n\n\nLa dispersion du nuage projeté sur le premier axe représente \\(6.45 10^5\\) en terme d’inertie soit \\(99.98%\\) de l’inertie totale.\n\nTrop beau pour être vrai ?\nRéfléchissons aux données, ce qui est crucial dans toutes analyses de données.\n\n\npenguins %&gt;% \n  summarise(across(where(is.numeric), list(mean = mean, sd= sd)))  |&gt; \n  pivot_longer(cols = everything(),  names_to = c(\"Var\", \"Resume\"), \n      names_pattern = \"(.*)_(mean|sd)\") |&gt; \n  pivot_wider(names_from = Resume,values_from = value)\n\n\n# A tibble: 4 × 3\n  Var                 mean     sd\n  &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;\n1 bill_length_mm      44.0   5.47\n2 bill_depth_mm       17.2   1.97\n3 flipper_length_mm  201.   14.0 \n4 body_mass_g       4207.  805.  \n\n\n\n\nLes variables ont des ordres de grandeur variable.\nLa contribution à la distance entre individu de la variable Massest plus importante que celle de la variable bill_length_mm.\nEst-ce souhaitable ?"
  },
  {
    "objectID": "01_acp.html#attention-aux-unités---illustration-sur-les-données-de-manchots-normalisées",
    "href": "01_acp.html#attention-aux-unités---illustration-sur-les-données-de-manchots-normalisées",
    "title": "Analyse en Composantes Principales",
    "section": "Attention aux unités - Illustration sur les données de manchots normalisées",
    "text": "Attention aux unités - Illustration sur les données de manchots normalisées\n\n\npenguins.PCA &lt;- PCA(X = penguins, \n                    scale.unit = TRUE, ## should we scale the data,\n                    ncp = 4, ## number of components : as many as initial variables\n                    graph = FALSE, ## no graph right now\n                    quali.sup = c(1, 2, 7,8)) ## to indicate the column number of qualitative variable\npenguins.PCA$eig\n\npenguins.PCA$svd$V ## what is named P in the lecture\n\n\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1  2.7453557              68.633893                          68.63389\ncomp 2  0.7781172              19.452929                          88.08682\ncomp 3  0.3686425               9.216063                          97.30289\ncomp 4  0.1078846               2.697115                         100.00000\n           [,1]       [,2]       [,3]       [,4]\n[1,]  0.4537532 0.60019490 -0.6424951 -0.1451695\n[2,] -0.3990472 0.79616951  0.4258004  0.1599044\n[3,]  0.5768250 0.00578817  0.2360952  0.7819837\n[4,]  0.5496747 0.07646366  0.5917374 -0.5846861\n\n\nOn a centré réduit les variables pour les rendre comparables et leur donner la même importance.\nDans ce cas l’inertie totale est le nombre de variables (voir remarque Section 3.1.1)\nLorsque l’on veut s’abstraire des unités, on centre te on réduit les données pour réaliser une ACP normée."
  },
  {
    "objectID": "01_acp.html#choix-de-la-distance",
    "href": "01_acp.html#choix-de-la-distance",
    "title": "Analyse en Composantes Principales",
    "section": "Choix de la distance",
    "text": "Choix de la distance\nL’ACP normée (ACP sur les données centrées et réduites) peut-être envisagée comme une ACP avec une autre distance que la distance euclidienne.\nUne autre manière de présenter la même approche est de dire qu’on change la métrique utilisée\n\n\n\nDefinition (métrique)\n\n\nUne métrique \\(M\\) permet de définir une distance entre les observations (ainsi, M est une matrice de \\({\\mathbb{R}}^p\\times{\\mathbb{R}}^p\\) symétrique, définie et positive).\n\n\n\nCalcul de distance\nSoient \\(\\boldsymbol{x}_1 \\in {\\mathbb{R}}^p\\) et \\(\\boldsymbol{x}_é\\in{\\mathbb{R}}^p\\), la distance entre \\(\\boldsymbol{x}_1\\) et \\(\\boldsymbol{x}_2\\)pour la métrique \\(M\\) est \\[d_M(\\boldsymbol{x}_1, \\boldsymbol{x}_2)^2= \\lVert\\boldsymbol{x}_1 - \\boldsymbol{x}_2\\rVert_M^2 = (\\boldsymbol{x}_1 - \\boldsymbol{x}_2)^\\top M (\\boldsymbol{x}_1 - \\boldsymbol{x}_2).\\]\n\nExemple \\(I_p\\)Distance normalisant les variables\n\n\nSi \\(M= I_p\\),\n\\[d_M(\\boldsymbol{x}_1, \\boldsymbol{x}_2)^2= \\lVert\\boldsymbol{x}_1 - \\boldsymbol{x}_2\\rVert_M^2 = (\\boldsymbol{x}_1 - \\boldsymbol{x}_2)^\\top I_p (\\boldsymbol{x}_1 - \\boldsymbol{x}_2) =\\sum_{k=1}^p (x_{1k}-x_{2k})^2.\\]\n\n\nSi \\(M\\) est diagonale est \\(M_{ii}= 1/ s_i^2\\) où \\(s_i^2\\) est la variance de la variable \\(i\\),\n\\[d_M(\\boldsymbol{x}_1, \\boldsymbol{x}_2)^2=  (\\boldsymbol{x}_1 - \\boldsymbol{x}_2)^\\top M (\\boldsymbol{x}_1 - \\boldsymbol{x}_2) =\\sum_{k=1}^p \\frac{(x_{1k}-x_{2k})^2}{s_k^2}=\\sum_{k=1}^p \\left ( \\frac{x_{1k}}{s_k}-\\frac{x_{2k}}{s_k} \\right)^2.\\]\nDans une ACP normée on s’intéresse donc aux valeurs propres de la matrice \\(X^\\top M W X,\\) il s’agit de la matrice de corrélation."
  },
  {
    "objectID": "01_acp.html#représentation-des-individus---composantes-principales",
    "href": "01_acp.html#représentation-des-individus---composantes-principales",
    "title": "Analyse en Composantes Principales",
    "section": "Représentation des individus - Composantes principales",
    "text": "Représentation des individus - Composantes principales\n\n\n\nDefinition (Composantes principales)\n\n\nLes coordonnées des \\(n\\) observations sur les \\(p\\) axes factoriels sont groupées dans la matrice \\(C\\): \\(c_{ik}\\) est la coordonnée de l’observation \\(i\\) sur l’axe \\(\\Delta_{\\boldsymbol{u_k}}\\). La \\(k\\)-ème composante principale est la colonne \\(k\\) de la matrice \\(C\\), notée \\(C^k\\). \\[\nC = [\\class{orange}{C^1} | \\ldots | \\class{orange}{C^p}] \\text{ avec } \\class{orange}{C^k}=\\begin{pmatrix}\nc_{1k}\\\\\n\\vdots\\\\\nc_{nk}\n\\end{pmatrix}.\n\\]\n\n\n\n\nVectoriellementVisuellementRemarques\n\n\nOn a les expressions suivantes \\[\nC^k=Xu_k \\mbox{ et } C=XP,\n\\] où \\(P\\) désigne la matrice de changement base, i.e la matrice contenant les vecteurs propres.\n\n\n\n\n\n\nLes \\(C^k\\) sont des combinaisons linéaires des variables de départ.\nElles sont centrées, de variance \\(\\lambda_k=\\sum_{i=1}^n p_i c_{ik}^2\\) et non-corrélées 2 à 2.\nLes \\(C^k\\) sont vecteurs propres de \\(XX^\\top\\) de valeur propre \\(\\lambda_k\\)."
  },
  {
    "objectID": "01_acp.html#représentation-des-manchots",
    "href": "01_acp.html#représentation-des-manchots",
    "title": "Analyse en Composantes Principales",
    "section": "Représentation des manchots",
    "text": "Représentation des manchots\n\n\nX &lt;- penguins |&gt; \n  mutate(year = as.factor(year))|&gt;  ## year willnot be considered as numerical variable\n  select(where(is.numeric)) |&gt;      ## select all numeric columns\n  mutate_all(list(scale2)) |&gt;          ## and scale them\n  as.matrix()\n\nn &lt;- nrow(X) # number of individuals\nd &lt;- ncol(X)\n\npenguins_svd &lt;- svd( 1/n * t(X)%*% X ) # to get P and D from t(X)WX\n\n## eigenvalues\npenguins_eigenvalue &lt;- penguins_svd$d\n\nP &lt;- penguins_svd$v\ncp &lt;- X %*% P\nhead(cp[, 1:2])\ncat(\"\\n\")\nhead(penguins.PCA$ind$coord[,1:2])\n\n#plot(penguins.PCA, choix = \"ind\", axes = c(1,2),invisible=c('ind.sup'),label =c('ind') )\nlibrary(factoextra)\nfviz_pca_ind(penguins.PCA, label=\"none\", addEllipses=FALSE)\n\n\n\n\n\n\n\n\n\n         [,1]        [,2]\n[1,] 1.853593 -0.03206938\n[2,] 1.316254  0.44352677\n[3,] 1.376605  0.16123048\n[4,] 1.885288  0.01235124\n[5,] 1.919981 -0.81759813\n[6,] 1.773020  0.36622296\n\n      Dim.1       Dim.2\n1 -1.853593  0.03206938\n2 -1.316254 -0.44352677\n3 -1.376605 -0.16123048\n4 -1.885288 -0.01235124\n5 -1.919981  0.81759813\n6 -1.773020 -0.36622296"
  },
  {
    "objectID": "01_acp.html#qualité-de-la-représentation-dun-individu",
    "href": "01_acp.html#qualité-de-la-représentation-dun-individu",
    "title": "Analyse en Composantes Principales",
    "section": "Qualité de la représentation d’un individu",
    "text": "Qualité de la représentation d’un individu\n\nMême avec ces précautions, on déforme le nuage de points\nCertains sont plus déformés que d’autre, il faut les identifier\n\nUn individu est d’autant moins déformé qu’il est proche du plan sur lequel on le projette, ce qui est donné par l’angle entre le vecteur initial et le vteur projeté\n\n\n\n\n\n\n\n\n\n\n\n\n\\[\\begin{align}\n&lt;\\class{alea}{x_i}, \\boldsymbol{u_1}&gt; &= \\lVert\\class{alea}{x_i}\\rVert \\lVert\\boldsymbol{u_1}\\rVert cos(\\theta_i) \\\\\n& = \\class{alea}{x_i}^\\top \\boldsymbol{u_1}, \\quad \\left( \\text{ou } \\class{alea}{x_i}^\\top M \\boldsymbol{u_1}  \\text{avec une autre métrique} \\right) \\\\\n\\end{align}\\]\n\\[\\cos^2(\\theta_i) = \\frac{(\\class{alea}{x_i}^\\top \\boldsymbol{u_1})^2}{\\lVert\\class{alea}{x_i}\\rVert^2}\\]\n\nInterprétation: plus \\(\\cos^2(\\theta_i)\\) est proche de \\(1\\), mieux l’individu est représenté."
  },
  {
    "objectID": "01_acp.html#contribution-dun-individu-à-la-définition-de-laxe",
    "href": "01_acp.html#contribution-dun-individu-à-la-définition-de-laxe",
    "title": "Analyse en Composantes Principales",
    "section": "Contribution d’un individu à la définition de l’axe",
    "text": "Contribution d’un individu à la définition de l’axe\n\nLes individus sont plus ou moins important dans la définition des axes\n\n\nIntuitivementFormellement\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuels sont les points qui vont le plus contribuer à la détermination des axes ?\n\n\n\nLa contribution relative de l’observation \\(\\class{alea}{x_i}\\) à la construction de l’axe principal \\(k\\) est la part d’inertie de l’axe \\(k\\) expliquée par \\(\\class{alea}{x_i}\\) donnée par\n\\[Ctr(i, k) = \\frac{1}{n} \\frac{c_{ik}^2}{\\lambda_k}.\\] En effet \\(\\lambda_k = \\frac{1}{n} \\sum_{i=1}^n c_{ik}^2\\) (ie. la variance du nuage projeté).\nRemarque : si les individus ont des poids \\(w_i\\) alors \\[Ctr(i, k) =  \\frac{w_i c_{ik}^2}{\\lambda_k}.\\]"
  },
  {
    "objectID": "01_acp.html#qualité-de-la-représentation-dune-variable-sur-un-plan-factoriel",
    "href": "01_acp.html#qualité-de-la-représentation-dune-variable-sur-un-plan-factoriel",
    "title": "Analyse en Composantes Principales",
    "section": "Qualité de la représentation d’une variable sur un plan factoriel",
    "text": "Qualité de la représentation d’une variable sur un plan factoriel\n\nIntuitivementFormellement\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUne variable est bien représentée sur l’axe \\(k\\) si l’angle entre cette variable et la composante \\(C^k\\) est petit, son cosinus est proche de 1 ou -1.\n\nOr \\(&lt;X^j, C^k&gt; = \\lVert X^j\\rVert\\lVert C^k\\rVert cos(\\theta_{jk})\\)\n\\[\\begin{align}\n&lt;X^j, C^k&gt; & = &lt;(CP^\\top)^j, C^k&gt; \\\\\n& = \\underbrace{\\left((CP^\\top)^j\\right)^\\top}{= (P C^\\top)_j}   C^k \\\\\n\\end{align}\\]\nAinsi \\(&lt;X^j, C^k&gt;\\) est le \\(j^\\text{ème}\\) terme du vecteur \\(PC^\\top C^k\\), or \\(C^\\top C\\) est diagonale avec \\(C_k^k = n lambda_k\\), donc \\(C^\\top C^k=(0, \\dots, n\\lambda_k, 0, \\ldots)\\) et\n\\[\\cos(\\theta_{jk}) = \\frac{n \\lambda_k \\boldsymbol{u_k^j}}{\\sqrt{\\lVert X^j\\rVert^2 \\, \\lVert C_k\\rVert^2}}=  \\sqrt{\\lambda_k} \\boldsymbol{u_k^j},  \\quad \\cos^2(\\theta_{jk}) =  \\lambda_k{(\\boldsymbol{u_k^j})^2}\\]"
  },
  {
    "objectID": "01_acp.html#ajouter-des-informations-supplémentaires",
    "href": "01_acp.html#ajouter-des-informations-supplémentaires",
    "title": "Analyse en Composantes Principales",
    "section": "Ajouter des informations supplémentaires",
    "text": "Ajouter des informations supplémentaires\nIl est possible d’ajouter des informations supplémentaires\nDes individus supplémentaires qui ne seront pas utiliser pour cuitruire les axes\nSi on veut ajouter un nouvel individu \\(x_{new}\\)\n\non calcule \\(\\boldsymbol{x}_{new} - \\boldsymbol{g}\\), le point centré (et potentiellement on divise par l’écart type des variables calculés sur le jeu de données initial)\nOn projette sur les axes principaux : \\((\\boldsymbol{x}_{new} - \\boldsymbol{g} )^\\top \\boldsymbol{u_k}\\)\n\nUne variable supplémentaire\nSi on souhaite ajouter une nouvelle variable \\(\\boldsymbol{x}^{new}= (x^{new}_1, \\ldots, x^{new}_n)^\\top \\in {\\mathbb{R}}^n\\)\n\nOn soustrait sa moyenne \\(\\tilde{\\boldsymbol{x}}^{new} = \\boldsymbol{x}^{new} - m^{new}\\), \\(m^{new}=\\frac{1}{n} \\sum_{i=1}^n x^{new}_i\\) (ou \\(m^{new}= \\sum_{i=1}^n w_i x^{new}_i\\) si toutes les observations n’ont pas le même poids)\nOn projette \\(\\tilde{\\boldsymbol{x}}^{new}\\) sur \\(\\boldsymbol{u_k},\\)\n\n\\[Cor(\\tilde{\\boldsymbol{x}}^{new}, u_k) = \\frac{(\\tilde{\\boldsymbol{x}}^{new})^\\top W \\boldsymbol{u_k} }{\\lVert\\tilde{\\boldsymbol{x}}^{new}\\rVert}\\]"
  },
  {
    "objectID": "01_acp.html#retournons-à-nos-manchots",
    "href": "01_acp.html#retournons-à-nos-manchots",
    "title": "Analyse en Composantes Principales",
    "section": "Retournons à nos manchots",
    "text": "Retournons à nos manchots\n\n\npenguins.PCA &lt;- PCA(X = penguins, \n                    scale.unit = TRUE, ## should we scale the data,\n                    ncp = 4, ## number of components : as many as initial variables\n                    quali.sup = c(1, 2, 7,8)) ## to indicate the column number of qualitative variable\n\n # library(Factoshiny)\n # PCAshiny(penguins)"
  },
  {
    "objectID": "01_acp.html#présentation-des-données",
    "href": "01_acp.html#présentation-des-données",
    "title": "Analyse en Composantes Principales",
    "section": "Présentation des données",
    "text": "Présentation des données"
  },
  {
    "objectID": "01_acp.html#lexemple-des-caractéristiques-du-doubs",
    "href": "01_acp.html#lexemple-des-caractéristiques-du-doubs",
    "title": "Analyse en Composantes Principales",
    "section": "L’exemple des caractéristiques du Doubs",
    "text": "L’exemple des caractéristiques du Doubs\nOn a mesuré les caractéristiques physico chimiques sur 30 sites différents le long de la rivière Doubs.\n\n\nLes 6 premières lignes (parmi 30) du jeu de données doubs.env\n\n\n# A tibble: 30 × 11\n    das   alt   pen   deb    pH   dur   pho   nit   amm   oxy   dbo\n  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1   0.3   934  48    0.84   7.9    45  0.01  0.2   0     12.2   2.7\n2   2.2   932   3    1      8      40  0.02  0.2   0.1   10.3   1.9\n3  10.2   914   3.7  1.8    8.3    52  0.05  0.22  0.05  10.5   3.5\n4  18.5   854   3.2  2.53   8      72  0.1   0.21  0     11     1.3\n5  21.5   849   2.3  2.64   8.1    84  0.38  0.52  0.2    8     6.2\n6  32.4   846   3.2  2.86   7.9    60  0.2   0.15  0     10.2   5.3\n# ℹ 24 more rows\n\n\n\n\ndas : distance à la source ( \\(km\\) ),\nalt : altitude ( \\(m\\) )\npen : la pente (dénivelé pour 1000m)\ndeb : le débit () \\(m^3.s^{-1}\\) )\npH : le pH de l’eau,\ndur : la concentration en calcium ( \\(mg.L^{-1}\\) ),\npho : concentration en phosphate ( \\(mg.L^{-1}\\) ),\nnit : concentration en nitrate ( \\(mg.L^{-1}\\) ),\namn : concentration en ammonium ( \\(mg.L^{-1}\\) ),\noxy : concentration d’oxygène dissous ( \\(mg.L^{-1}\\) ),\ndbo : Demande biologique en oxygène ( \\(mg.L^{-1}\\) ).\n\n\nComment visualiser au mieux ces données pour faire apparaître les liens entre variables et identifier des ressemblances entre individus ?"
  },
  {
    "objectID": "01_acp.html#analyse-par-acp",
    "href": "01_acp.html#analyse-par-acp",
    "title": "Analyse en Composantes Principales",
    "section": "Analyse par ACP",
    "text": "Analyse par ACP\n\nPoids des individus ?\nQuelle distance entre les variables ?\nLancer l’analyse\n\nquelles sont les composantes intéressantes (règle empririque du choix du nombre d’axes) ?\nquelles informations sont visibles sur le premier plan factoriel ?\nQue peut on dire des liens entre les variables ?\nA votre avis quels sites contribuent le plus à la formation de l’axe 1 ?\nQue peut on dire du pH ?"
  },
  {
    "objectID": "01_acp.html#ne-garder-que-linformation-pertinente",
    "href": "01_acp.html#ne-garder-que-linformation-pertinente",
    "title": "Analyse en Composantes Principales",
    "section": "Ne garder que l’information pertinente",
    "text": "Ne garder que l’information pertinente\nOn a utilisé l’ACP comme une technique de visualisation, mais on peut sen servir comme une technique de compression (avec perte). Il suffit de ne garder que les première composantes principales.\nL’exemple sur une image"
  },
  {
    "objectID": "01_acp.html#matrice-dinertie",
    "href": "01_acp.html#matrice-dinertie",
    "title": "Analyse en Composantes Principales",
    "section": "Matrice d’inertie",
    "text": "Matrice d’inertie\n\n\nRevisiter l’inertie\nL’inertie du nuage de points est définie comme \\[I = \\sum_{i=1}^n w_i \\lVert\\class{alea}{x_i} -\\boldsymbol{g}\\rVert^2_M\\] On a considéré des variables centrées donc \\(\\boldsymbol{g} = \\boldsymbol{0}\\).\n\nOr\n\n\\[\\begin{align}\nI = & \\sum_{i=1}^n w_i x_i^\\top M x_i = tr(\\sum_{i=1}^n w_i x_i^\\top M x_i ) \\\\\n   = & tr(\\sum_{i=1}^n M x_i w_i x_i^\\top ) \\quad \\text{(commutatitvité de la trace)} \\\\\n   = & tr(M \\sum_{i=1}^n  x_i w_i x_i^\\top )\\\\\n   = & tr(M X^\\top W X)\\\\\n   = & tr( X^\\top W X M)\\\\\n   = & tr( V M)\\\\\n   \n\\end{align}\\]\n\nExemple sur les cas présentés\n\nDans le cas de l’ACP, la matrice \\(V\\) est la matrice de covariance et \\(M = Id\\),\nDans le cas de l’ACP normée , la matrice \\(V\\) est la matrice de covariance et \\(M = Diag(s_k^{-2})\\),"
  },
  {
    "objectID": "01_acp.html#ce-que-vous-pensez-devoir-retenir",
    "href": "01_acp.html#ce-que-vous-pensez-devoir-retenir",
    "title": "Analyse en Composantes Principales",
    "section": "Ce que vous pensez devoir retenir",
    "text": "Ce que vous pensez devoir retenir\n\nl’ACP permet de mettre en valeur l’information principale contenu dans un jeu de données\n\nles relations entre variables\nles proximités entre individus\n\nCette méthode permet d’obtenir une projection sur queluqes axes indépendants et bien choisis, au sens ou ils résument le mieux l’information\nTechniquement l’ACP consiste à diagonaliser la matrice de covariance\nLes axes sont définis par les vecteurs propres de la matrice\n\\[ X^\\top W X\\]\nIls sont rangés par ordre d’importance décroissante, au sens où le premier est celui qui préserve le plus l’inertie du nuage projeté (i.e a la plus grande valeur propre)\nIl faut adapter la métrique au probleme\nl’information portée par un axe est mesurée par la valeur propre associé à l’axe\nil faut savoir interpréter le nuage des individus, éclairés par les liens entre axes principaux et anciennes variables"
  }
]
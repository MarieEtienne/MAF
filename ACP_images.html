<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="MP Etienne">

<title>ACP for Image Compression – Méthodes d’analyse factorielle</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-169b6d0432b1a799c6e7691d07d1a7fb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Méthodes d’analyse factorielle</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MarieEtienne/MAF.git"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-references-" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">References</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-references-">    
        <li>
    <a class="dropdown-item" href="./references_maf.html">
 <span class="dropdown-text">Cours</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./references_linear.html">
 <span class="dropdown-text">Algèbre linéaire</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cours" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Cours</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cours">    
        <li>
    <a class="dropdown-item" href="./01_intro.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_inertie.html">
 <span class="dropdown-text">Mesurer la quantité d’information</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_acp.html">
 <span class="dropdown-text">Analyse en Composantes Principales</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_afm.html">
 <span class="dropdown-text">Analyse Factorielle Multiple</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_afd.html">
 <span class="dropdown-text">Analyse Factorielle Discrimante</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_afc.html">
 <span class="dropdown-text">Analyse Factorielle des Correspondances</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01_acm.html">
 <span class="dropdown-text">Analyse Correspondances Multiples</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tp" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">TP</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tp">    
        <li>
    <a class="dropdown-item" href="./TP1.html">
 <span class="dropdown-text">Labs1 - Analyse en composante Principale</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tp1_example.html">
 <span class="dropdown-text">Eléments de correction pour le TD1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./TP2.html">
 <span class="dropdown-text">Labs2 - Analyse en composante Principale et au-delà</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./TP3.html">
 <span class="dropdown-text">Lab3 - AFC et ACM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./TP4.html">
 <span class="dropdown-text">Lab4 - Explorer un jeu de données complexes</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#peut-on-compresser-les-beatles" id="toc-peut-on-compresser-les-beatles" class="nav-link active" data-scroll-target="#peut-on-compresser-les-beatles">Peut on compresser les Beatles ?</a>
  <ul class="collapse">
  <li><a href="#réduction-de-dimension-par-acp" id="toc-réduction-de-dimension-par-acp" class="nav-link" data-scroll-target="#réduction-de-dimension-par-acp">Réduction de dimension par ACP</a></li>
  <li><a href="#reconstruction-avec-une-seule-composante-principale" id="toc-reconstruction-avec-une-seule-composante-principale" class="nav-link" data-scroll-target="#reconstruction-avec-une-seule-composante-principale">Reconstruction avec une seule composante principale</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ACP for Image Compression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>MP Etienne </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.1     ✔ stringr   1.5.2
✔ lubridate 1.9.4     ✔ tibble    3.3.0
✔ purrr     1.1.0     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>Pour bien comprendre comment sont décomposées les images en bloc de 16 par 16, on peut créer une matrice avecdes cases numérotées et constater comment elle est transformée.</p>
<p>Un bloc de 1- pixels est un individu à 16 variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>test_image <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1024</span>, <span class="at">dim=</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>test_image_blocks <span class="ot">&lt;-</span> <span class="fu">extract_blocks_parallel</span>(test_image[,,<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">block_size =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>test_image</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[,12] [,13]
 [1,]    1   33   65   97  129  161  193  225  257   289   321   353   385
 [2,]    2   34   66   98  130  162  194  226  258   290   322   354   386
 [3,]    3   35   67   99  131  163  195  227  259   291   323   355   387
 [4,]    4   36   68  100  132  164  196  228  260   292   324   356   388
 [5,]    5   37   69  101  133  165  197  229  261   293   325   357   389
 [6,]    6   38   70  102  134  166  198  230  262   294   326   358   390
 [7,]    7   39   71  103  135  167  199  231  263   295   327   359   391
 [8,]    8   40   72  104  136  168  200  232  264   296   328   360   392
 [9,]    9   41   73  105  137  169  201  233  265   297   329   361   393
[10,]   10   42   74  106  138  170  202  234  266   298   330   362   394
[11,]   11   43   75  107  139  171  203  235  267   299   331   363   395
[12,]   12   44   76  108  140  172  204  236  268   300   332   364   396
[13,]   13   45   77  109  141  173  205  237  269   301   333   365   397
[14,]   14   46   78  110  142  174  206  238  270   302   334   366   398
[15,]   15   47   79  111  143  175  207  239  271   303   335   367   399
[16,]   16   48   80  112  144  176  208  240  272   304   336   368   400
[17,]   17   49   81  113  145  177  209  241  273   305   337   369   401
[18,]   18   50   82  114  146  178  210  242  274   306   338   370   402
[19,]   19   51   83  115  147  179  211  243  275   307   339   371   403
[20,]   20   52   84  116  148  180  212  244  276   308   340   372   404
[21,]   21   53   85  117  149  181  213  245  277   309   341   373   405
[22,]   22   54   86  118  150  182  214  246  278   310   342   374   406
[23,]   23   55   87  119  151  183  215  247  279   311   343   375   407
[24,]   24   56   88  120  152  184  216  248  280   312   344   376   408
[25,]   25   57   89  121  153  185  217  249  281   313   345   377   409
[26,]   26   58   90  122  154  186  218  250  282   314   346   378   410
[27,]   27   59   91  123  155  187  219  251  283   315   347   379   411
[28,]   28   60   92  124  156  188  220  252  284   316   348   380   412
[29,]   29   61   93  125  157  189  221  253  285   317   349   381   413
[30,]   30   62   94  126  158  190  222  254  286   318   350   382   414
[31,]   31   63   95  127  159  191  223  255  287   319   351   383   415
[32,]   32   64   96  128  160  192  224  256  288   320   352   384   416
      [,14] [,15] [,16]
 [1,]   417   449   481
 [2,]   418   450   482
 [3,]   419   451   483
 [4,]   420   452   484
 [5,]   421   453   485
 [6,]   422   454   486
 [7,]   423   455   487
 [8,]   424   456   488
 [9,]   425   457   489
[10,]   426   458   490
[11,]   427   459   491
[12,]   428   460   492
[13,]   429   461   493
[14,]   430   462   494
[15,]   431   463   495
[16,]   432   464   496
[17,]   433   465   497
[18,]   434   466   498
[19,]   435   467   499
[20,]   436   468   500
[21,]   437   469   501
[22,]   438   470   502
[23,]   439   471   503
[24,]   440   472   504
[25,]   441   473   505
[26,]   442   474   506
[27,]   443   475   507
[28,]   444   476   508
[29,]   445   477   509
[30,]   446   478   510
[31,]   447   479   511
[32,]   448   480   512</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>test_image_blocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    1    2    3    4   33   34   35   36   65    66    67    68    97
 [2,]    5    6    7    8   37   38   39   40   69    70    71    72   101
 [3,]    9   10   11   12   41   42   43   44   73    74    75    76   105
 [4,]   13   14   15   16   45   46   47   48   77    78    79    80   109
 [5,]   17   18   19   20   49   50   51   52   81    82    83    84   113
 [6,]   21   22   23   24   53   54   55   56   85    86    87    88   117
 [7,]   25   26   27   28   57   58   59   60   89    90    91    92   121
 [8,]   29   30   31   32   61   62   63   64   93    94    95    96   125
 [9,]  129  130  131  132  161  162  163  164  193   194   195   196   225
[10,]  133  134  135  136  165  166  167  168  197   198   199   200   229
[11,]  137  138  139  140  169  170  171  172  201   202   203   204   233
[12,]  141  142  143  144  173  174  175  176  205   206   207   208   237
[13,]  145  146  147  148  177  178  179  180  209   210   211   212   241
[14,]  149  150  151  152  181  182  183  184  213   214   215   216   245
[15,]  153  154  155  156  185  186  187  188  217   218   219   220   249
[16,]  157  158  159  160  189  190  191  192  221   222   223   224   253
[17,]  257  258  259  260  289  290  291  292  321   322   323   324   353
[18,]  261  262  263  264  293  294  295  296  325   326   327   328   357
[19,]  265  266  267  268  297  298  299  300  329   330   331   332   361
[20,]  269  270  271  272  301  302  303  304  333   334   335   336   365
[21,]  273  274  275  276  305  306  307  308  337   338   339   340   369
[22,]  277  278  279  280  309  310  311  312  341   342   343   344   373
[23,]  281  282  283  284  313  314  315  316  345   346   347   348   377
[24,]  285  286  287  288  317  318  319  320  349   350   351   352   381
[25,]  385  386  387  388  417  418  419  420  449   450   451   452   481
[26,]  389  390  391  392  421  422  423  424  453   454   455   456   485
[27,]  393  394  395  396  425  426  427  428  457   458   459   460   489
[28,]  397  398  399  400  429  430  431  432  461   462   463   464   493
[29,]  401  402  403  404  433  434  435  436  465   466   467   468   497
[30,]  405  406  407  408  437  438  439  440  469   470   471   472   501
[31,]  409  410  411  412  441  442  443  444  473   474   475   476   505
[32,]  413  414  415  416  445  446  447  448  477   478   479   480   509
      [,14] [,15] [,16]
 [1,]    98    99   100
 [2,]   102   103   104
 [3,]   106   107   108
 [4,]   110   111   112
 [5,]   114   115   116
 [6,]   118   119   120
 [7,]   122   123   124
 [8,]   126   127   128
 [9,]   226   227   228
[10,]   230   231   232
[11,]   234   235   236
[12,]   238   239   240
[13,]   242   243   244
[14,]   246   247   248
[15,]   250   251   252
[16,]   254   255   256
[17,]   354   355   356
[18,]   358   359   360
[19,]   362   363   364
[20,]   366   367   368
[21,]   370   371   372
[22,]   374   375   376
[23,]   378   379   380
[24,]   382   383   384
[25,]   482   483   484
[26,]   486   487   488
[27,]   490   491   492
[28,]   494   495   496
[29,]   498   499   500
[30,]   502   503   504
[31,]   506   507   508
[32,]   510   511   512</code></pre>
</div>
</div>
<section id="peut-on-compresser-les-beatles" class="level2">
<h2 class="anchored" data-anchor-id="peut-on-compresser-les-beatles">Peut on compresser les Beatles ?</h2>
<p>On va travailler sur la fameuse image de l’album Abbey Road des Beatles.</p>
<p><img src="img/abbey_road.jpg" class="img-fluid"></p>
<p>Pour la charger avec R, on utilise le package <code>imager</code> et la fonction <code>load.image</code>. puis la fonction <code>grayscale</code>pour bien s’assurer que l’image est codée en niveaux de gris.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(imager)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>image <span class="ot">&lt;-</span> <span class="fu">load.image</span>(<span class="st">'img/abbey_road.jpg'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>image <span class="ot">&lt;-</span> <span class="fu">grayscale</span>(image)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df_origine <span class="ot">&lt;-</span>image <span class="sc">%&gt;%</span> as.data.frame</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>p_origine <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_origine,<span class="fu">aes</span>(x,y))<span class="sc">+</span><span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span>scales<span class="sc">::</span><span class="fu">reverse_trans</span>(), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="do">## pour mettre l'image dans le bon sens et supprimer les bors gris</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"black"</span>,<span class="at">high=</span><span class="st">"white"</span>) <span class="sc">+</span> <span class="do">##&nbsp;pour le noir et blanc</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>p_origine</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ACP_images_files/figure-html/load_abbey-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>L’objet obtenu est un <code>array</code> dont la première dimension est le nombre de pixels en ligne et la seconde dimension le nombre de pixel en colonnes. La troisème dimension est la profondeur et correspondrait au temps dan sun film par exemple et la dernière dimension est la couleur (on a donc 3 valeurs possibles sur cette dernière dimension dans le cas d’une image RGB et 1 dans le cas d’une image en niveau de gris).</p>
<p>Si on se concentre sur les deux premières dimensions, on a donc une matrice dont la valeur est le niveau de gris du pixel correspondant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(image)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1024  768    1    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gray_channel <span class="ot">&lt;-</span> image[,,<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>gray_channel[<span class="dv">1</span>,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1529412</code></pre>
</div>
</div>
<p>Pour rentrer dans le formalisme de l’ACP, on a besoin qu’une ligne soit un individu et une colonne une variable. Ici, le choix nous revient de définir comme on le souhaite ce qu’est un individu et une varaible.</p>
<p>On va découper l’image en buffer carré (patch, micro image) de coté <span class="math inline">\(bs.\)</span> Un individu sera un patch et une variable sera le niveau de gris dans un pixel particulier du patch.</p>
<p>On a donc <span class="math inline">\(bs^2\)</span> variables et <span class="math inline">\(N_{buf} = (height/bs) * (width/bs)\)</span> buffers/individus.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set block size to 4x4</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>block_size <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract blocks for each color channel in parallel</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>image_blocks <span class="ot">&lt;-</span> <span class="fu">extract_blocks_parallel</span>(gray_channel, block_size)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(image_blocks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="réduction-de-dimension-par-acp" class="level3">
<h3 class="anchored" data-anchor-id="réduction-de-dimension-par-acp">Réduction de dimension par ACP</h3>
<p>On va maintenant mettre en oeuvre une ACP, pour détermnier les composantes principales et on ne gardera quelques composantes pour réduire la dimension. On utilise <code>FactoMineR</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>images_pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(<span class="at">X =</span> image_blocks, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">ncp =</span> <span class="fu">ncol</span>(image_blocks))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les valeurs propres nous donnent la quantité d’information contenu par chaque composante.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>eigen_restreint <span class="ot">&lt;-</span> images_pca<span class="sc">$</span>svd<span class="sc">$</span>V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On constate que la première composante contient à elle toute seule 89.0652348<span class="math inline">\(\%\)</span> d’inertie. Ce qui signifie qu’en écrivant chaque buffet comme un nombre réel multiplé par le premier buffer on recontruit presque <span class="math inline">\(90\%\)</span> de l’information. Dans ca cas on a juste besoin de stocker</p>
<ul>
<li>la matrice <span class="math inline">\(1\times bs^2\)</span> qui permet de reconstruire les 16 variables initiales avec l’information contenu dans ce premier buffer,</li>
<li>les coefficients que chaque buffer individu attribue à ce premier buffer, soit <span class="math inline">\(N_{buf}\)</span></li>
</ul>
<p>On passe donc <span class="math inline">\(N_{buf} * 16\)</span> réels à stocker à <span class="math inline">\(N_{buf} + bs^2\)</span> si on ne garde qu’une seule composante ou <span class="math inline">\(2 N_{buf} + bs^2\)</span> si on en garde 2.</p>
<p>Les vecteurs propres sont donnés par</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>eigen_restreint <span class="ot">&lt;-</span> images_pca<span class="sc">$</span>svd<span class="sc">$</span>V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On sait q’un vecteur propre correspond à un patch de <span class="math inline">\(bc\times bs\)</span>, on peut donc les visualiser sous cette forme</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>list_eigen <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>block_size<span class="sc">^</span><span class="dv">2</span>, <span class="cf">function</span>(i){</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  X_restreint <span class="ot">&lt;-</span> <span class="fu">matrix</span>(images_pca<span class="sc">$</span>svd<span class="sc">$</span>V[,i], <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  image_eig <span class="ot">&lt;-</span> <span class="fu">as.cimg</span>(<span class="fu">array</span>(X_restreint, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> image_eig <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(x,y))<span class="sc">+</span><span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span>scales<span class="sc">::</span><span class="fu">reverse_trans</span>(), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="do">## pour mettre l'image dans le bon sens et supprimer les bors gris</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"black"</span>,<span class="at">high=</span><span class="st">"white"</span>) <span class="sc">+</span> <span class="do">##&nbsp;pour le noir et blanc</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_fixed</span>()</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="at">plotlist =</span> list_eigen, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ACP_images_files/figure-html/eigenvectors_buffer-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$`2`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ACP_images_files/figure-html/eigenvectors_buffer-2.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$`3`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ACP_images_files/figure-html/eigenvectors_buffer-3.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$`4`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ACP_images_files/figure-html/eigenvectors_buffer-4.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
attr(,"class")
[1] "list"      "ggarrange"</code></pre>
</div>
</div>
</section>
<section id="reconstruction-avec-une-seule-composante-principale" class="level3">
<h3 class="anchored" data-anchor-id="reconstruction-avec-une-seule-composante-principale">Reconstruction avec une seule composante principale</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>new_coord <span class="ot">&lt;-</span> images_pca<span class="sc">$</span>ind<span class="sc">$</span>coord</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>reconstruction <span class="ot">&lt;-</span> new_coord[, <span class="dv">1</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]<span class="sc">%*%</span> <span class="fu">t</span>(images_pca<span class="sc">$</span>svd<span class="sc">$</span>V)[<span class="dv">1</span>,] </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>n_row_block <span class="ot">&lt;-</span> <span class="fu">dim</span>(image)[<span class="dv">1</span>]<span class="sc">/</span>block_size</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>n_col_block <span class="ot">&lt;-</span> <span class="fu">dim</span>(image)[<span class="dv">2</span>]<span class="sc">/</span>block_size</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>X_reconstruction_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n_col_block, <span class="cf">function</span>(j){</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  list_rows <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n_row_block, <span class="cf">function</span>(i){</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>( reconstruction[(j<span class="dv">-1</span>)<span class="sc">*</span>n_row_block <span class="sc">+</span> i,], <span class="at">ncol =</span> block_size)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind, list_rows)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>X_reconstruction <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, X_reconstruction_list)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>df_1 <span class="ot">&lt;-</span><span class="fu">as.cimg</span>(<span class="fu">array</span>(X_reconstruction, <span class="at">dim=</span><span class="fu">dim</span>(image))) <span class="sc">%&gt;%</span> as.data.frame</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>p_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_1,<span class="fu">aes</span>(x,y))<span class="sc">+</span><span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span>scales<span class="sc">::</span><span class="fu">reverse_trans</span>(), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="do">## pour mettre l'image dans le bon sens et supprimer les bors gris</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"black"</span>,<span class="at">high=</span><span class="st">"white"</span>) <span class="sc">+</span> <span class="do">##&nbsp;pour le noir et blanc</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>new_coord <span class="ot">&lt;-</span> images_pca<span class="sc">$</span>ind<span class="sc">$</span>coord</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>reconstruction_2 <span class="ot">&lt;-</span> new_coord[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">%*%</span> <span class="fu">t</span>(images_pca<span class="sc">$</span>svd<span class="sc">$</span>V)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,] </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>X_reconstruction_list_2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n_col_block, <span class="cf">function</span>(j){</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  list_rows <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n_row_block, <span class="cf">function</span>(i){</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>( reconstruction_2[(j<span class="dv">-1</span>)<span class="sc">*</span>n_row_block <span class="sc">+</span> i,], <span class="at">ncol =</span> block_size)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind, list_rows)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>X_reconstruction_2 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, X_reconstruction_list_2)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>df_2 <span class="ot">&lt;-</span><span class="fu">as.cimg</span>(<span class="fu">array</span>(X_reconstruction_2, <span class="at">dim=</span><span class="fu">dim</span>(image))) <span class="sc">%&gt;%</span> as.data.frame</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>p_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_2,<span class="fu">aes</span>(x,y))<span class="sc">+</span><span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span>scales<span class="sc">::</span><span class="fu">reverse_trans</span>(), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="do">## pour mettre l'image dans le bon sens et supprimer les bors gris</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"black"</span>,<span class="at">high=</span><span class="st">"white"</span>) <span class="sc">+</span> <span class="do">##&nbsp;pour le noir et blanc</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ACP_images_files/figure-html/original_img-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Original Beatles</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ACP_images_files/figure-html/twodim_img-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>With 2 principal components</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ACP_images_files/figure-html/onedim_img-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>With 1 principal component</figcaption>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>